{"title":"Análisis de Componentes Principales","markdown":{"yaml":{"title":"Análisis de Componentes Principales","format":"html","editor":"visual"},"headingText":"1. ACP de todas las variables.","containsRefs":false,"markdown":"\n\nPara el desarrollo del análisis de componentes principales del conjunto de datos se utilizarán los paquetes de $\\texttt{FactoMineR,ade4,FactoClass}$ y $\\texttt{factoextra}$. Si bien puede ser redundante el uso de estos 4 paquetes en el mismo código, cada uno de estos ofrece funciones que nos ayudaran a dar una mejor representación gráfica de los resultados obtenidos por el ACP.\n\nDe esta forma, se usaran los siguientes paquetes para la ejecución del código.\n\n```{r}\n#| label: carga-librerias\n#| message: false\n#| echo: true\n#| output: false\n\n#Manejo de datos\nlibrary(tidyverse)\nlibrary(readr)\nlibrary(dplyr)\nlibrary(readxl)\n#Gráficos\nlibrary(ggplot2)\nlibrary(plotly)\nlibrary(GGally)\n#ACP\nlibrary(ade4)\nlibrary(FactoClass)\nlibrary(FactoMineR)\nlibrary(factoextra)\n#Datos importados\nsource(\"DatosSeleccionados.R\")\n\n#Ajustes de tema del documento y graficos\nlibrary(scales)\nlibrary(DT)\nlibrary(gt)\nlibrary(RColorBrewer)\ntheme_set(theme_minimal(base_size = 24, base_family = \"Atkinson Hyperlegible\"))\nlibrary(hrbrthemes)\n```\n\n\nSeleccionamos las variables de tipo cuantitativo de nuestra base de datos, en caso de que el lector no las recuerde, pueden ser consultadas [aquí](Datos.qmd).\n\nAhora, como primer paso, observamos las correlaciones que posee nuestro conjunto de datos a través de su matriz de correlaciones.\n\n```{r}\n#| label: Seleccion-variables\n#| echo: false\n#| warning: false\n#| output: false\n#http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/#r-packages\n#Escogemos las variables cuantitativas\nvarCuantitativas<-c(\"EDAD\",\"NUM_HIJOS\",\"EDAD_CONSUMO_TABACO\",\"EDAD_CONSUMO_ALCOHOL\",\"EDAD_CONSUMO_MARIHUANA\",\"EDAD_CONSUMO_INHALABLES\",\"EDAD_CONSUMO_LSD\",\"EDAD_CONSUMO_HONGOS\",\"EDAD_CONSUMO_COCAINA\",\"EDAD_CONSUMO_PASTA_COCAINA\",\"EDAD_CONSUMO_CRACK\",\"EDAD_CONSUMO_HEROINA\",\"EDAD_CONSUMO_CHOCHOS\",\"EDAD_CONSUMO_TRANQUILIZANTES\",\"EDAD_CONSUMO_ANFETAMINAS\",\"N_PERSONAS_DEPENDIENTES\",\"DINERO_SOBORNO\",\"DELITOS_ABIERTOS\",\"TIEMPO_RECLUIDO\",\"TIEMPO_PROCESO\",\"CANTIDAD_PERSONAS_CELDA\",\"CELDA_HORAS\",\"VECES_SENTENCIADO\")\n\nvarCualitativas<-setdiff(colnames(Tabla1),c(\"ID_PER\",\"NOM_ENT\",varCuantitativas))\n\nDatosCuantitativos<-Tabla1[,varCuantitativas]\nDatosCualitativos<-Tabla1[,varCualitativas]\ncorrelaciones<-cor(DatosCuantitativos)\n```\n\n## Matriz de correlación\n\n::: {style=\"display: flex;\"}\n::: {style=\"flex: 1; padding: 7px;\"}\n```{r}\n#| label: Correlaciones\n#| title: Correlaciones\n#| echo: false\n#| warning: false\n\n#http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/#r-packages\n\ncorrelaciones<-cor(DatosCuantitativos)\n#correlaciones<-correlaciones[rev(colnames(correlaciones)),]\nTabCorrelaciones<-NULL\nfor (var1 in colnames(correlaciones)){\n  for (var2 in rownames(correlaciones)){\n    fila<-data.frame(variable1=var1,variable2=var2,correlacion=correlaciones[var1,var2])\n    TabCorrelaciones<-rbind(TabCorrelaciones,fila)\n  }\n}\nTabCorrelaciones<-TabCorrelaciones%>%\n  mutate(text = paste0(\"x: \", TabCorrelaciones$variable1, \"\\n\", \"y: \", TabCorrelaciones$variable2, \"\\n\", \"Correlacion:\",round(correlacion,4)))\n\noptions(repr.plot.width =7, repr.plot.height=1)\n\np <- ggplot(TabCorrelaciones, aes(variable1, variable2, fill= correlacion, text=text)) + labs(x=\"\",y=\"\")+\n  geom_tile() +scale_fill_gradient2(low=muted(\"blue2\"),mid=\"white\", high=muted(\"#F00505\"),limits=c(-1,1))+\n  theme_ipsum()+theme(\n    #axis.text.x=element_text(angle = -90, hjust = 0),\n        axis.ticks.x=element_blank(), #remove x axis ticks\n        axis.ticks.y=element_blank(),\n        axis.text.x=element_blank(),\n        axis.text.y=element_blank()\n        )  #remove y axis ticks\n\n#par(mar = c(4, 3, 3, 2.5) + 0.1)\npar(fin=c(1,1))\n#par(mai = c(4, 3, 3, 2.5) + 0.1)\nggplotly(p, tooltip=\"text\")\npar(fin=c(1,1))\n#heatmap(correlaciones,NA,NA)\n```\n:::\n\n::: {style=\"flex: 1; padding: 10px;\"}\n<font size =\"3\">\n\nLa matriz de correlaciones nos da indicios de la posible relación entre las variables, las cuales se resumen en las siguientes:\n\n</font>\n\n<font size =\"2\">\n\n-   Las variables que corresponden a la edad a la cual comenzaron a consumir alguna droga o sustancia (Tabaco, alcohol, marihuana, cocaína,...) se encuentran altamente relacionadas.\n\n-   Las variables de TIEMPO_RECLUIDO y TIEMPO_PROCESO, y NUM_HIJOS y N_PERSONAS_DEPENDIENTES se encuentran relacionadas, esto tiene sentido dentro del contexto lógico de lo que representa cada una de estas variables.\n\n-   Las demás variables son independientes, o muy poco relacionadas, entre ellas.\n\n    </font>\n\nAsí, se puede esperar que el ACP resultantes tenga a las variables correspondientes a las edades como principales representantes de su primer eje.\n:::\n:::\n\nAhora, construiremos el ACP utilizando las funciones `dudi.pca` de `ade4` y `PCA` de `FactoMineR` . Pese a que ambas funciones dan el mismo resultado, los paquetes asociados a estas funciones nos dan alternativas para graficar los resultados obtenidos.\n\n## ACP\n\n```{r}\n#| title: ACP de las variables cuantitativas\n#| echo: True\n#| output: True\n\nres.pca<-FactoMineR:: PCA(DatosCuantitativos, scale.unit = TRUE, ncp = 20, graph = FALSE)\nacp <- dudi.pca(DatosCuantitativos, scannf = FALSE, nf = 5) \n\n# El parámetro nf indica cuantos ejes voy a conservar\nvalp <- t(inertia(acp)$tot.inertia) # valores propios\nkable(valp, digits = 3)\n```\n\n::: {style=\"height: 10%;\"}\nComo resultado inicial del ACP, se tiene que los 2 primeros ejes capturan un 24.84% de la varianza dada por las variables. Sin embargo, los otros ejes capturan aproximadamente un 5% de varianza, (ver gráfico izquierda); Por lo tanto no es posible resumir de forma drástica la dimensionalidad de la información dada por las variables, lo que puede interpretarse como independencia entre estas.\n\nEsta proposición puede confirmarse a través de los valores propios obtenidos (derecha), donde se obtuvieron 9 valores mayores o iguales a 1, y un total de 13 valores propios cercanos a 1 (mayores a 0.8).\n:::\n\n::: {style=\"height: 20%;\"}\n::: {layout-ncol=\"2\"}\n**Varianza explicada por los ejes**\n\n**Valores propios**\n\n```{r}\n#| label: Varianza explicada por los ejes\n#| echo: false\n\n#get_eigenvalue(res.pca)# Extract the eigenvalues/variances of principal components\nfviz_eig(res.pca,addlabels=T,ylim=c(0,20),ylab = \"Porcentaje de varianza explicada\",xlab=\"Eje\",main=\"\")# Visualize the eigenvalues\n```\n\n```{r}\n#| label: Valores propios\n#| echo: false\n\n#par(mar = c(2.5, 1, 1, 1.5) + 0.1)\nvline <- function(x = 0, color = \"green\") {\n  list(\n    type = \"line\",\n    y0 = 0,\n    y1 = 1,\n    yref = \"paper\",\n    x0 = x,\n    x1 = x,\n    line = list(color = color, dash=\"dot\")\n  )\n}\n# histograma de valores propios\nplot_ly(y=1:length(acp$eig),x=acp$eig,type=\"bar\",orientation=\"h\")%>%layout(plot_bgcolor = \"#e5ecf6\", shapes = list(vline(1), list(type = \"rect\",\n                                        fillcolor = \"red\", opacity = 0.2,\n                                        x0 = 0.8, x1 = max(acp$eig)+0.2, y0 = -0.5, y1 = 24)))\n#par(mar = c(5, 4, 4, 2) + 0.1)\n#abline(v = 1, lty = 3)\n#kable(acp$co, digits = 3)\n#s.corcircle(acp$co)\n#plot(acp, Tcol = FALSE, gg = TRUE)\n#fig<-ggplotly(p,tooltip = \"text\")\n#fig\n#9 ejes\n#acp1 <- dudi.pca(DatosCuantitativos, scannf = FALSE, nf = 9) \n#s.corcircle(acp1$co, xax = 5, yax = 8)\n```\n:::\n:::\n\n## Fila 4\n\nProin eu porttitor felis. Vivamus pulvinar augue at auctor efficitur. Interdum et malesuada fames ac ante ipsum primis in faucibus. Phasellus ullamcorper bibendum lacinia. Ut sodales auctor nunc sit amet pretium. Cras semper vulputate est a tincidunt. Etiam commodo sapien nec augue rhoncus, eget accumsan lorem efficitur.\n\n::: panel-tabset\n## Esta\n\n```{r}\n#| label: biplot\n#| echo: false\n\nfviz_pca_biplot(res.pca,geom=\"point\")\n```\n\n## y esta\n\n```{r}\n#| label: individuos\n#| echo: false\n\nfviz_pca_ind(res.pca,geom=\"point\")\n#kable(acp$co, digits = 3)\n#s.corcircle(acp$co)\n#plot(acp, Tcol = FALSE, gg = TRUE)\n\n#9 ejes\n#acp1 <- dudi.pca(DatosCuantitativos, scannf = FALSE, nf = 9) \n#s.corcircle(acp1$co, xax = 5, yax = 8)\n#s.corcircle(acp1$co, xax = 6, yax = 7)\n```\n:::\n\n## Cos2\n\n::: panel-tabset\n## 1° eje\n\n```{r}\n#| title: Primer eje\n#| echo: false\nfviz_cos2(res.pca, choice = \"var\", axes = 1)\n```\n\n## 2° eje\n\n```{r}\n#| title: Segundo eje\n#| echo: false\nfviz_cos2(res.pca, choice = \"var\", axes = 2)\n```\n\n## 3° eje\n\n```{r}\n#| title: Tercer eje\n#| echo: false\nfviz_cos2(res.pca, choice = \"var\", axes = 3)\n```\n\n## 4° eje\n\n```{r}\n#| title: Cuarto eje\n#| echo: false\nfviz_cos2(res.pca, choice = \"var\", axes = 4)\n```\n\n## 5° eje\n\n```{r}\n#| title: Quinto eje\n#| echo: false\nfviz_cos2(res.pca, choice = \"var\", axes = 5)\n```\n\n## 6° eje\n\n```{r}\n#| title: Sexto eje\n#| echo: false\nfviz_cos2(res.pca,choice=\"var\",axes=6)\n```\n\n## 7° eje\n\n```{r}\n#| title: Septimo eje\n#| echo: false\nfviz_cos2(res.pca,choice=\"var\",axes=7)\n```\n\n## 8° eje\n\n```{r}\n#| title: Octavo eje\n#| echo: false\nfviz_cos2(res.pca,choice=\"var\",axes=8)\n```\n\n## 9° eje\n\n```{r}\n#| title: Noveno eje\n#| echo: false\nfviz_cos2(res.pca,choice=\"var\",axes=9)\n```\n:::\n\n## Contribución de cada variable a los ejes\n\n::: panel-tabset\n## 1° eje\n\n```{r}\n#| title: Primer eje\n#| echo: false\nfviz_contrib(res.pca,top=5,choice=\"var\",axes=1)\n```\n\n## 2° eje\n\n```{r}\n#| title: Segundo eje\n#| echo: false\nfviz_contrib(res.pca,top=5,choice=\"var\",axes=2)\n```\n\n## 3° eje\n\n```{r}\n#| title: Tercer eje\n#| echo: false\nfviz_contrib(res.pca,top=5,choice=\"var\",axes=3)\n```\n\n## 4° eje\n\n```{r}\n#| title: Cuarto eje\n#| echo: false\nfviz_contrib(res.pca,top=5,choice=\"var\",axes=4)\n```\n\n## 5° eje\n\n```{r}\n#| title: Quinto eje\n#| echo: false\nfviz_contrib(res.pca,top=5,choice=\"var\",axes=5)\n```\n\n## 6° eje\n\n```{r}\n#| title: Sexto eje\n#| echo: false\nfviz_contrib(res.pca,top=5,choice=\"var\",axes=6)\n```\n\n## 7° eje\n\n```{r}\n#| title: Septimo eje\n#| echo: false\nfviz_contrib(res.pca,top=5,choice=\"var\",axes=7)\n```\n\n## 8° eje\n\n```{r}\n#| title: Octavo eje\n#| echo: false\nfviz_contrib(res.pca,top=5,choice=\"var\",axes=8)\n```\n\n## 9° eje\n\n```{r}\n#| title: Noveno eje\n#| echo: false\nfviz_contrib(res.pca,top=5,choice=\"var\",axes=9)\n```\n:::\n\nQuisque sollicitudin vel massa ac scelerisque. Morbi non porttitor nisl. Curabitur iaculis, lectus in condimentum pharetra, massa ligula vulputate sapien, in tincidunt enim dolor a massa. Donec convallis velit in lacus ornare porta. Duis ac erat sed purus maximus faucibus vestibulum vitae nisi. Maecenas euismod sem lacus, sit amet eleifend purus consectetur ac. Ut imperdiet suscipit nisl eget suscipit. Etiam sollicitudin porta sem at sodales. Nam condimentum augue sed magna auctor, non ornare arcu pellentesque. Suspendisse malesuada nisi sit amet sapien facilisis, ac porttitor sem bibendum. Mauris lacinia purus vel rutrum pretium. Duis aliquet a nibh vitae dignissim. Vestibulum sit amet odio ac velit sodales mollis quis non elit. Fusce et porta dui, condimentum facilisis lectus. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.\n\n## PCA 1 {height= \"30%\"}\n\n```{r}\n#| title: Otros eje\n#| echo: false\n#fviz_contrib(res.pca, choice = \"var\", axes = 1:2, top = 10)\n#fviz_contrib(res.pca, choice = \"var\", axes = 1:3, top = 10)\n#get_pca_ind(res.pca)# get_pca_var(res.pca): Extract the results for individuals and variables, respectively.\n#fviz_pca_ind(res.pca)#, fviz_pca_var(res.pca): Visualize the results individuals and variables, respectively.\n#fviz_pca_biplot(res.pca)#: Make a biplot of individuals and variables.\n\n\nfviz_pca_var(res.pca, col.var = \"contrib\",\n             gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\")\n             )\n\n# Change the transparency by contrib values\n#fviz_pca_var(res.pca, alpha.var = \"contrib\")\n#Dejar las drogas como ilustrativas, Qiutar las drogas y reducirla a una sola variable\n\n#Consumo_Marihuana\n#fviz_pca_ind(res.pca,\n#             geom.ind = \"point\", # show points only (nbut not \"text\")\n#             col.ind = Tabla1$CONSUMO_HONGOS, # color by groups\n             #palette = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n#             addEllipses = TRUE, # Concentration ellipses\n#             legend.title = \"Groups\"\n#             )\n```\n","srcMarkdownNoYaml":"\n\nPara el desarrollo del análisis de componentes principales del conjunto de datos se utilizarán los paquetes de $\\texttt{FactoMineR,ade4,FactoClass}$ y $\\texttt{factoextra}$. Si bien puede ser redundante el uso de estos 4 paquetes en el mismo código, cada uno de estos ofrece funciones que nos ayudaran a dar una mejor representación gráfica de los resultados obtenidos por el ACP.\n\nDe esta forma, se usaran los siguientes paquetes para la ejecución del código.\n\n```{r}\n#| label: carga-librerias\n#| message: false\n#| echo: true\n#| output: false\n\n#Manejo de datos\nlibrary(tidyverse)\nlibrary(readr)\nlibrary(dplyr)\nlibrary(readxl)\n#Gráficos\nlibrary(ggplot2)\nlibrary(plotly)\nlibrary(GGally)\n#ACP\nlibrary(ade4)\nlibrary(FactoClass)\nlibrary(FactoMineR)\nlibrary(factoextra)\n#Datos importados\nsource(\"DatosSeleccionados.R\")\n\n#Ajustes de tema del documento y graficos\nlibrary(scales)\nlibrary(DT)\nlibrary(gt)\nlibrary(RColorBrewer)\ntheme_set(theme_minimal(base_size = 24, base_family = \"Atkinson Hyperlegible\"))\nlibrary(hrbrthemes)\n```\n\n# 1. ACP de todas las variables.\n\nSeleccionamos las variables de tipo cuantitativo de nuestra base de datos, en caso de que el lector no las recuerde, pueden ser consultadas [aquí](Datos.qmd).\n\nAhora, como primer paso, observamos las correlaciones que posee nuestro conjunto de datos a través de su matriz de correlaciones.\n\n```{r}\n#| label: Seleccion-variables\n#| echo: false\n#| warning: false\n#| output: false\n#http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/#r-packages\n#Escogemos las variables cuantitativas\nvarCuantitativas<-c(\"EDAD\",\"NUM_HIJOS\",\"EDAD_CONSUMO_TABACO\",\"EDAD_CONSUMO_ALCOHOL\",\"EDAD_CONSUMO_MARIHUANA\",\"EDAD_CONSUMO_INHALABLES\",\"EDAD_CONSUMO_LSD\",\"EDAD_CONSUMO_HONGOS\",\"EDAD_CONSUMO_COCAINA\",\"EDAD_CONSUMO_PASTA_COCAINA\",\"EDAD_CONSUMO_CRACK\",\"EDAD_CONSUMO_HEROINA\",\"EDAD_CONSUMO_CHOCHOS\",\"EDAD_CONSUMO_TRANQUILIZANTES\",\"EDAD_CONSUMO_ANFETAMINAS\",\"N_PERSONAS_DEPENDIENTES\",\"DINERO_SOBORNO\",\"DELITOS_ABIERTOS\",\"TIEMPO_RECLUIDO\",\"TIEMPO_PROCESO\",\"CANTIDAD_PERSONAS_CELDA\",\"CELDA_HORAS\",\"VECES_SENTENCIADO\")\n\nvarCualitativas<-setdiff(colnames(Tabla1),c(\"ID_PER\",\"NOM_ENT\",varCuantitativas))\n\nDatosCuantitativos<-Tabla1[,varCuantitativas]\nDatosCualitativos<-Tabla1[,varCualitativas]\ncorrelaciones<-cor(DatosCuantitativos)\n```\n\n## Matriz de correlación\n\n::: {style=\"display: flex;\"}\n::: {style=\"flex: 1; padding: 7px;\"}\n```{r}\n#| label: Correlaciones\n#| title: Correlaciones\n#| echo: false\n#| warning: false\n\n#http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/#r-packages\n\ncorrelaciones<-cor(DatosCuantitativos)\n#correlaciones<-correlaciones[rev(colnames(correlaciones)),]\nTabCorrelaciones<-NULL\nfor (var1 in colnames(correlaciones)){\n  for (var2 in rownames(correlaciones)){\n    fila<-data.frame(variable1=var1,variable2=var2,correlacion=correlaciones[var1,var2])\n    TabCorrelaciones<-rbind(TabCorrelaciones,fila)\n  }\n}\nTabCorrelaciones<-TabCorrelaciones%>%\n  mutate(text = paste0(\"x: \", TabCorrelaciones$variable1, \"\\n\", \"y: \", TabCorrelaciones$variable2, \"\\n\", \"Correlacion:\",round(correlacion,4)))\n\noptions(repr.plot.width =7, repr.plot.height=1)\n\np <- ggplot(TabCorrelaciones, aes(variable1, variable2, fill= correlacion, text=text)) + labs(x=\"\",y=\"\")+\n  geom_tile() +scale_fill_gradient2(low=muted(\"blue2\"),mid=\"white\", high=muted(\"#F00505\"),limits=c(-1,1))+\n  theme_ipsum()+theme(\n    #axis.text.x=element_text(angle = -90, hjust = 0),\n        axis.ticks.x=element_blank(), #remove x axis ticks\n        axis.ticks.y=element_blank(),\n        axis.text.x=element_blank(),\n        axis.text.y=element_blank()\n        )  #remove y axis ticks\n\n#par(mar = c(4, 3, 3, 2.5) + 0.1)\npar(fin=c(1,1))\n#par(mai = c(4, 3, 3, 2.5) + 0.1)\nggplotly(p, tooltip=\"text\")\npar(fin=c(1,1))\n#heatmap(correlaciones,NA,NA)\n```\n:::\n\n::: {style=\"flex: 1; padding: 10px;\"}\n<font size =\"3\">\n\nLa matriz de correlaciones nos da indicios de la posible relación entre las variables, las cuales se resumen en las siguientes:\n\n</font>\n\n<font size =\"2\">\n\n-   Las variables que corresponden a la edad a la cual comenzaron a consumir alguna droga o sustancia (Tabaco, alcohol, marihuana, cocaína,...) se encuentran altamente relacionadas.\n\n-   Las variables de TIEMPO_RECLUIDO y TIEMPO_PROCESO, y NUM_HIJOS y N_PERSONAS_DEPENDIENTES se encuentran relacionadas, esto tiene sentido dentro del contexto lógico de lo que representa cada una de estas variables.\n\n-   Las demás variables son independientes, o muy poco relacionadas, entre ellas.\n\n    </font>\n\nAsí, se puede esperar que el ACP resultantes tenga a las variables correspondientes a las edades como principales representantes de su primer eje.\n:::\n:::\n\nAhora, construiremos el ACP utilizando las funciones `dudi.pca` de `ade4` y `PCA` de `FactoMineR` . Pese a que ambas funciones dan el mismo resultado, los paquetes asociados a estas funciones nos dan alternativas para graficar los resultados obtenidos.\n\n## ACP\n\n```{r}\n#| title: ACP de las variables cuantitativas\n#| echo: True\n#| output: True\n\nres.pca<-FactoMineR:: PCA(DatosCuantitativos, scale.unit = TRUE, ncp = 20, graph = FALSE)\nacp <- dudi.pca(DatosCuantitativos, scannf = FALSE, nf = 5) \n\n# El parámetro nf indica cuantos ejes voy a conservar\nvalp <- t(inertia(acp)$tot.inertia) # valores propios\nkable(valp, digits = 3)\n```\n\n::: {style=\"height: 10%;\"}\nComo resultado inicial del ACP, se tiene que los 2 primeros ejes capturan un 24.84% de la varianza dada por las variables. Sin embargo, los otros ejes capturan aproximadamente un 5% de varianza, (ver gráfico izquierda); Por lo tanto no es posible resumir de forma drástica la dimensionalidad de la información dada por las variables, lo que puede interpretarse como independencia entre estas.\n\nEsta proposición puede confirmarse a través de los valores propios obtenidos (derecha), donde se obtuvieron 9 valores mayores o iguales a 1, y un total de 13 valores propios cercanos a 1 (mayores a 0.8).\n:::\n\n::: {style=\"height: 20%;\"}\n::: {layout-ncol=\"2\"}\n**Varianza explicada por los ejes**\n\n**Valores propios**\n\n```{r}\n#| label: Varianza explicada por los ejes\n#| echo: false\n\n#get_eigenvalue(res.pca)# Extract the eigenvalues/variances of principal components\nfviz_eig(res.pca,addlabels=T,ylim=c(0,20),ylab = \"Porcentaje de varianza explicada\",xlab=\"Eje\",main=\"\")# Visualize the eigenvalues\n```\n\n```{r}\n#| label: Valores propios\n#| echo: false\n\n#par(mar = c(2.5, 1, 1, 1.5) + 0.1)\nvline <- function(x = 0, color = \"green\") {\n  list(\n    type = \"line\",\n    y0 = 0,\n    y1 = 1,\n    yref = \"paper\",\n    x0 = x,\n    x1 = x,\n    line = list(color = color, dash=\"dot\")\n  )\n}\n# histograma de valores propios\nplot_ly(y=1:length(acp$eig),x=acp$eig,type=\"bar\",orientation=\"h\")%>%layout(plot_bgcolor = \"#e5ecf6\", shapes = list(vline(1), list(type = \"rect\",\n                                        fillcolor = \"red\", opacity = 0.2,\n                                        x0 = 0.8, x1 = max(acp$eig)+0.2, y0 = -0.5, y1 = 24)))\n#par(mar = c(5, 4, 4, 2) + 0.1)\n#abline(v = 1, lty = 3)\n#kable(acp$co, digits = 3)\n#s.corcircle(acp$co)\n#plot(acp, Tcol = FALSE, gg = TRUE)\n#fig<-ggplotly(p,tooltip = \"text\")\n#fig\n#9 ejes\n#acp1 <- dudi.pca(DatosCuantitativos, scannf = FALSE, nf = 9) \n#s.corcircle(acp1$co, xax = 5, yax = 8)\n```\n:::\n:::\n\n## Fila 4\n\nProin eu porttitor felis. Vivamus pulvinar augue at auctor efficitur. Interdum et malesuada fames ac ante ipsum primis in faucibus. Phasellus ullamcorper bibendum lacinia. Ut sodales auctor nunc sit amet pretium. Cras semper vulputate est a tincidunt. Etiam commodo sapien nec augue rhoncus, eget accumsan lorem efficitur.\n\n::: panel-tabset\n## Esta\n\n```{r}\n#| label: biplot\n#| echo: false\n\nfviz_pca_biplot(res.pca,geom=\"point\")\n```\n\n## y esta\n\n```{r}\n#| label: individuos\n#| echo: false\n\nfviz_pca_ind(res.pca,geom=\"point\")\n#kable(acp$co, digits = 3)\n#s.corcircle(acp$co)\n#plot(acp, Tcol = FALSE, gg = TRUE)\n\n#9 ejes\n#acp1 <- dudi.pca(DatosCuantitativos, scannf = FALSE, nf = 9) \n#s.corcircle(acp1$co, xax = 5, yax = 8)\n#s.corcircle(acp1$co, xax = 6, yax = 7)\n```\n:::\n\n## Cos2\n\n::: panel-tabset\n## 1° eje\n\n```{r}\n#| title: Primer eje\n#| echo: false\nfviz_cos2(res.pca, choice = \"var\", axes = 1)\n```\n\n## 2° eje\n\n```{r}\n#| title: Segundo eje\n#| echo: false\nfviz_cos2(res.pca, choice = \"var\", axes = 2)\n```\n\n## 3° eje\n\n```{r}\n#| title: Tercer eje\n#| echo: false\nfviz_cos2(res.pca, choice = \"var\", axes = 3)\n```\n\n## 4° eje\n\n```{r}\n#| title: Cuarto eje\n#| echo: false\nfviz_cos2(res.pca, choice = \"var\", axes = 4)\n```\n\n## 5° eje\n\n```{r}\n#| title: Quinto eje\n#| echo: false\nfviz_cos2(res.pca, choice = \"var\", axes = 5)\n```\n\n## 6° eje\n\n```{r}\n#| title: Sexto eje\n#| echo: false\nfviz_cos2(res.pca,choice=\"var\",axes=6)\n```\n\n## 7° eje\n\n```{r}\n#| title: Septimo eje\n#| echo: false\nfviz_cos2(res.pca,choice=\"var\",axes=7)\n```\n\n## 8° eje\n\n```{r}\n#| title: Octavo eje\n#| echo: false\nfviz_cos2(res.pca,choice=\"var\",axes=8)\n```\n\n## 9° eje\n\n```{r}\n#| title: Noveno eje\n#| echo: false\nfviz_cos2(res.pca,choice=\"var\",axes=9)\n```\n:::\n\n## Contribución de cada variable a los ejes\n\n::: panel-tabset\n## 1° eje\n\n```{r}\n#| title: Primer eje\n#| echo: false\nfviz_contrib(res.pca,top=5,choice=\"var\",axes=1)\n```\n\n## 2° eje\n\n```{r}\n#| title: Segundo eje\n#| echo: false\nfviz_contrib(res.pca,top=5,choice=\"var\",axes=2)\n```\n\n## 3° eje\n\n```{r}\n#| title: Tercer eje\n#| echo: false\nfviz_contrib(res.pca,top=5,choice=\"var\",axes=3)\n```\n\n## 4° eje\n\n```{r}\n#| title: Cuarto eje\n#| echo: false\nfviz_contrib(res.pca,top=5,choice=\"var\",axes=4)\n```\n\n## 5° eje\n\n```{r}\n#| title: Quinto eje\n#| echo: false\nfviz_contrib(res.pca,top=5,choice=\"var\",axes=5)\n```\n\n## 6° eje\n\n```{r}\n#| title: Sexto eje\n#| echo: false\nfviz_contrib(res.pca,top=5,choice=\"var\",axes=6)\n```\n\n## 7° eje\n\n```{r}\n#| title: Septimo eje\n#| echo: false\nfviz_contrib(res.pca,top=5,choice=\"var\",axes=7)\n```\n\n## 8° eje\n\n```{r}\n#| title: Octavo eje\n#| echo: false\nfviz_contrib(res.pca,top=5,choice=\"var\",axes=8)\n```\n\n## 9° eje\n\n```{r}\n#| title: Noveno eje\n#| echo: false\nfviz_contrib(res.pca,top=5,choice=\"var\",axes=9)\n```\n:::\n\nQuisque sollicitudin vel massa ac scelerisque. Morbi non porttitor nisl. Curabitur iaculis, lectus in condimentum pharetra, massa ligula vulputate sapien, in tincidunt enim dolor a massa. Donec convallis velit in lacus ornare porta. Duis ac erat sed purus maximus faucibus vestibulum vitae nisi. Maecenas euismod sem lacus, sit amet eleifend purus consectetur ac. Ut imperdiet suscipit nisl eget suscipit. Etiam sollicitudin porta sem at sodales. Nam condimentum augue sed magna auctor, non ornare arcu pellentesque. Suspendisse malesuada nisi sit amet sapien facilisis, ac porttitor sem bibendum. Mauris lacinia purus vel rutrum pretium. Duis aliquet a nibh vitae dignissim. Vestibulum sit amet odio ac velit sodales mollis quis non elit. Fusce et porta dui, condimentum facilisis lectus. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.\n\n## PCA 1 {height= \"30%\"}\n\n```{r}\n#| title: Otros eje\n#| echo: false\n#fviz_contrib(res.pca, choice = \"var\", axes = 1:2, top = 10)\n#fviz_contrib(res.pca, choice = \"var\", axes = 1:3, top = 10)\n#get_pca_ind(res.pca)# get_pca_var(res.pca): Extract the results for individuals and variables, respectively.\n#fviz_pca_ind(res.pca)#, fviz_pca_var(res.pca): Visualize the results individuals and variables, respectively.\n#fviz_pca_biplot(res.pca)#: Make a biplot of individuals and variables.\n\n\nfviz_pca_var(res.pca, col.var = \"contrib\",\n             gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\")\n             )\n\n# Change the transparency by contrib values\n#fviz_pca_var(res.pca, alpha.var = \"contrib\")\n#Dejar las drogas como ilustrativas, Qiutar las drogas y reducirla a una sola variable\n\n#Consumo_Marihuana\n#fviz_pca_ind(res.pca,\n#             geom.ind = \"point\", # show points only (nbut not \"text\")\n#             col.ind = Tabla1$CONSUMO_HONGOS, # color by groups\n             #palette = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n#             addEllipses = TRUE, # Concentration ellipses\n#             legend.title = \"Groups\"\n#             )\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"ACP.html"},"language":{"toc-title-document":"Tabla de contenidos","toc-title-website":"En esta página","related-formats-title":"Otros formatos","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Fuente","other-links-title":"Otros Enlaces","code-links-title":"Enlaces de código","launch-dev-container-title":"Iniciar Dev Container","launch-binder-title":"Iniciar Binder","article-notebook-label":"Cuaderno de Artículo","notebook-preview-download":"Descargar Cuaderno","notebook-preview-download-src":"Descargar código fuente","notebook-preview-back":"Volver al Artículo","manuscript-meca-bundle":"Archivo MECA","section-title-abstract":"Resumen","section-title-appendices":"Apéndices","section-title-footnotes":"Notas","section-title-references":"Referencias","section-title-reuse":"Reutilización","section-title-copyright":"Derechos de autor","section-title-citation":"Cómo citar","appendix-attribution-cite-as":"Por favor, cita este trabajo como:","appendix-attribution-bibtex":"BibTeX","title-block-author-single":"Autor/a","title-block-author-plural":"Autores/as","title-block-affiliation-single":"Afiliación","title-block-affiliation-plural":"Afiliaciones","title-block-published":"Fecha de publicación","title-block-modified":"Fecha de modificación","title-block-keywords":"Palabras clave","callout-tip-title":"Tip","callout-note-title":"Nota","callout-warning-title":"Advertencia","callout-important-title":"Importante","callout-caution-title":"Precaución","code-summary":"Código","code-tools-menu-caption":"Código","code-tools-show-all-code":"Mostrar todo el código","code-tools-hide-all-code":"Ocultar todo el código","code-tools-view-source":"Ver el código fuente","code-tools-source-code":"Ejecutar el código","tools-share":"Compartir","tools-download":"Descargar","code-line":"Línea","code-lines":"Líneas","copy-button-tooltip":"Copiar al portapapeles","copy-button-tooltip-success":"Copiado","repo-action-links-edit":"Editar esta página","repo-action-links-source":"Ver el código","repo-action-links-issue":"Informar de un problema","back-to-top":"Volver arriba","search-no-results-text":"Sin resultados","search-matching-documents-text":"documentos encontrados","search-copy-link-title":"Copiar el enlace en la búsqueda","search-hide-matches-text":"Ocultar resultados adicionales","search-more-match-text":"resultado adicional en este documento","search-more-matches-text":"resultados adicionales en este documento","search-clear-button-title":"Borrar","search-text-placeholder":"","search-detached-cancel-button-title":"Cancelar","search-submit-button-title":"Enviar","search-label":"Buscar","toggle-section":"Alternar sección","toggle-sidebar":"Alternar barra lateral","toggle-dark-mode":"Alternar modo oscuro","toggle-reader-mode":"Alternar modo lector","toggle-navigation":"Navegación de palanca","crossref-fig-title":"Figura","crossref-tbl-title":"Tabla","crossref-lst-title":"Listado","crossref-thm-title":"Teorema","crossref-lem-title":"Lema","crossref-cor-title":"Corolario","crossref-prp-title":"Proposición","crossref-cnj-title":"Conjetura","crossref-def-title":"Definición","crossref-exm-title":"Ejemplo","crossref-exr-title":"Ejercicio","crossref-ch-prefix":"Capítulo","crossref-apx-prefix":"Apéndice","crossref-sec-prefix":"Sección","crossref-eq-prefix":"Ecuación","crossref-lof-title":"Listado de Figuras","crossref-lot-title":"Listado de Tablas","crossref-lol-title":"Listado de Listados","environment-proof-title":"Prueba","environment-remark-title":"Observación","environment-solution-title":"Solución","listing-page-order-by":"Ordenar por","listing-page-order-by-default":"Por defecto","listing-page-order-by-date-asc":"Menos reciente","listing-page-order-by-date-desc":"Más reciente","listing-page-order-by-number-desc":"De mayor a menor","listing-page-order-by-number-asc":"De menor a mayor","listing-page-field-date":"Fecha","listing-page-field-title":"Título","listing-page-field-description":"Descripción","listing-page-field-author":"Autor/a","listing-page-field-filename":"Nombre de archivo","listing-page-field-filemodified":"Fecha de modificación","listing-page-field-subtitle":"Subtítulo","listing-page-field-readingtime":"Tiempo de lectura","listing-page-field-wordcount":"Conteo de Palabras","listing-page-field-categories":"Categorías","listing-page-minutes-compact":"{0} minutos","listing-page-category-all":"Todas","listing-page-no-matches":"No hay resultados","listing-page-words":"{0} palabras"},"metadata":{"lang":"es","fig-responsive":true,"quarto-version":"1.4.549","editor":"visual","theme":{"light":"simplex","dark":"slate"},"toc-expand":2,"toc-title":"Tabla de contenidos","toc-location":"right","title":"Análisis de Componentes Principales"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}