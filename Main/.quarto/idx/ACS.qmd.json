{"title":"Análisis de Correspondencias Múltiples","markdown":{"yaml":{"title":"Análisis de Correspondencias Múltiples","format":"html","editor":"visual"},"headingText":"ACM de nuestro objetivo","containsRefs":false,"markdown":"\n\nDado que nuestro conjunto de datos presenta un alto número de variables cualitativas, es necesario considerar y analizar el efecto que estas pueden tener en las condiciones de vida de la población privada de la libertad. Siendo así, exploraremos las posibles relaciones que pueden existir entre estas variables mediante un Análisis de Correspondencias Múltiple.\n\nPara el desarrollo del análisis de correspondencias múltiples (ACM, o en inglés, *Multiple Correspondence Analysis, MCA*), haremos uso de los mismos paquetes utilizados para el análisis de correspondencias principales (ACP). Si bien puede ser redundante el uso de estos 4 paquetes en el mismo código, cada uno de estos ofrece funciones que nos ayudaran a dar una mejor representación gráfica de los resultados obtenidos por el ACM.\n\nAdemás, evitaremos la notación científica mediante el `options(scipen=999).`\n\n```{r}\n#| label: carga-librerias\n#| message: false\n#| echo: true\n#| output: false\n\n#Manejo de datos\nlibrary(tidyverse)\nlibrary(readr)\nlibrary(dplyr)\nlibrary(readxl)\n#Gráficos\nlibrary(ggplot2)\nlibrary(gridExtra)\nlibrary(plotly)\nlibrary(GGally)\n#ACP\nlibrary(ade4)\nlibrary(FactoClass)\nlibrary(FactoMineR)\nlibrary(factoextra)\n#Datos importados\nsource(\"DatosSeleccionados.R\")\n\n#Ajustes de tema del documento y graficos\nlibrary(scales)\nlibrary(DT)\nlibrary(gt)\nlibrary(RColorBrewer)\ntheme_set(theme_minimal(base_size = 24, base_family = \"Atkinson Hyperlegible\"))\nlibrary(hrbrthemes)\noptions(scipen=999) #Evitar notación científica\n```\n\nComo fue visto en el ACP. Las variables relacionadas a la edad en la cual consumieron alguna sustancia psicoactiva por primera vez presentaba una particularidad en sus valores. Pues varios individuos fueron notados con la edad de 99 para indicar que el individuo nunca ha consumido dicha sustancia.\n\nEstas respuestas, al ser tratadas como datos numéricos en un ACP, pueden distorsionar los resultados tales como:\n\n-   **Sesgo en la Varianza Explicada:** Los valores \"98\" y \"99\" pueden influir de manera significativa en la varianza explicada por los componentes principales, distorsionando la interpretación de los resultados. Estas respuestas no presentan variabilidad real en la población estudiada, sino falta de información, lo que afecta la estructura de correlaciones entre las variables.\n-   **Falsa Apariencia de Relaciones:** En el ACP, los valores numéricos asignados a respuestas de \"no sabe\" o \"no responde\" pueden crear artificialmente relaciones lineales entre variables que no existen realmente, sesgando los componentes principales y reduciendo la claridad de los resultados.\n\nPor lo tanto, es posible que los resultados que el ACP brindaban respecto a estas variables no sean correctos o válidos. Siendo así, se decidió transformar estas y otras variables cuantitativas en variables cualitativas mediante el proceso de discretización, el cual consiste en construir categorias a partir de intervalos; posteriormente, se consideró la inclusión de estas variables dentro del ACM.\n\n\n```{r}\n#| label: Seleccion-variables\n#| echo: false\n#| warning: false\n#| output: false\n#http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/#r-packages\n#Escogemos las variables cuantitativas\nvarCualitativas<-c(\"TIPO_CARCEL\",\"EST_CIVIL\",\"NIVEL_ESCOLARIDAD\",\"PARO_ESTUDIOS\",\"ORIENT_SEXUAL\",\"DISC_MOTRIZ\",\"COLOR_PIEL\",\"CARCEL_LECTURA\",\"CARCEL_EJERCICIO\",\"CELDA_ALIMENTOS\",\"CELDA_SERVICIO_MEDICO\",\"CELDA_DUCHA\",\"DECLARACION_CULPABLE\",\"CATEGORIAS_TIEMPO_RECLUIDO\",\"CATEGORIAS_TIEMPO_PROCESO\",\"CAR_PERSONAS_CELDA\")\n\n\n#DatosCuantitativos<-Tabla1[,varCuantitativas]\nDatosCualitativos<-Tabla1[,varCualitativas]\n#correlaciones<-cor(DatosCuantitativos)\n```\n\nSeleccionamos las variables a incluir dentro de nuestro ACM. Siguiendo con nuestro objetivo principal de este estudio, fueron consideradas aquellas variables que mostraron una comportamiento de correlación entre sus categorias con la cantidad de personas en la celda (discretizada) mediante las tablas de perfiles vistas en el [análisis descriptivo bivariado](https://qglhmj-juan0pablo-montano0diaz.shinyapps.io/analisis_descriptivo_bivariado/) y el [análisis de correspondencias simple](https://qglhmj-juan0pablo-montano0diaz.shinyapps.io/CorrespondenciaSimples/).\n\n::: {style=\"display: flex;\"}\n::: {style=\"flex: 50%; padding-right: 10px;\"}\n<h4>**Variables consideradas en el ACM**</h4>\n\n<ul>\n\n<li>Tipo de Carcel</li>\n\n<li>Nivel de Escolaridad</li>\n\n<li>Motivo por el que dejó de estudiar</li>\n\n<li>Motivo por el que se declaró culpable</li>\n\n<li>Tiempo que lleva recluido (discretizada)</li>\n\n<li>Tiempo que lleva en proceso (discretizada)</li>\n\n<li>**Cantidad de personas en la celda (discretizada)**</li>\n\n</ul>\n:::\n\n::: {style=\"flex: 50%; padding-left: 10px;\"}\n<h4>\n\n</h4>\n\n<ul>\n\n<li>Estado Civil</li>\n\n<li>Orientación Sexual</li>\n\n<li>Discapacidad Motriz</li>\n\n<li>Color de Piel</li>\n\n<li>Puede leer en la carcel</li>\n\n<li>Puede hacer ejercicio en la carcel</li>\n\n<li>Cuenta con alimentos en la celda</li>\n\n<li>Servicio médico en la celda</li>\n\n<li>Cuenta con una ducha en la celda</li>\n\n</ul>\n:::\n:::\n\nCon estas variables, tenemos la siguiente tabla disyuntiva completa (TDC). Con la cual construiremos nuestro ACM.\n\n```{r}\n#| label: Tabla-disyuntiva-completa1\n#| echo: false\n#| warning: false\n#| output: false\nDatosCualitativos <- data.frame(lapply(DatosCualitativos, as.factor))\n\nZ <- acm.disjonctif(DatosCualitativos) # función de ade4\n```\n\n```{r}\n#| label: Tabla-disyuntiva-completa-visualizacion\n#| echo: false\n#| warning: false\n#| output: true\n\nZ |> head(n=50) |>\n  datatable(\n    options = list(dom = 'ftp', paging = TRUE)\n    )\n```\n\nComo se observó en el análisis descriptivo univariado, algunas de las variables cualitativas presentan categorías de baja frecuencia, lo que puede afectar los valores de inercia, distorsionar la geometría del plano factorial, generar ruido en los resultados y, en consecuencia, dificultar la interpretación de nuestro ACM. Por esta razón, realizaremos dos análisis: el primero incluirá todas las categorías, incluidas las de baja frecuencia; el segundo considerará únicamente aquellas categorías que representen más del 1% de la población en cada variable.\n\nPara realizar esto último, se utilizará la técnica de \"ventilación\" en las categorias de baja frecuencia. Esta técnica trata de evitar que las categorías de baja frecuencia tengan una influencia desproporcionada en el ACM. Para esto, redistribuye estas categorías poco frecuentes entre las otras categorías, de manera que no generen distorsiones en el análisis.\n\n```{r}\n#| label: funcion-interactive\n#| echo: false\n#| warning: false\n#| output: false\n#Z <- as.matrix(Z)\n#(B <- t(Z) %*% Z)\n\n\nfviz_mca_var_interactive <- function(acm, axes = c(1, 2), repel = TRUE, ggtheme = theme_minimal(), col.var = \"cos2\", gradient.cols = NULL,quali.col=\"green\") {\n  \n  # Calcula la varianza explicada para los ejes seleccionados\n  eigenvalues <- acm$eig\n  var_explained_x <- round(eigenvalues[axes[1], 2], 2)\n  var_explained_y <- round(eigenvalues[axes[2], 2], 2)\n  \n  # Extrae las coordenadas y nombres de las variables activas\n  var_data <- acm$var$coord\n  var_data_df <- data.frame(var_data)\n  var_data_df$Variable <- rownames(var_data_df)\n  var_data_df$Type <- \"Activa\"  # Marcamos las variables activas\n  \n  # Detecta automáticamente las variables cualitativas suplementarias y las añade\n  if (!is.null(acm$quali.sup)) {\n    quali_sup_data <- acm$quali.sup$coord\n    quali_sup_df <- data.frame(quali_sup_data)\n    quali_sup_df$Variable <- rownames(quali_sup_df)\n    quali_sup_df$Type <- \"Suplementaria\"  # Marcamos las variables suplementarias\n    \n    # Unimos las variables activas y suplementarias\n    var_data_df <- rbind(var_data_df, quali_sup_df)\n  }\n  \n  # Añade la columna correspondiente al color si se usa col.var como en la función original\n  if (col.var == \"cos2\") {\n    # Crear una columna de color para las variables activas\n    active_cos2 <- get_mca_var(acm)$cos2[, axes[1]]\n    var_data_df$Color <- NA  # Inicializa la columna Color con NA\n    var_data_df$Color[var_data_df$Type == \"Activa\"] <- as.numeric(active_cos2)  # Solo activas con cos2, convertido a numérico\n    var_data_df$Color[var_data_df$Type == \"Suplementaria\"] <- NA  # Suplementarias no tendrán color en cos2\n    \n    p <- ggplot(var_data_df, aes(x = !!sym(colnames(var_data_df)[axes[1]]), \n                                 y = !!sym(colnames(var_data_df)[axes[2]]), \n                                 text = Variable, color = Color, shape = Type)) +\n      geom_point(size = 0.75, fill = \"red\",shape=25) +\n      theme_minimal() +\n      scale_color_gradientn(colors = gradient.cols, na.value = quali.col) +  # Aplica el gradiente solo a las activas\n      labs(x = paste0(\"Dim \", axes[1], \" (\", var_explained_x, \"%)\"),\n           y = paste0(\"Dim \", axes[2], \" (\", var_explained_y, \"%)\"))\n  } else {\n    # Usa un color fijo si no se especifica un gradiente\n    p <- ggplot(var_data_df, aes(x = !!sym(colnames(var_data_df)[axes[1]]), \n                                 y = !!sym(colnames(var_data_df)[axes[2]]), \n                                 text = Variable, shape = Type, color = Type)) +\n      geom_point(size = 0.75,shape=25) +\n      scale_color_manual(values = c(\"Activa\" = \"red\", \"Suplementaria\" = quali.col)) +\n      theme_minimal() +\n      labs(x = paste0(\"Dim \", axes[1], \" (\", var_explained_x, \"%)\"),\n           y = paste0(\"Dim \", axes[2], \" (\", var_explained_y, \"%)\"))\n  }\n  \n  # Agrega las líneas punteadas centradas en el plano cartesiano\n  p <- p + \n    geom_hline(yintercept = 0, linetype = \"dashed\", color = \"gray\") + \n    geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray\")\n  \n  # Conviértelo en un gráfico interactivo con plotly\n  plotly_obj <- ggplotly(p, tooltip = \"text\") %>% \n    style(hoverinfo = \"text\")  # Solo muestra el texto (Variable) al pasar el mouse\n  \n  # Retorna el gráfico interactivo\n  return(plotly_obj)\n}\n\n\n\n```\n\n```{r}\n#| label: MCA1\n#| echo: true\n#| output: false\n\n#MCA que incluye todas las categorias\nacm <- MCA(DatosCualitativos, graph=FALSE)\n\n\n#MCA con ventilación de aquellas categorias menores al 1%\nacm_ventil<-MCA(DatosCualitativos,graph = FALSE,level.ventil = 0.01)\n```\n\nAhora, mostraremos los resultados obtenidos por estos dos análisis de correspondencias múltiples.\n\n## Resultados de la inclusión de todas las categorías\n\nInicialmente, observaremos cuánta información es capturada por cada uno de los ejes obtenidos. Para ello, analizaremos los valores de inercia y los $cos^2$ asociados a cada eje, lo que nos permitirá evaluar la calidad de la representación de las variables en esos ejes. Además, dado que es posible la presencia de ejes \"parásitos\", utilizaremos el Criterio de Benzécri para ajustar los valores de inercia, con el fin de obtener una medida más precisa de la información capturada por cada una de las dimensiones.\n\n### Análisis de los ejes\n\n::: panel-tabset\n#### Valores propios\n\n```{r}\n#| label: screeplot1\n#| echo: false\n#| output: true\nscreeplot <- fviz_screeplot(acm, addlabels = TRUE, ylim = c(0, 20)) +  ggtitle(\"Scree Plot\") + theme_minimal()+ylab(\"Porcentaje de varianza explicada\")+xlab(\"Ejes\")\n## Usando modif.rate() del paquete GDAtools:\n# ptau <- modif.rate(acm)$modif[, 1]\n## Haciendo las cuentas uno mismo:\ns <- ncol(DatosCualitativos)\nl <- acm$eig[acm$eig[,1] > 1/s, 1]\ntau <- ( s / (s - 1) )^2 * ( l - (1/s) )^2\nptau <- tau / sum( tau ) * 100\n\n# Creamos un data frame para usar con ggplot2\nbarplot_df <- data.frame(Indice = factor(1:length(ptau)), Valor = ptau)\n\n# Creamos el gráfico de barras con ggplot2\nbarplot_gg <- ggplot(barplot_df, aes(x = Indice, y = Valor)) +\n  geom_bar(stat = \"identity\", fill = \"darkred\") +\n  ylim(0, max(barplot_df$Valor+10)) +\n  labs(x = \"Ejes\", y = expression(tau(lambda))) +\n  theme_minimal() +\n  ggtitle(\"Criterio de Benzécri\")\n\ngrid.arrange(screeplot, barplot_gg, ncol = 1)\n```\n\nSegún los valores propios, cada uno de los ejes posee información a atribuir, sin embargo, ninguna de estas es considerable. Dando indicios que las variables son independientes. Por otro lado, el Criterio de Benzécri nos muestra que los primeros 3-4 ejes, son los que poseen la mayor cantidad de inercia del análisis.\n\n#### Contribución 1er eje\n\n```{r}\n#| label: contribacm1\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acm, choice = \"var\", axes = 1) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nSe puede observar que esta dimensión la componen unicamente las categorías de \"No sabe\" y \"No responde\" de varias de las variables. Esto es de esperarse, pues dada su poca frecuencia, son las que más contribuyen a la inercia.\n\n#### Contribución 2do eje\n\n```{r}\n#| label: contribacm2\n#| echo: false\n#| output: true\ncontrib<-fviz_contrib(acm, choice = \"var\", axes = 2)\ncontrib<-contrib+theme(axis.text.x = element_text(size =3.5, angle = 90, hjust = 1))\n\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nPuede observarse que este eje está hecha principalmente por las variables discretizadas de TIEMPO_PROCESO y TIEMPO_RECLUIDO.También, las categorias de PARO_ESTUDIOS.No.paró.estudios y Nivel_Escolaridad.08 (correspondiente a nivel de estudios profesional completado), poseen un gran aporte a la construcción de este eje.\n\n#### Contribución 3er eje\n\n```{r}\n#| label: contribacm3\n#| echo: false\n#| output: true\n\ncontrib<-fviz_contrib(acm, choice = \"var\", axes = 3)\ncontrib<-contrib+theme(axis.text.x = element_text(size =3.5, angle = 90, hjust = 1))\n\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nEste eje está compuesto por las categorias de No paró estudios y nivel de estudios profesional completado. Esto tiene sentido, pues desde un punto de vista conceptual, estas 2 categorías son equivalentes.\n\n#### Contribución 4to eje\n\n```{r}\n#| label: contribacm4\n#| echo: false\n#| output: true\n\ncontrib<-fviz_contrib(acm, choice = \"var\", axes = 4)\ncontrib<-contrib+theme(axis.text.x = element_text(size =3.5, angle = 90, hjust = 1))\n\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nEste eje está principalmente compuesto por la categoría 0-2 de la variable CANTIDAD DE PERSONAS EN LA CELDA, junto con otras condiciones de la vida intracarcelaria, que son no contar con una ducha en la celda y pertenecer a una carcel mixta.\n:::\n\nSegún lo visto en los anteriores gráficos, decidimos considerar los primeros 4 ejes para el análisis de los individuos y de las variables. Que se pueden resumir a *grosso modo* de la siguiente forma:\n\n-   **1er eje:** Representa la no respuesta en las variables categoricas\n-   **2do eje:** Determinado principalmentepor no tener tiempo recluido, es decir, las personas que están siendo PROCESADAS, mas no CONDENADAS. También, representa a las personas que culminaron de forma exitosa sus estudios.\n-   **3er eje:** Representa principalmente a la personas que culminaron sus estudios hasta un nivel universitario.\n-   **4to eje:** Representa a las personas que comparten celda con pocas personas, y su condición de poseer ducha en la celda o no.\n\n### Proyección de los individuos en los planos factoriales\n\nUna vez determinados cómo están compuestos los 4 ejes considerados en el ACM, realizaremos la proyección de los individuos. Si bien esto no aporta mucho a la investigación dado que los individuos están anonimizados, nos puede ayudar a la identificación de patrones dentro de la población estudiada.\n\n::: panel-tabset\n#### Ejes 1-2\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_ind(acm, axes=c(1,2), geom=\"point\", asp=1, col.ind = \"cos2\",ggtheme=theme_minimal())\n\n\n```\n\nComo vimos en las contribuciones, el eje está determinado principalmente por las categorias de No sabe y No responde, por lo tanto, puede decirse que los individuos más alejados del centro son aquellos que pertenecen a estas categorías en alguna de las variables consideradas.\n\nDado que esta población es una minoria en la población estudiada, la mayoría de puntos se encuentran concentrados en el origen y alrededor del segundo eje.\n\n#### Ejes 1-3\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_ind(acm, axes=c(1,3), geom=\"point\", col.ind = \"cos2\",ggtheme=theme_minimal())\n```\n\nEn este plano acontece la misma situación que el plano anterior, pues el eje 1 separa a las personas de las categorías No sabe/ No responde de las demás personas.\n\n#### Ejes 1-4\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_ind(acm, axes=c(1,4), geom=\"point\", col.ind = \"cos2\",ggtheme=theme_minimal())\n```\n\nEn este plano acontece la misma situación que en los planos anteriores, pues el eje 1 separa a las personas de las categorías No sabe/ No responde de las demás personas.\n\n#### Ejes 2-3\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_ind(acm, axes=c(2,3), geom=\"point\", asp=1, col.ind = \"cos2\",ggtheme=theme_minimal())\n\n\n```\n\nDado que el eje 2 está representado por llevar 0 años recluido (es decir, estar siendo procesado), y que el eje 3 está categorizado principalmente por las personas que acabaron sus estudios. Los dos grandes grupos observados en el gráfico podrían representar diferencias entre individuos que están en distintas etapas judiciales (por ejemplo, procesados frente a condenados) y diferencias en el nivel educativo. Esto se analizará más en detalle en el análisis de las variables.\n\n#### Ejes 2-4\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_ind(acm, axes=c(2,4), geom=\"point\", asp=1, col.ind = \"cos2\",ggtheme=theme_minimal())\n\n\n```\n\nAl igual que en plano anterior, se ve una separación de un grupo considerablemente grande de la población. Esto puede deberse debido a que dichos individuos están siendo procesados y no han sido condenados.\n\n#### Ejes 3-4\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_ind(acm, axes=c(3,4), geom=\"point\", asp=1, col.ind = \"cos2\",ggtheme=theme_minimal())\n\n\n```\n\nAl igual que en plano anterior, se ve una separación de dos grupos de tamaño considerable de la población. En este caso, puede deberse debido a que dichos individuos poseen niveles de educación de profesional o de posgraduación.\n:::\n\nDe lo anteriormente visto en el análisis, puede verse que los ejes cumplen su papel en la separación y clasificación mediante sus categorías en determinadas variables. Sin embargo, dado que los individuos están anonimizados, no tenemos mayor información sobre estos grupos.\n\nSiendo así, nos centraremos en el análisis de las variables para una mejor comprensión de los resultados mostrados.\n\n### Proyección de las variables en los planos factoriales\n\nAhora, proyectaremos las categoarias de cada una de las variables cualitativas consideradas en nuestro ACM para hallar posibles relaciones entre estas.\n\n::: panel-tabset\n#### Ejes 1-2\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acm, axes=c(1,2), repel = TRUE,col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"), ggtheme=theme_minimal())\n\n\n```\n\nComo se mencionó anteriormente, las categorías de \"no sabe/no responde\" contribuyeron a la construcción de este eje y muestran una relación entre sí. Desde su significado, las variables alas que pertenecen estas categorías corresponden a diferentes aspectos de la vida intracarcelaria. Por lo tanto, puede decirse que, en general, las personas que no quisieron hablar sobre alguno de estos aspectos no proporcionaron información sobre sus condiciones de vida dentro del centro penitenciario.\n\n#### Ejes 2-3\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acm, axes=c(2,3), repel = TRUE, col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),ggtheme=theme_minimal())\n```\n\nConcordando con el análisis hecho desde las contribuciones y la proyección de los individuos, el eje 2 representa y muestra las relaciones entre las categorías del tiempo que una persona lleva siendo procesada o cumpliendo su condena, mostrando estos dos estados como opuestos. Por su parte, el eje 3 refleja principalmente la relación entre la categoría \"no paró estudios\" y un nivel educativo igual o superior al profesional. Lo que es lógico desde un punto de vista conceptual.\n\n#### Ejes 2-4\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acm, axes=c(2,4), repel = TRUE,col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"), ggtheme=theme_minimal())\n```\n\nEste plano muestra con más detalle algunas relaciones ya vistas, como lo son por ejemplo, la relación entre el tiempo de condena y el motivo por el cual se declaró culpable.\n\nSiendo así, tenemos que las personas que en este momento están siendo procesadas, normalmente tienen un proceso de 2 a 6 años de proceso. También, las personas que reconocieron la responsabilidad o que fueron complices de un delito, tienden a tener entre 1 a 6 años de condena.\n:::\n\nDe estos ejes se concluye que las categorias de \"No responde\" entre las variables de vida intracarcelaria están relacionadas. Además del estado opuesto del tiempo procesado y tiempo recluído y finalmente, la relación entre un nível de estudios profesional y la categoría \"No paró estudios\".\n\nEs posible observar otras relaciones entre las categorías, como por ejemplo, la cantidad de personas en la celda y el nível educativo o, declararse culpable y el tiempo que llevan en condena.\n\n### Contribución de cada variable\n\nFinalmente, veremos la contribución de cada una de las variables categóricas a cada uno de los planos factoriales considerados. Siendo así, si una variable se encuentra alejada del origen y sobre el eje $x$, quiere decir que dicha variable contribuyó de forma significativa a la construcción de dicho eje, para el eje $y$ se sigue un razonamiento análogo.\n\nEn el caso donde una variable haya aportado a la construcción de ambos ejes, entonces este se encontrará alejado de los ejes.\n\n::: panel-tabset\n#### Ejes 1-2\n\n```{r}\n#| label: contribucion-correlacion\n#| echo: false\n#| warning: false\n#| output: true\n\n# Crear el gráfico ggplot\ngg <- ggplot(data = acm$var$eta2, aes(x = !!sym(\"Dim 1\"), y = !!sym(\"Dim 2\"), label = rownames(acm$var$eta2), text = rownames(acm$var$eta2))) +\n  geom_point(size=0.75, shape=75, colour=\"blue3\") +  # Añadir los puntos\n  geom_text_repel(aes(label = rownames(acm$var$eta2)), size = 3) +  # Añadir las etiquetas\n  theme_minimal() +  # Aplicar un tema minimalista\n  labs(title = \"MCA - Correlación de variables\", \n       x = \"Dim 1\", y = \"Dim 2\") +  # Añadir títulos y etiquetas\n  scale_x_continuous(expand = c(0, 0), limits = c(-0.1, 1), breaks = seq(-0.1, 1, by = 0.1)) +  # Ajustar los límites del eje x\n  scale_y_continuous(expand = c(0, 0), limits = c(-0.1, 1), breaks = seq(-0.1, 1, by = 0.1)) +  # Ajustar los límites del eje y\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"gray50\") +  # Añadir línea horizontal en y = 0\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\")    # Añadir línea vertical en x = 0\n\n# Convertir el gráfico ggplot a plotly y mostrar el nombre de la variable al pasar el mouse\nggplotly(gg, tooltip = \"text\")\n\n```\n\nEn este caso, se tiene que para la construcción del primer y segundo ejese utilizaron variables diferentes. Pues en el caso del primer eje se utilizaron variables de la vida intracarcelaria y en el segundo eje se usó el tiempo que la persona lleva en la carcel y el nivel de escolaridad.\n\n#### Ejes 2-3\n\n```{r}\n#| label: contribucion-correlacion2\n#| echo: false\n#| warning: false\n#| output: true\n\n# Crear el gráfico ggplot\ngg <- ggplot(data = acm$var$eta2, aes(x = !!sym(\"Dim 2\"), y = !!sym(\"Dim 3\"), label = rownames(acm$var$eta2), text = rownames(acm$var$eta2))) +\n  geom_point(size=0.75, shape=75, colour=\"blue3\") +  # Añadir los puntos\n  geom_text_repel(aes(label = rownames(acm$var$eta2)), size = 3) +  # Añadir las etiquetas\n  theme_minimal() +  # Aplicar un tema minimalista\n  labs(title = \"MCA - Correlación de variables\", \n       x = \"Dim 2\", y = \"Dim 3\") +  # Añadir títulos y etiquetas\n  scale_x_continuous(expand = c(0, 0), limits = c(-0.1, 1), breaks = seq(-0.1, 1, by = 0.1)) +  # Ajustar los límites del eje x\n  scale_y_continuous(expand = c(0, 0), limits = c(-0.1, 1), breaks = seq(-0.1, 1, by = 0.1)) +  # Ajustar los límites del eje y\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"gray50\") +  # Añadir línea horizontal en y = 0\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\")    # Añadir línea vertical en x = 0\n\n# Convertir el gráfico ggplot a plotly y mostrar el nombre de la variable al pasar el mouse\nggplotly(gg, tooltip = \"text\")\n\n\n```\n\nEn este caso, puede observarse que el segundo y tercer eje están compuestos por las mismas variables, pero con peso diferente en sus contribuciones. Siendo así, la variable de tiempo en la carcel poseyó un mayor peso en la construcción del segundo eje, y el nivel de escolaridad tuvo un mayor peso en sus contribuciones al tercer eje\n\n#### Ejes 1-4\n\n```{r}\n#| label: contribucion-correlacion3\n#| echo: false\n#| warning: false\n#| output: true\ngg <- ggplot(data = acm$var$eta2, aes(x = !!sym(\"Dim 1\"), y = !!sym(\"Dim 4\"), label = rownames(acm$var$eta2), text = rownames(acm$var$eta2))) +\n  geom_point(size=0.75, shape=75, colour=\"blue3\") +  # Añadir los puntos\n  geom_text_repel(aes(label = rownames(acm$var$eta2)), size = 3) +  # Añadir las etiquetas\n  theme_minimal() +  # Aplicar un tema minimalista\n  labs(title = \"MCA - Correlación de variables\", \n       x = \"Dim 1\", y = \"Dim 4\") +  # Añadir títulos y etiquetas\n  scale_x_continuous(expand = c(0, 0), limits = c(-0.1, 1), breaks = seq(-0.1, 1, by = 0.1)) +  # Ajustar los límites del eje x\n  scale_y_continuous(expand = c(0, 0), limits = c(-0.1, 1), breaks = seq(-0.1, 1, by = 0.1)) +  # Ajustar los límites del eje y\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"gray50\") +  # Añadir línea horizontal en y = 0\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\")    # Añadir línea vertical en x = 0\n\n# Convertir el gráfico ggplot a plotly y mostrar el nombre de la variable al pasar el mouse\nggplotly(gg, tooltip = \"text\")\n\n```\n\nFinalmente, entre las relaciones vistas, puede verse que el eje 1 y el eje 4 fueron construidas a partir de las variables de vida intracarcelaria. Teniendo como variables principales, la cantidad de personas en la celda y la ´resencia de una ducha dentro de esta.\n:::\n\n## Resultados sin considerar las categorías de baja frecuencia\n\nAhora, realizaremos el mismo proceso y análisis anterior, con los resultados obtenidos al descartar el efecto de aquellas categorias que representaban amenos del 1% de la población. En este caso, solo resaltaremos las diferencias y los nuevos resultados que no fueron vistos en el ACM anterior.\n\n### Análisis de los ejes\n\n::: panel-tabset\n#### Valores propios\n\n```{r}\n#| label: screeplot1_ventil\n#| echo: false\n#| output: true\nscreeplot <- fviz_screeplot(acm_ventil, addlabels = TRUE, ylim = c(0, 20)) +  ggtitle(\"Scree Plot\") + theme_minimal()+ylab(\"Porcentaje de varianza explicada\")+xlab(\"Ejes\")\n## Usando modif.rate() del paquete GDAtools:\n# ptau <- modif.rate(acm)$modif[, 1]\n## Haciendo las cuentas uno mismo:\ns <- ncol(DatosCualitativos)\nl <- acm_ventil$eig[acm_ventil$eig[,1] > 1/s, 1]\ntau <- ( s / (s - 1) )^2 * ( l - (1/s) )^2\nptau <- tau / sum( tau ) * 100\n\n# Creamos un data frame para usar con ggplot2\nbarplot_df <- data.frame(Indice = factor(1:length(ptau)), Valor = ptau)\n\n# Creamos el gráfico de barras con ggplot2\nbarplot_gg <- ggplot(barplot_df, aes(x = Indice, y = Valor)) +\n  geom_bar(stat = \"identity\", fill = \"darkred\") +\n  ylim(0, max(barplot_df$Valor+10)) +\n  labs(x = \"Ejes\", y = expression(tau(lambda))) +\n  theme_minimal() +\n  ggtitle(\"Criterio de Benzécri\")\n\ngrid.arrange(screeplot, barplot_gg, ncol = 1)\n```\n\n#### Contribución 1er eje\n\n```{r}\n#| label: contribacm1_ventil\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acm_ventil, choice = \"var\", axes = 1) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nCon algunas diferencias en el porcentaje que contribuye cada variable a la construcción del eje. Este eje está compuesto por las mismas variables que componen al segundo eje de nuestro ACM anterior.\n\n#### Contribución 2do eje\n\n```{r}\n#| label: contribacm2_ventil\n#| echo: false\n#| output: true\ncontrib<-fviz_contrib(acm_ventil, choice = \"var\", axes = 2)\ncontrib<-contrib+theme(axis.text.x = element_text(size =3.5, angle = 90, hjust = 1))\n\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nCon algunas diferencias en el porcentaje que contribuye cada variable a la construcción del eje. Este eje está compuesto por las mismas variables que componen al tercer eje de nuestro ACM anterior.\n\n#### Contribución 3er eje\n\n```{r}\n#| label: contribacm3-ventil\n#| echo: false\n#| output: true\n\ncontrib<-fviz_contrib(acm_ventil, choice = \"var\", axes = 3)\ncontrib<-contrib+theme(axis.text.x = element_text(size =3.5, angle = 90, hjust = 1))\n\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nCon algunas diferencias en el porcentaje que contribuye cada variable a la construcción del eje. Este eje está compuesto por las mismas variables que componen al cuarto eje de nuestro ACM anterior.\n\n#### Contribución 4to eje\n\n```{r}\n#| label: contribacm4_ventil\n#| echo: false\n#| output: true\n\ncontrib<-fviz_contrib(acm_ventil, choice = \"var\", axes = 4)\ncontrib<-contrib+theme(axis.text.x = element_text(size =3.5, angle = 90, hjust = 1))\n\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nPese a que no fue mostrado anteriormente, este eje corresponde a nuestro 5 eje obtenido en el ACM anterior. Está compuesto principalmente por variables de la vida intracarcelaria, siendo de interés para nuestro estudio.\n\nSin embargo, en el ACM anterior, no mostró resultados significativos, por lo que no fue considerado en los gráficos mostrados.\n:::\n\nInicialmente, puede verse que este ACM ha disminuido el ruido de las variables retirando aquellas categorías que no nos dan información para neustro estudio. Si bien, no tenemos la conclusión anterior sobre la relación de estas categorías y la vida intracarcelaria, la exclusión de estas categorías puede ayudarnos a facilitar la interpretación de los resultados.\n\n### Proyección de los individuos en los planos factoriales\n\n::: panel-tabset\n#### Ejes 1-2\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_ind(acm_ventil, axes=c(1,2), geom=\"point\", asp=1, col.ind = \"cos2\",ggtheme=theme_minimal())\n\n\n```\n\n#### Ejes 2-3\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_ind(acm_ventil, axes=c(2,3), geom=\"point\", col.ind = \"cos2\",ggtheme=theme_minimal())\n```\n\n#### Ejes 1-4\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_ind(acm_ventil, axes=c(1,4), geom=\"point\", col.ind = \"cos2\",ggtheme=theme_minimal())\n```\n:::\n\nPueden observarse con mayor claridad las agrupaciones hechas por las categorías. Sin embargo, no presentan distinciones claras de los resultados anteriores. Por lo que podrían llegarse a los mismos comentarios.\n\n### Proyección de las variables en los planos factoriales\n\n::: panel-tabset\n#### Ejes 1-2\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acm_ventil, axes=c(1,2), repel = TRUE,col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"), ggtheme=theme_minimal())\n\n\n```\n\nObtenemos resultados similares a los anteriores. Sin embargo, se posee la ventaja que podemos observar algunas relaciones con más claridad.\n\nPor ejemplo, la relación entre el tiempo de condena y la forma en como el individuo fue declarado culpable. Las personas que reconocieron sus hechos o que admitieron ser complices tuvieron alrededor de 0.8 a 6.5 años de condena.\n\nTambién, la relación entre algunos tonos de piel, el nivel de escolaridad y el motivo por el cual pararon de estudiar. Finalmente, hay una relación entre ser homosexual y compartir celda con pocas personas.\n\nFinalmente, la cercanía de algunas variables con los ejes nos dan indicios de que, las carceles femeninas están relacionadas con las personas que están siendo procesadas, y que las personas que no cuenta con servicio médico o un espacio para hacer ejercicio, normalmente son, las que están siendo procesadas. Además, las personas divorciadas están más relacionadas con terminar sus estudios.\n\n#### Ejes 2-3\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acm_ventil, axes=c(2,3), repel = TRUE, col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),ggtheme=theme_minimal())\n```\n\nEste plano nos muestra algunas relaciones en las variables de la vida intracarcelaria, por ejemplo, compartir celda con máximo 2 personas y no contar con una ducha dentro de la celda. También, compartir celda con más de 10 personas y estár en una carcel mixta.\n\n#### Ejes 1-3\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acm_ventil, axes=c(1,3), repel = TRUE,col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"), ggtheme=theme_minimal())\n```\n\nAdemás de mostrar otras relaciones previamente mencionadas, muestra una posible relación entre parar los estudios por embarazo y no contar con servicio médico en la celda. Sin embargo, los valores de $cos^2$ de estas categorías no es muy alto, por lo que no se puede dar una validez total de esta relación\n\n#### Ejes 2-5\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acm_ventil, axes=c(2,5), repel = TRUE, col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),ggtheme=theme_minimal())\n```\n\nEste plano nos muestra una posible relación entre la orientación sexual \"bisexual\" y \"homosexual\" con las cárceles femeninas.\n:::\n\nEn general, pudieron observarse con más detalle relaciones que pueden dar una mejor explicación de los individuos y las variables en la población. Sin embargo, se deb tener en cuenta que la varianza captada por cada uno de estos ejes es menor del 5%, por lo que no se puede dar una total validez de las relaciones aqui mostradas.\n\n### Contribución de cada variable\n\n::: panel-tabset\n#### Ejes 1-2\n\n```{r}\n#| label: contribucion-correlacion-ventil\n#| echo: false\n#| warning: false\n#| output: true\n\n# Crear el gráfico ggplot\ngg <- ggplot(data = acm_ventil$var$eta2, aes(x = !!sym(\"Dim 1\"), y = !!sym(\"Dim 2\"), label = rownames(acm$var$eta2), text = rownames(acm_ventil$var$eta2))) +\n  geom_point(size=0.75, shape=75, colour=\"blue3\") +  # Añadir los puntos\n  geom_text_repel(aes(label = rownames(acm_ventil$var$eta2)), size = 3) +  # Añadir las etiquetas\n  theme_minimal() +  # Aplicar un tema minimalista\n  labs(title = \"MCA Ventil- Correlación de variables\", \n       x = \"Dim 1\", y = \"Dim 2\") +  # Añadir títulos y etiquetas\n  scale_x_continuous(expand = c(0, 0), limits = c(-0.1, 1), breaks = seq(-0.1, 1, by = 0.1)) +  # Ajustar los límites del eje x\n  scale_y_continuous(expand = c(0, 0), limits = c(-0.1, 1), breaks = seq(-0.1, 1, by = 0.1)) +  # Ajustar los límites del eje y\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"gray50\") +  # Añadir línea horizontal en y = 0\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\")    # Añadir línea vertical en x = 0\n\n# Convertir el gráfico ggplot a plotly y mostrar el nombre de la variable al pasar el mouse\nggplotly(gg, tooltip = \"text\")\n\n```\n\nPuede observarse que este plano está compuesto de la misma forma que en el ACM anterior.\n\n#### Ejes 2-3\n\n```{r}\n#| label: contribucion-correlacion2-ventil\n#| echo: false\n#| warning: false\n#| output: true\n\n# Crear el gráfico ggplot\ngg <- ggplot(data = acm_ventil$var$eta2, aes(x = !!sym(\"Dim 2\"), y = !!sym(\"Dim 3\"), label = rownames(acm_ventil$var$eta2), text = rownames(acm_ventil$var$eta2))) +\n  geom_point(size=0.75,shape=75,colour=\"blue3\") +  # Añadir los puntos\n  geom_text_repel(aes(label = rownames(acm_ventil$var$eta2)), size = 3) +  # Añadir las etiquetas\n  theme_minimal() +  # Aplicar un tema minimalista\n  labs(title = \"MCA Ventil - Correlación de variables\", \n       x = \"Dim 2\", y = \"Dim 3\")+  # Añadir títulos y etiquetas\nscale_x_continuous(expand = c(0, 0), limits = c(-0.1, 1), breaks = seq(-0.1, 1, by = 0.1)) +  # Ajustar los límites del eje x\n  scale_y_continuous(expand = c(0, 0), limits = c(-0.1, 1), breaks = seq(-0.1, 1, by = 0.1)) +  # Ajustar los límites del eje y\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"gray50\") +  # Añadir línea horizontal en y = 0\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\")    # Añadir línea vertical en x = 0\n\n# Convertir el gráfico ggplot a plotly y mostrar el nombre de la variable al pasar el mouse\nggplotly(gg, tooltip = \"text\")\n\n```\n\nEn este gráfico vemos las variables de tiempo en la carcel, ya sea procesado o condenado, y el nivel de escolaridad tuvieron contribuciones en la construcción de los 2 ejes.\n\n#### Ejes 4-5\n\n```{r}\n#| label: contribucion-correlacion3_ventil\n#| echo: false\n#| warning: false\n#| output: true\ngg <- ggplot(data = acm_ventil$var$eta2, aes(x = !!sym(\"Dim 4\"), y = !!sym(\"Dim 5\"), label = rownames(acm_ventil$var$eta2), text = rownames(acm_ventil$var$eta2))) +\n  geom_point(size=0.75,shape=75,colour=\"blue3\") +  # Añadir los puntos\n  geom_text_repel(aes(label = rownames(acm_ventil$var$eta2)), size = 3) +  # Añadir las etiquetas\n  theme_minimal() +  # Aplicar un tema minimalista\n  labs(title = \"MCA Ventil - Correlación de variables\", \n       x = \"Dim 4\", y = \"Dim 5\")+  # Añadir títulos y\n# Convertir el gráfico ggplot a plotly y mostrar el nombre de la variable al pasar el mouse\n  scale_x_continuous(expand = c(0, 0), limits = c(-0.1, 1), breaks = seq(-0.1, 1, by = 0.1)) +  # Ajustar los límites del eje x\n  scale_y_continuous(expand = c(0, 0), limits = c(-0.1, 1), breaks = seq(-0.1, 1, by = 0.1)) +  # Ajustar los límites del eje y\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"gray50\") +  # Añadir línea horizontal en y = 0\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\")    # Añadir línea vertical en x = 0\n\nggplotly(gg, tooltip = \"text\")\n\n```\n\nPuede observarse que la 4 dimensión fue obtenida a partir de variables relacionadas a la vida intracarcelaria y el 5 eje fue construido principalmente por variables sociodemográficas.\n:::\n\n# ACM por grupos de variables\n\nComo se observó en el análisis descriptivo bivariado, en el análisis de correspondencias simples y en los resultados de los análisis de correspondencias múltiples anteriores, las relaciones entre las variables cualitativas se encuentran principalmente en aquellas que están conceptualmente vinculadas, como las condiciones de vida dentro de la celda o las variables sociodemográficas.\n\nEsto es coherente desde un punto de vista lógico y conceptual, pues desde el diseño del cuestionario, se sugería la existencia de estas relaciones desde su estructura, la cual dividía y ordenaba las preguntas del formulario en 11 temáticas. \n\nPor lo tanto, para mejorar la visualización e interpretación de los resultados, decidimos agrupar las variables basándonos en su significado conceptual y en las relaciones identificadas en los análisis descriptivos y factoriales previos. Además, para evitar la inflación de la inercia por las categorías de baja frecuencia, realizaremos el análisis descartando las categorías que representan menos del 1% de la población.\n\n## Variables Sociodemográficas\n\nLas variables sociodemográficas consideradas para la realización del ACM fueron:\n\n-   Sexo\n-   Edad\n-   Estado Civil\n-   Orientación Sexual\n-   Nivel de Escolaridad\n-   Motivo por el cual paró sus estudios\n-   Vivió con madre durante la adolescencia\n-   Vivió con padre durante la adolescencia\n-   Consideró el suicidio dentro del centro penitenciario\n-   Edad en la que consumió X sustancia psicoactiva por primera vez.\n-   Tiene hijos.\n\nEn este caso, la variable edad fue incluida como una variable cualitativa suplementaria, y la mayoría de sustancias (a excepción de alcohol, tabaco y marihuana) fueron incluidas como variables cualitativas suplementarias. Esto dado que, se intuye que existe una alta relación entre el consumo de estas sustancias y no se quiere opacar los otros resultados del ACM con estas relaciones.\n\n```{r}\n#| label: ACM Sociodemográficas\n#| message: false\n#| echo: false\n#| output: false\n\n\nVar_cuali_sociodemo<-c(\n  \"SEXO\",\n\"EDAD\",\n#\"NACION\",\n\"EST_CIVIL\", \n\"VIVE_CON\",\n\"HIJOS\",\n\"NIVEL_ESCOLARIDAD\",\n\"PARO_ESTUDIOS\",\n#\"IDENTI_GENERO\", \n\"ORIENT_SEXUAL\",\n\"CATEGORIAS_EDAD_CONSUMO_TABACO\",\n\"CATEGORIAS_EDAD_CONSUMO_ALCOHOL\",\n\"CATEGORIAS_EDAD_CONSUMO_MARIHUANA\" ,\n\"CATEGORIAS_EDAD_CONSUMO_INHALABLES\",\n\"CATEGORIAS_EDAD_CONSUMO_LSD\",\n\"CATEGORIAS_EDAD_CONSUMO_HONGOS\",\n\"CATEGORIAS_EDAD_CONSUMO_COCAINA\",\n\"CATEGORIAS_EDAD_CONSUMO_CRACK\",\n\"CATEGORIAS_EDAD_CONSUMO_HEROINA\",\n\"CATEGORIAS_EDAD_CONSUMO_CHOCHOS\",\n\"CATEGORIAS_EDAD_CONSUMO_TRANQUILIZANTES\",\n\"CATEGORIAS_EDAD_CONSUMO_ANFETAMINAS\",\n\"COLOR_PIEL\",\n\"VIVIO_MADRE_ADOLESCENCIA\", \n\"VIVIO_PADRE_ADOLESCENCIA\",\n\"CONSIDERO_SUICIDIO\" ,\n \"DISC_VISUAL\",\n\"DISC_AUDITIVA\",\n\"DISC_MOTRIZ\"\n)\n\nDatosCualiSoc<-Tabla1[,Var_cuali_sociodemo]\nacmSoc <- MCA(DatosCualiSoc, graph=FALSE,level.ventil = 0.01,ncp=7,quali.sup = c(13:21),quanti.sup = 2)\n```\n\n### Análisis de las variables\n::: panel-tabset\n\n#### Ejes 1-2\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acmSoc,col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"), \n             axes=c(1,2), repel = TRUE,  ggtheme=theme_minimal(),quali.col = \"black\")\n\n#fviz_mca_var(acmSoc,col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"), axes=c(4,5), repel = TRUE,label=\"none\",  ggtheme=theme_minimal())\n\n\n```\n\nDe forma inicial, puede observarse la relación entre el consumo de sustancias psicoactivas en diferentes edades; resaltando que las categorías más próximas tienden a ser aquellas que corresponden a intervalos de edad más cercanos, opr ejemplo, la edad de inicio de consumo de tabaco ser entre los 4 y 12 años, y la edad de inicio de consumo de cocaína ser entre los 4 y 15 años.\n\nAdemás, puede observarse que el consumo de estas sustancias en edades entre los 14 y 17 años, está relacionada con no continuar los estudios por motivos de ocio o haber sido expulsado de la escuela.\n\nTambién, se observa que las categorías sobre el consumo de estas sustancias despues de los 18 años, y las categorías de \"nunca han consumido\" están más relacionadas con las mujeres. Junto a estas variables, también se encuentra una relación entre estar divorciada/viuda, tener hijois y ser mujer.\n\nFinalmente, puede observarse la alta relación entre el nivel educativo y parar estudios. Relación que ya fue vista en los anteriores ACM. \n\n#### Ejes 1-3\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acmSoc,col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"), \n             axes=c(1,3), repel = TRUE,  ggtheme=theme_minimal(),quali.col = \"black\")\n\n#fviz_mca_var(acmSoc,col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"), axes=c(4,5), repel = TRUE,label=\"none\",  ggtheme=theme_minimal())\n\n\n```\n\nEste plano, además de mostrar algunas relaciones mencionadas previamente, muestra la existencia de una relación entre ser mujer y parar los estudios debido a un embarazo, y también, ser mujer y ser homosexual.\n\n\ntambién nos muestra que las poseer alguna discapacidad auditiva o motriz, está relacionada a no haber estudiado. Sin embargo, la calidad de representación de estas categorías no es alta, por lo que este resultado puede ser invalido. \n\n\n#### Ejes 3-4\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acmSoc,col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"), \n             axes=c(4,3), repel = TRUE,  ggtheme=theme_minimal(),quali.col = \"black\")\n\n#fviz_mca_var(acmSoc,col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"), axes=c(4,5), repel = TRUE,label=\"none\",  ggtheme=theme_minimal())\n\n\n```\n\nEste eje nos muestra la relación entre vivir con los padres y ser soltero, vivir con la pareja sentimental y ser casado y, ser hombre, tener hijos y vivir con la pareja en unión libre.\n:::\n\nCabe resaltar que en los gráficos anteriores es posible encontrar muchas más relaciones entre las variables, sin embargo, solo fueron mencionadas aquellas que presentaron un valor alto en los $cos^2$, es decir, aquellas que se encontraban representadas por el plano que se estaba considerando. Esto, para evitar mencionar relaciones que puedan ser inválidas. Siendo así, es posible que incluso algunas de las relaciones mencionadas sean significativas.\n\n### Contribuciónes de los ejes\n::: panel-tabset\n\n#### Valores propios\n\n```{r}\n#| echo: false\nscreeplot <- fviz_screeplot(acmSoc, addlabels = TRUE, ylim = c(0, 20)) +  ggtitle(\"Scree Plot\") + theme_minimal()+ylab(\"Porcentaje de varianza explicada\")+xlab(\"Ejes\")\n## Usando modif.rate() del paquete GDAtools:\n# ptau <- modif.rate(acm)$modif[, 1]\n## Haciendo las cuentas uno mismo:\ns <- ncol(DatosCualiSoc)\nl <- acmSoc$eig[acmSoc$eig[,1] > 1/s, 1]\ntau <- ( s / (s - 1) )^2 * ( l - (1/s) )^2\nptau <- tau / sum( tau ) * 100\n\n# Creamos un data frame para usar con ggplot2\nbarplot_df <- data.frame(Indice = factor(1:length(ptau)), Valor = ptau)\n\n# Creamos el gráfico de barras con ggplot2\nbarplot_gg <- ggplot(barplot_df, aes(x = Indice, y = Valor)) +\n  geom_bar(stat = \"identity\", fill = \"darkred\") +\n  ylim(0, max(barplot_df$Valor+10)) +\n  labs(x = \"Ejes\", y = expression(tau(lambda))) +\n  theme_minimal() +\n  ggtitle(\"Criterio de Benzécri\")\n\ngrid.arrange(screeplot, barplot_gg, ncol = 1)\n```\n\nDe forma detallada, los primeros 5 valores de la inercia ajustada según el criterio de Benzécri son\n\n```{r}\n#| label: Tabla-benzecrisoc\n#| echo: false\n#| warning: false\n#| output: true\n\nkable(barplot_df[1:5,])\n```\n\n#### Contribución 1er eje\n\n```{r}\n#| label: contribacm1Socio\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acmSoc, choice = \"var\", axes = 1) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nEste eje está compuesto principalmente por las categorías de consumo de sustancias psicoactivas antes de los 14 años.\n\n#### Contribución 2do eje\n\n```{r}\n#| label: contribacm2 Socio\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acmSoc, choice = \"var\", axes = 2) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\nEste eje fue construido debido a la alta correlación entre el motivo de parar estudios y el nivel educativo. Por lo que sus resultados no son destacables.\n\n\n#### Contribución 3er eje\n\n```{r}\n#| label: contribacm3 Socio\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acmSoc, choice = \"var\", axes = 3) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nMismo caso que el eje anterior, sin embargo, este eje muestra una pequeña relación entre las categorías de ser mujer y tener hijos.\n\n#### Contribución 4to eje\n\n```{r}\n#| label: contribacm4 Socio\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acmSoc, choice = \"var\", axes = 4) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\nEste eje está compuesto por categorías de las variables de estado civil, y la composición del hogar. \n\n:::\n\nUna vez vista la inercia de cada uno de los ejes, y las categorías que contribuyeron a la construcción de cada uno de estos. Se consideraron los primeros 4 ejes del ACM, dado que, según el criterio de Benzécri, estos contienen alrededor del 52% de la inercia de los datos. Además de presentar diferentes relaciones entre sus variables, las cuales ya fueron mencionadas previamente.\n\n## Variables económicas\n\nLas variables económicas consideradas para la realización de este ACM son:\n\n- Excluyendo a la persona, quien sería la cabeza del hogar en el lugar donde vive. (si la persona vive sola, se tiene la categoría \"vive solo/a\")\n- Alguna vez ha trabajado, ya sea una actividad legal o ilegal.\n- Tenian suficiente comida todos los días (En el último año antes de la detención)\n- Tenían alguna deuda (En el último año antes de la detención)\n- Cuanto fue el salario total del último mes antes de la detención\n\n\n```{r}\n#| label: ACM Economicas\n#| message: false\n#| echo: false\n#| output: false\n\n\nVar_cuali_eco<-c(\"VIVE_CON\",\n                 \"TRABAJO\",\n                 \"PODIA_COMER\",\n                 \"DEUDA\",\n                 \"SALARIO_MES_ANTERIOR\")\n\nDatosCualieco<-Tabla1[,Var_cuali_eco]\nacmEco <- MCA(DatosCualieco, graph=FALSE,level.ventil = 0.01)\n```\n\n### Análisis de las variables\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acmEco, axes=c(1,2), repel = TRUE,  ggtheme=theme_minimal(),col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"))\n\n\n```\n\nEn este plano, puede observarse como cada categoría del salario, se relaciona con algunas condiciones económicas de la persona. \n\nPuede verse que, la categoría del salario más bajo es la más próxima a la categoría correspondiente a no poder comer todos los días;la categoría de \"no recibia ingresos\" está relacionada con nunca haber trabajado.\n\nTambién, puede verse que las categorías de *PODIA_COMER.SI*, *DEUDA_NO*, vivir solo o con su pareja sentimental y *SALARIO_MES.3* (entre 5501 y 7500 pesos mexicanos) tienen una estrecha relación. También estas categorías están relacionadas con las categorías correspondientes a salarios mas altos, pero con menos intensidad. \n\nFinalmente, las personas cuya cabeza del hogar era una persona diferente a ellos mismos o sus parejas, poseían menos ingresos mensuales antes de su detención.\n\nSe resalta que la dimensión 1, presenta de forma **ordenada de forma decreciente** las categorías de la variable SALARIO_ULTIMO_MES. Y que las demás variables de este componente, se encuentran alineadas a este eje.\n\n### Contribuciones de los ejes\n\n::: panel-tabset\n#### Valores propios\n\n```{r}\n#| echo: false\nscreeplot <- fviz_screeplot(acmEco, addlabels = TRUE, ylim = c(0, 20)) +  ggtitle(\"Scree Plot\") + theme_minimal()+ylab(\"Porcentaje de varianza explicada\")+xlab(\"Ejes\")\n## Usando modif.rate() del paquete GDAtools:\n# ptau <- modif.rate(acm)$modif[, 1]\n## Haciendo las cuentas uno mismo:\ns <- ncol(DatosCualieco)\nl <- acmEco$eig[acmEco$eig[,1] > 1/s, 1]\ntau <- ( s / (s - 1) )^2 * ( l - (1/s) )^2\nptau <- tau / sum( tau ) * 100\n\n# Creamos un data frame para usar con ggplot2\nbarplot_df <- data.frame(Indice = factor(1:length(ptau)), Valor = ptau)\n\n# Creamos el gráfico de barras con ggplot2\nbarplot_gg <- ggplot(barplot_df, aes(x = Indice, y = Valor)) +\n  geom_bar(stat = \"identity\", fill = \"darkred\") +\n  ylim(0, max(barplot_df$Valor+10)) +\n  labs(x = \"Ejes\", y = expression(tau(lambda))) +\n  theme_minimal() +\n  ggtitle(\"Criterio de Benzécri\")\n\ngrid.arrange(screeplot, barplot_gg, ncol = 1)\n```\n\n#### Contribución 1er eje\n\n```{r}\n#| label: contribacm1Eco\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acmEco, choice = \"var\", axes = 1) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\n\n#### Contribución 2do eje\n\n```{r}\n#| label: contribacm2 Eco\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acmEco, choice = \"var\", axes = 2) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\n:::\n\nDada las inercias observadas, consideramos únicamente los 2 primeros ejes de este ACM.\n\nAl observar la contribución de cada una de las categorías a la construcción de los ejes, puede verse que los ejes se encuentran compuestos por las categorías ligadas a una situación económica desfavorable. Por ejemplo, no tener trabajo o bajos ingresos , tener deudas y no tener suficiente comida.\n\n## Variables delictivas\n\nLas variables delictivas consideradas en el ACM fueron:\n\n- El individuo ya habia sido sentenciado antes en un centro de reclusión.\n- Motivo de detención de la persona\n- Tiempo que hubo entre el delito y la detención de la persona.\n- La policia o autoridad que lo detuvo le propuso algun tipo de soborno a cambio de dejarlo ir, no lastimarlo, no hacer daño a la familia...etc.\n- Motivo por el cual la persona se declaró culpable (en caso de haberlo hecho)\n- Durante el juicio de la persona, las autoridades le pidieron un soborno a cambio de dejarlo ir o alterar los hechos para beneficiarlo.\n- Tiempo que la persona ha estado en proceso o fue condenada.\n- Cantidad de delitos abiertos (cualitativa suplementaria)\n\n\n```{r}\n#| label: ACM Delictivas\n#| message: false\n#| echo: false\n#| output: false\n\n\nVar_cuali_deli<-c(\n  \"SENTENCIADO_ANTES\",\n  \"MOTIVO_DETENCION\" ,\n  \"TIEMPO_DEL_DET\",\n \"INTENTO_SOBORNO\",\n \"DECLARACION_CULPABLE\",\n \"INTENTO_SOBORNO_JUICIO\",\n \"CATEGORIAS_TIEMPO_RECLUIDO\",\n \"CATEGORIAS_TIEMPO_PROCESO\",\n \"DELITOS_ABIERTOS\"\n)\n\nDatosCualiDeli<-Tabla1[,Var_cuali_deli]\nacmDeli <- MCA(DatosCualiDeli, graph=FALSE,level.ventil = 0.01,quanti.sup = 9)\n```\n\n### Análisis de las variables\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acmDeli, axes=c(1,2), repel = TRUE,  ggtheme=theme_minimal(),col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"))\n\n```\nEl plano factorial nos muestra la relación entre los tiempos de una persona recluida y procesada, tal como se vió anteriormente, estos son totalmente opuestos. \n\nAsí, se ve la relación entre las personas que se declararon culpables porque \"reconocieron los hechos\" o \"el abogado se los recomendo\" y un tiempo de condena entre 1 a 6.5 años.\n\nTambién, puede ver que los mayores tiempo de condena están relacionados con las personas que se declararon culpables porque fueron agredidas o amenazadas, y que también manifestaron que las autoridades pidieron un soborno durante el proceso de detención y juicio. Sin embargo, estas relaciones pueden ser no significativas dada la baja calidad de representación de estas categorías en el plano.\n\n### Contribuciones de los ejes\n::: panel-tabset\n#### Valores propios\n\n```{r}\n#| echo: false\nscreeplot <- fviz_screeplot(acmDeli, addlabels = TRUE, ylim = c(0, 20)) +  ggtitle(\"Scree Plot\") + theme_minimal()+ylab(\"Porcentaje de varianza explicada\")+xlab(\"Ejes\")\n## Usando modif.rate() del paquete GDAtools:\n# ptau <- modif.rate(acm)$modif[, 1]\n## Haciendo las cuentas uno mismo:\ns <- ncol(DatosCualiDeli)\nl <- acmDeli$eig[acmDeli$eig[,1] > 1/s, 1]\ntau <- ( s / (s - 1) )^2 * ( l - (1/s) )^2\nptau <- tau / sum( tau ) * 100\n\n# Creamos un data frame para usar con ggplot2\nbarplot_df <- data.frame(Indice = factor(1:length(ptau)), Valor = ptau)\n\n# Creamos el gráfico de barras con ggplot2\nbarplot_gg <- ggplot(barplot_df, aes(x = Indice, y = Valor)) +\n  geom_bar(stat = \"identity\", fill = \"darkred\") +\n  ylim(0, max(barplot_df$Valor+10)) +\n  labs(x = \"Ejes\", y = expression(tau(lambda))) +\n  theme_minimal() +\n  ggtitle(\"Criterio de Benzécri\")\n\ngrid.arrange(screeplot, barplot_gg, ncol = 1)\n```\n\nDe forma detallada, los primeros 3 valores de la inercia ajustada según el criterio de Benzécri son\n\n```{r}\n#| label: Tabla-benzecrideli\n#| echo: false\n#| warning: false\n#| output: true\n\nkable(barplot_df[1:3,])\n```\n\n#### Contribución 1er eje\n\n```{r}\n#| label: contribacm1SDeli\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acmDeli, choice = \"var\", axes = 1) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nComo es de esperarse, este eje refleja la relación más evidente de este ACM, la cual es el tiempo que la persona ha sido procesada y condenada, pues estos 2 estados son opuestos desde un punto de vista conceptual. \n\n#### Contribución 2do eje\n\n```{r}\n#| label: contribacm2 deli\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acmDeli, choice = \"var\", axes = 2) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nEste eje está compuesto por las categorías de INTERNO_SOBORNO_JUICIO.1 y el mayor tiempo de condena. Teniendo también influencia de los motivos por los cuales la persona se declaró culpable. \n:::\n\nPor lo visto en los anteriores gráficos, se consideraron únicamente los 2 primeros ejes, los cuales contienen un 80% de la inercia de los datos.\n\n## Vida Intracarcelaria\n\nLas variables consideradas en el componente de vida intracarcelaria son las siguientes:\n\n- Sexo de la persona\n- Orientación sexual de la persona\n- Acceso a ventanas en la celda\n- Acceso a agua potable en la celda\n- Acesso a un sistema de drenaje en la celda\n- Acceso a luz electrica en la celda\n- Acceso a una ducha en la celda\n- Acceso a un sanitario en la celda\n- Acceso a servicio médico dentro de la celda\n- Acceso a alimentos gratuitos en la celda\n- Acceso a espacios de ejercicio en la carcel\n- Acceso a espacios y/o material de lectura en la carcel\n- Facilidad de ejercer la religión dentro de la carcel\n- Puede realizar llamadas dentro de la carcel\n- Puede continuar con sus estudios dentro de la carcel\n- Puede recibir visitas dentro de la carcel\n- Sensación de seguridad en la celda\n- Sensación de seguridad en la carcel\n- Tipo de carcel\n- Cantidad de personas en la celda\n\n```{r}\n#| label: ACM Intra carcelaria\n#| message: false\n#| echo: false\n#| output: false\n\n\nVar_cuali_intra<-c(\n \"CAR_PERSONAS_CELDA\",\n \"CELDA_VENTANAS\",\n \"CELDA_AGUA_POTABLE\" ,\n \"CELDA_DRENAJE\",\n \"CELDA_LUZ\",\n \"CELDA_DUCHA\" ,\n \"CELDA_SANITARIO\" ,\n \"CELDA_SERVICIO_MEDICO\",\n \"CELDA_ALIMENTOS\",\n \"CARCEL_EJERCICIO\",\n \"CARCEL_LECTURA\" ,\n \"CARCEL_RELIGION\" ,\n \"CARCEL_LLAMADAS\" ,\n \"CARCEL_ESTUDIO\" ,\n \"CARCEL_VISITA\" ,\n \"CELDA_SEGURIDAD\" ,\n \"CARCEL_SEGURIDAD\",\n \"TIPO_CARCEL\",\n \"TIEMPO_CARCEL\",\n \"ORIENT_SEXUAL\",\n \"SEXO\"\n)\n\nDatosCualiIntra<-Tabla1[,Var_cuali_intra]\nacmIntra <- MCA(DatosCualiIntra, graph=FALSE,level.ventil = 0.01)\n```\n\n### Análisis de las variables \n\n::: panel-tabset\n\n#### Eje 1-2\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acmIntra, axes=c(1,2), repel = TRUE,  ggtheme=theme_minimal(),col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"))\n\n```\nEn este eje, puede observarse claramente la alta relación que hay en no contar con un sistema de drenaje en la celda, y no contar con un sanitario dentro de esta. también, la relación entre el acceso a una ducha y el agua potable. \n\nAdemás, como fue mencionado en el primer ACM, se ve una relación entre ser mujer y tener como orientación sexual la bisexualidad o la homosexualidad.  Junto a esto, se tiene una relación lógica, no tan marcada pero presente, entre ser mujer y el tipo de carcel \"femenina\". \n\nPor otro lado, la segunda componente nos muestra una relación entre no poder practicar religión, actividad física, actividades de lectura, realizar llamadas, sentirse seguro en la celda y un alto número de personas en la celda.\n\n#### Eje 2-3 \n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acmIntra, axes=c(2,3), repel = TRUE,  ggtheme=theme_minimal(),col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"))\n\n```\n\nEste eje, además de mostrar con mayor claridad la relación entre no contar con diversos servicios en la celda y el alto número de personas en esta. También nos muestra una relación entre ser mujer y llevar menos de 6 meses en la carcel.\n\nEl eje 2, también nos muestra la relación positiva entre contar con diversos servicios en la celda, como material de lectura, espacios para hacer ejercicio, máximo 6 personas en la celda, y tener espacios para estudiar, con la sensación de seguridad en la carcel.\n\n:::\n\n### Contribución de los ejes\n\n::: panel-tabset\n#### Valores propios\n\n```{r}\n#| echo: false\nscreeplot <- fviz_screeplot(acmIntra, addlabels = TRUE, ylim = c(0, 20)) +  ggtitle(\"Scree Plot\") + theme_minimal()+ylab(\"Porcentaje de varianza explicada\")+xlab(\"Ejes\")\n## Usando modif.rate() del paquete GDAtools:\n# ptau <- modif.rate(acm)$modif[, 1]\n## Haciendo las cuentas uno mismo:\ns <- ncol(DatosCualiIntra)\nl <- acmIntra$eig[acmIntra$eig[,1] > 1/s, 1]\ntau <- ( s / (s - 1) )^2 * ( l - (1/s) )^2\nptau <- tau / sum( tau ) * 100\n\n# Creamos un data frame para usar con ggplot2\nbarplot_df <- data.frame(Indice = factor(1:length(ptau)), Valor = ptau)\n\n# Creamos el gráfico de barras con ggplot2\nbarplot_gg <- ggplot(barplot_df, aes(x = Indice, y = Valor)) +\n  geom_bar(stat = \"identity\", fill = \"darkred\") +\n  ylim(0, max(barplot_df$Valor+10)) +\n  labs(x = \"Ejes\", y = expression(tau(lambda))) +\n  theme_minimal() +\n  ggtitle(\"Criterio de Benzécri\")\n\ngrid.arrange(screeplot, barplot_gg, ncol = 1)\n```\nDe forma detallada, los primeros 4 valores de la inercia ajustada según el criterio de Benzécri son\n\n```{r}\n#| label: Tabla-benzecriintra\n#| echo: false\n#| warning: false\n#| output: true\n\nkable(barplot_df[1:5,])\n```\n#### Contribución 1er eje\n\n```{r}\n#| label: contribacm1 Intra\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acmIntra, choice = \"var\", axes = 1) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nEste eje está compuesto principalmente por la falta de acceso a servicios en la celda. \n\n\n#### Contribución 2do eje\n\n```{r}\n#| label: contribacm2 Intra\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acmIntra, choice = \"var\", axes = 2) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nDe forma similar al primer eje, esta variable está compuesta por la sensación de inseguridad en el centro penitenciario.\n\n#### Contribución 3er eje\n\n```{r}\n#| label: contribacm3 Intra\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acmIntra, choice = \"var\", axes = 3) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nEste eje está caracterizado por las variables de SEXO y del tipo de carcel. \n:::\n\nAsí, a partir de los visto en los gráficos anteriores, se consideraron los 3 primeros ejes del ACM, pues estos acumulan el 90% de la inercia según el criterio de Benzécri.\n\n## Expectativas de Salida\n\nFinalmente, el último componente en los cuales pueden agruparse conceptualmente las variables consideradas en este estudio es el de Expectativas de Salida. \n\nPara este caso, las variables usadas en el ACM fueron:\n\n- Considera que podrá encontrar vivienda una vez salga de la carcel.\n- Considera que podrá encontrar empleo una vez salga de la carcel\n- Considera que podrá continuar sus estudios una vez salga de la carcel.\n- Considera que podrá reintegrarse con sus amigos una vez salga de la carcel\n- Considera que podrá reintegrarse con su familia una vez salga de la carcel\n- Considera que podrá reincorporarse a la sociedad una vez salga de la carcel\n\nAdicionalmente, se incluyó la variable cualitativa \"CONSIDERO_SUICIDIO\" ya que, además de poseer una relación conceptual con las variables de expectativa de salida, fue visto en el análisis descriptivo que estas variable posee una relación en la tabla de perfiles con estas variables.\n\n```{r}\n#| label: ACM Expectativas\n#| message: false\n#| echo: false\n#| output: false\n\n\nVar_cuali_sali<-c(\n\"SALIDA_VIVIENDA\",\n \"SALIDA_EMPLEO\",\n \"SALIDA_ESTUDIO\",\n \"SALIDA_AMIGOS\",\n \"SALIDA_FAMILIA\",\n \"SALIDA_REINCORPORACION\",\n \"CONSIDERO_SUICIDIO\" \n)\n\nDatosCualisali<-Tabla1[,Var_cuali_sali]\nacmSali <- MCA(DatosCualisali, graph=FALSE,level.ventil = 0.02)\n```\n\n### Análisis de variables\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\n#fviz_mca_var_interactive(acmSali, axes=c(2,4), repel = TRUE,  ggtheme=theme_minimal())\n\nfviz_mca_var_interactive(acmSali, axes=c(1,2), repel = TRUE,  ggtheme=theme_minimal(),col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"))\n\n\n```\n\nPuede observarse que la mayoría de categorías se encuentran bien representadas por el primer eje, además de mostrar relaciones marcadas entre estas. Por ejemplo, la esperanza de reintegrarse con amigos y familia, poder continuar sus estudios y el poder encontrar empleo.\n\n\n### Contribución de los ejes\n\n::: panel-tabset\n\n#### Valores propios\n\n```{r}\n#| echo: false\n\n\nscreeplot <- fviz_screeplot(acmSali, addlabels = TRUE, ylim = c(0, 30)) +  ggtitle(\"Scree Plot\") + theme_minimal()+ylab(\"Porcentaje de varianza explicada\")+xlab(\"Ejes\")\n\n## Usando modif.rate() del paquete GDAtools:\n# ptau <- modif.rate(acm)$modif[, 1]\n## Haciendo las cuentas uno mismo:\ns <- ncol(DatosCualisali)\nl <- acmSali$eig[acmSali$eig[,1] > 1/s, 1]\ntau <- ( s / (s - 1) )^2 * ( l - (1/s) )^2\nptau <- tau / sum( tau ) * 100\n\n# Creamos un data frame para usar con ggplot2\nbarplot_df <- data.frame(Indice = factor(1:length(ptau)), Valor = ptau)\n\n# Creamos el gráfico de barras con ggplot2\nbarplot_gg <- ggplot(barplot_df, aes(x = Indice, y = Valor)) +\n  geom_bar(stat = \"identity\", fill = \"darkred\") +\n  ylim(0, max(barplot_df$Valor+10)) +\n  labs(x = \"Ejes\", y = expression(tau(lambda))) +\n  theme_minimal() +\n  ggtitle(\"Criterio de Benzécri\")\n\ngrid.arrange(screeplot, barplot_gg, ncol = 1)\n```\n\nDe forma detallada, los 3 valores de la inercia ajustada según el criterio de Benzécri son\n\n```{r}\n#| label: Tabla-benzecriSali\n#| echo: false\n#| warning: false\n#| output: true\n\nkable(barplot_df[1:3,])\n```\n\n\n#### Contribución 1er eje\n\n```{r}\n#| label: contribacm1Sali\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acmSali, choice = \"var\", axes = 1) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\nEste eje está determinado por las variables de reintregación con la familia, amigos, continuar estudios y obtener empleo. Tal como fue visto, en el plano factorial anterior. \n\n#### Contribución 2do eje\n\n```{r}\n#| label: contribacm2 Sali\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acmSali, choice = \"var\", axes = 2) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nEste eje está compuesto por las categorías \"No aplica\" de las variables de reintegración con familia y amigos. Cabe resaltar que en este caso, \"No aplica\" no simboliza datos faltantes, si no a que la persona no considera tener amigos o familia a los cuales reintegrarse.\n:::\n\nA partir del análisis anterior, consideramos unicamente el 1 eje, ya que este concentra alrededor del 95% de la inercia ajustada por el criterio de Benzécri. \n\n\n# Leves Conclusiones\n\nA partir de los Análisis de Correspondencias Múltiples realizados, puede verse que las variables consideradas poseen una amplia cantidad de relaciones interesantes. No solo se observaron las correlaciones esperadas entre algunas variables, sino que también se encontraron relaciones que nos dan características particulares de la población privada de la libertad encuestada. \n\nLa mayoría de estas relaciones se dan entre variables que presentan una conexión conceptual clara, dichas conexiones (y agrupaciones) pueden encontrase directamente en el cuestionario utilizado por el INEGI, ya que estas agrupaciones consisten en cada una de las secciones del formulario.\n\nEn cuanto a nuestro objetivo principal, se observó que las variables con mayor relación respecto al número de personas por celda son aquellas variables categóricas relacionadas con las condiciones de vida en la celda y centro penitenciario. Esto sugiere que las condiciones de hacinamiento están más vinculadas a las características propias del centro penitenciario que a atributos y características individuales de las personas.\n\nEste hecho será analizado en mayor profundidad en las siguientes secciones mediante la aplicación de técnicas de agrupamiento de variables.","srcMarkdownNoYaml":"\n\nDado que nuestro conjunto de datos presenta un alto número de variables cualitativas, es necesario considerar y analizar el efecto que estas pueden tener en las condiciones de vida de la población privada de la libertad. Siendo así, exploraremos las posibles relaciones que pueden existir entre estas variables mediante un Análisis de Correspondencias Múltiple.\n\nPara el desarrollo del análisis de correspondencias múltiples (ACM, o en inglés, *Multiple Correspondence Analysis, MCA*), haremos uso de los mismos paquetes utilizados para el análisis de correspondencias principales (ACP). Si bien puede ser redundante el uso de estos 4 paquetes en el mismo código, cada uno de estos ofrece funciones que nos ayudaran a dar una mejor representación gráfica de los resultados obtenidos por el ACM.\n\nAdemás, evitaremos la notación científica mediante el `options(scipen=999).`\n\n```{r}\n#| label: carga-librerias\n#| message: false\n#| echo: true\n#| output: false\n\n#Manejo de datos\nlibrary(tidyverse)\nlibrary(readr)\nlibrary(dplyr)\nlibrary(readxl)\n#Gráficos\nlibrary(ggplot2)\nlibrary(gridExtra)\nlibrary(plotly)\nlibrary(GGally)\n#ACP\nlibrary(ade4)\nlibrary(FactoClass)\nlibrary(FactoMineR)\nlibrary(factoextra)\n#Datos importados\nsource(\"DatosSeleccionados.R\")\n\n#Ajustes de tema del documento y graficos\nlibrary(scales)\nlibrary(DT)\nlibrary(gt)\nlibrary(RColorBrewer)\ntheme_set(theme_minimal(base_size = 24, base_family = \"Atkinson Hyperlegible\"))\nlibrary(hrbrthemes)\noptions(scipen=999) #Evitar notación científica\n```\n\nComo fue visto en el ACP. Las variables relacionadas a la edad en la cual consumieron alguna sustancia psicoactiva por primera vez presentaba una particularidad en sus valores. Pues varios individuos fueron notados con la edad de 99 para indicar que el individuo nunca ha consumido dicha sustancia.\n\nEstas respuestas, al ser tratadas como datos numéricos en un ACP, pueden distorsionar los resultados tales como:\n\n-   **Sesgo en la Varianza Explicada:** Los valores \"98\" y \"99\" pueden influir de manera significativa en la varianza explicada por los componentes principales, distorsionando la interpretación de los resultados. Estas respuestas no presentan variabilidad real en la población estudiada, sino falta de información, lo que afecta la estructura de correlaciones entre las variables.\n-   **Falsa Apariencia de Relaciones:** En el ACP, los valores numéricos asignados a respuestas de \"no sabe\" o \"no responde\" pueden crear artificialmente relaciones lineales entre variables que no existen realmente, sesgando los componentes principales y reduciendo la claridad de los resultados.\n\nPor lo tanto, es posible que los resultados que el ACP brindaban respecto a estas variables no sean correctos o válidos. Siendo así, se decidió transformar estas y otras variables cuantitativas en variables cualitativas mediante el proceso de discretización, el cual consiste en construir categorias a partir de intervalos; posteriormente, se consideró la inclusión de estas variables dentro del ACM.\n\n# ACM de nuestro objetivo\n\n```{r}\n#| label: Seleccion-variables\n#| echo: false\n#| warning: false\n#| output: false\n#http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/#r-packages\n#Escogemos las variables cuantitativas\nvarCualitativas<-c(\"TIPO_CARCEL\",\"EST_CIVIL\",\"NIVEL_ESCOLARIDAD\",\"PARO_ESTUDIOS\",\"ORIENT_SEXUAL\",\"DISC_MOTRIZ\",\"COLOR_PIEL\",\"CARCEL_LECTURA\",\"CARCEL_EJERCICIO\",\"CELDA_ALIMENTOS\",\"CELDA_SERVICIO_MEDICO\",\"CELDA_DUCHA\",\"DECLARACION_CULPABLE\",\"CATEGORIAS_TIEMPO_RECLUIDO\",\"CATEGORIAS_TIEMPO_PROCESO\",\"CAR_PERSONAS_CELDA\")\n\n\n#DatosCuantitativos<-Tabla1[,varCuantitativas]\nDatosCualitativos<-Tabla1[,varCualitativas]\n#correlaciones<-cor(DatosCuantitativos)\n```\n\nSeleccionamos las variables a incluir dentro de nuestro ACM. Siguiendo con nuestro objetivo principal de este estudio, fueron consideradas aquellas variables que mostraron una comportamiento de correlación entre sus categorias con la cantidad de personas en la celda (discretizada) mediante las tablas de perfiles vistas en el [análisis descriptivo bivariado](https://qglhmj-juan0pablo-montano0diaz.shinyapps.io/analisis_descriptivo_bivariado/) y el [análisis de correspondencias simple](https://qglhmj-juan0pablo-montano0diaz.shinyapps.io/CorrespondenciaSimples/).\n\n::: {style=\"display: flex;\"}\n::: {style=\"flex: 50%; padding-right: 10px;\"}\n<h4>**Variables consideradas en el ACM**</h4>\n\n<ul>\n\n<li>Tipo de Carcel</li>\n\n<li>Nivel de Escolaridad</li>\n\n<li>Motivo por el que dejó de estudiar</li>\n\n<li>Motivo por el que se declaró culpable</li>\n\n<li>Tiempo que lleva recluido (discretizada)</li>\n\n<li>Tiempo que lleva en proceso (discretizada)</li>\n\n<li>**Cantidad de personas en la celda (discretizada)**</li>\n\n</ul>\n:::\n\n::: {style=\"flex: 50%; padding-left: 10px;\"}\n<h4>\n\n</h4>\n\n<ul>\n\n<li>Estado Civil</li>\n\n<li>Orientación Sexual</li>\n\n<li>Discapacidad Motriz</li>\n\n<li>Color de Piel</li>\n\n<li>Puede leer en la carcel</li>\n\n<li>Puede hacer ejercicio en la carcel</li>\n\n<li>Cuenta con alimentos en la celda</li>\n\n<li>Servicio médico en la celda</li>\n\n<li>Cuenta con una ducha en la celda</li>\n\n</ul>\n:::\n:::\n\nCon estas variables, tenemos la siguiente tabla disyuntiva completa (TDC). Con la cual construiremos nuestro ACM.\n\n```{r}\n#| label: Tabla-disyuntiva-completa1\n#| echo: false\n#| warning: false\n#| output: false\nDatosCualitativos <- data.frame(lapply(DatosCualitativos, as.factor))\n\nZ <- acm.disjonctif(DatosCualitativos) # función de ade4\n```\n\n```{r}\n#| label: Tabla-disyuntiva-completa-visualizacion\n#| echo: false\n#| warning: false\n#| output: true\n\nZ |> head(n=50) |>\n  datatable(\n    options = list(dom = 'ftp', paging = TRUE)\n    )\n```\n\nComo se observó en el análisis descriptivo univariado, algunas de las variables cualitativas presentan categorías de baja frecuencia, lo que puede afectar los valores de inercia, distorsionar la geometría del plano factorial, generar ruido en los resultados y, en consecuencia, dificultar la interpretación de nuestro ACM. Por esta razón, realizaremos dos análisis: el primero incluirá todas las categorías, incluidas las de baja frecuencia; el segundo considerará únicamente aquellas categorías que representen más del 1% de la población en cada variable.\n\nPara realizar esto último, se utilizará la técnica de \"ventilación\" en las categorias de baja frecuencia. Esta técnica trata de evitar que las categorías de baja frecuencia tengan una influencia desproporcionada en el ACM. Para esto, redistribuye estas categorías poco frecuentes entre las otras categorías, de manera que no generen distorsiones en el análisis.\n\n```{r}\n#| label: funcion-interactive\n#| echo: false\n#| warning: false\n#| output: false\n#Z <- as.matrix(Z)\n#(B <- t(Z) %*% Z)\n\n\nfviz_mca_var_interactive <- function(acm, axes = c(1, 2), repel = TRUE, ggtheme = theme_minimal(), col.var = \"cos2\", gradient.cols = NULL,quali.col=\"green\") {\n  \n  # Calcula la varianza explicada para los ejes seleccionados\n  eigenvalues <- acm$eig\n  var_explained_x <- round(eigenvalues[axes[1], 2], 2)\n  var_explained_y <- round(eigenvalues[axes[2], 2], 2)\n  \n  # Extrae las coordenadas y nombres de las variables activas\n  var_data <- acm$var$coord\n  var_data_df <- data.frame(var_data)\n  var_data_df$Variable <- rownames(var_data_df)\n  var_data_df$Type <- \"Activa\"  # Marcamos las variables activas\n  \n  # Detecta automáticamente las variables cualitativas suplementarias y las añade\n  if (!is.null(acm$quali.sup)) {\n    quali_sup_data <- acm$quali.sup$coord\n    quali_sup_df <- data.frame(quali_sup_data)\n    quali_sup_df$Variable <- rownames(quali_sup_df)\n    quali_sup_df$Type <- \"Suplementaria\"  # Marcamos las variables suplementarias\n    \n    # Unimos las variables activas y suplementarias\n    var_data_df <- rbind(var_data_df, quali_sup_df)\n  }\n  \n  # Añade la columna correspondiente al color si se usa col.var como en la función original\n  if (col.var == \"cos2\") {\n    # Crear una columna de color para las variables activas\n    active_cos2 <- get_mca_var(acm)$cos2[, axes[1]]\n    var_data_df$Color <- NA  # Inicializa la columna Color con NA\n    var_data_df$Color[var_data_df$Type == \"Activa\"] <- as.numeric(active_cos2)  # Solo activas con cos2, convertido a numérico\n    var_data_df$Color[var_data_df$Type == \"Suplementaria\"] <- NA  # Suplementarias no tendrán color en cos2\n    \n    p <- ggplot(var_data_df, aes(x = !!sym(colnames(var_data_df)[axes[1]]), \n                                 y = !!sym(colnames(var_data_df)[axes[2]]), \n                                 text = Variable, color = Color, shape = Type)) +\n      geom_point(size = 0.75, fill = \"red\",shape=25) +\n      theme_minimal() +\n      scale_color_gradientn(colors = gradient.cols, na.value = quali.col) +  # Aplica el gradiente solo a las activas\n      labs(x = paste0(\"Dim \", axes[1], \" (\", var_explained_x, \"%)\"),\n           y = paste0(\"Dim \", axes[2], \" (\", var_explained_y, \"%)\"))\n  } else {\n    # Usa un color fijo si no se especifica un gradiente\n    p <- ggplot(var_data_df, aes(x = !!sym(colnames(var_data_df)[axes[1]]), \n                                 y = !!sym(colnames(var_data_df)[axes[2]]), \n                                 text = Variable, shape = Type, color = Type)) +\n      geom_point(size = 0.75,shape=25) +\n      scale_color_manual(values = c(\"Activa\" = \"red\", \"Suplementaria\" = quali.col)) +\n      theme_minimal() +\n      labs(x = paste0(\"Dim \", axes[1], \" (\", var_explained_x, \"%)\"),\n           y = paste0(\"Dim \", axes[2], \" (\", var_explained_y, \"%)\"))\n  }\n  \n  # Agrega las líneas punteadas centradas en el plano cartesiano\n  p <- p + \n    geom_hline(yintercept = 0, linetype = \"dashed\", color = \"gray\") + \n    geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray\")\n  \n  # Conviértelo en un gráfico interactivo con plotly\n  plotly_obj <- ggplotly(p, tooltip = \"text\") %>% \n    style(hoverinfo = \"text\")  # Solo muestra el texto (Variable) al pasar el mouse\n  \n  # Retorna el gráfico interactivo\n  return(plotly_obj)\n}\n\n\n\n```\n\n```{r}\n#| label: MCA1\n#| echo: true\n#| output: false\n\n#MCA que incluye todas las categorias\nacm <- MCA(DatosCualitativos, graph=FALSE)\n\n\n#MCA con ventilación de aquellas categorias menores al 1%\nacm_ventil<-MCA(DatosCualitativos,graph = FALSE,level.ventil = 0.01)\n```\n\nAhora, mostraremos los resultados obtenidos por estos dos análisis de correspondencias múltiples.\n\n## Resultados de la inclusión de todas las categorías\n\nInicialmente, observaremos cuánta información es capturada por cada uno de los ejes obtenidos. Para ello, analizaremos los valores de inercia y los $cos^2$ asociados a cada eje, lo que nos permitirá evaluar la calidad de la representación de las variables en esos ejes. Además, dado que es posible la presencia de ejes \"parásitos\", utilizaremos el Criterio de Benzécri para ajustar los valores de inercia, con el fin de obtener una medida más precisa de la información capturada por cada una de las dimensiones.\n\n### Análisis de los ejes\n\n::: panel-tabset\n#### Valores propios\n\n```{r}\n#| label: screeplot1\n#| echo: false\n#| output: true\nscreeplot <- fviz_screeplot(acm, addlabels = TRUE, ylim = c(0, 20)) +  ggtitle(\"Scree Plot\") + theme_minimal()+ylab(\"Porcentaje de varianza explicada\")+xlab(\"Ejes\")\n## Usando modif.rate() del paquete GDAtools:\n# ptau <- modif.rate(acm)$modif[, 1]\n## Haciendo las cuentas uno mismo:\ns <- ncol(DatosCualitativos)\nl <- acm$eig[acm$eig[,1] > 1/s, 1]\ntau <- ( s / (s - 1) )^2 * ( l - (1/s) )^2\nptau <- tau / sum( tau ) * 100\n\n# Creamos un data frame para usar con ggplot2\nbarplot_df <- data.frame(Indice = factor(1:length(ptau)), Valor = ptau)\n\n# Creamos el gráfico de barras con ggplot2\nbarplot_gg <- ggplot(barplot_df, aes(x = Indice, y = Valor)) +\n  geom_bar(stat = \"identity\", fill = \"darkred\") +\n  ylim(0, max(barplot_df$Valor+10)) +\n  labs(x = \"Ejes\", y = expression(tau(lambda))) +\n  theme_minimal() +\n  ggtitle(\"Criterio de Benzécri\")\n\ngrid.arrange(screeplot, barplot_gg, ncol = 1)\n```\n\nSegún los valores propios, cada uno de los ejes posee información a atribuir, sin embargo, ninguna de estas es considerable. Dando indicios que las variables son independientes. Por otro lado, el Criterio de Benzécri nos muestra que los primeros 3-4 ejes, son los que poseen la mayor cantidad de inercia del análisis.\n\n#### Contribución 1er eje\n\n```{r}\n#| label: contribacm1\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acm, choice = \"var\", axes = 1) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nSe puede observar que esta dimensión la componen unicamente las categorías de \"No sabe\" y \"No responde\" de varias de las variables. Esto es de esperarse, pues dada su poca frecuencia, son las que más contribuyen a la inercia.\n\n#### Contribución 2do eje\n\n```{r}\n#| label: contribacm2\n#| echo: false\n#| output: true\ncontrib<-fviz_contrib(acm, choice = \"var\", axes = 2)\ncontrib<-contrib+theme(axis.text.x = element_text(size =3.5, angle = 90, hjust = 1))\n\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nPuede observarse que este eje está hecha principalmente por las variables discretizadas de TIEMPO_PROCESO y TIEMPO_RECLUIDO.También, las categorias de PARO_ESTUDIOS.No.paró.estudios y Nivel_Escolaridad.08 (correspondiente a nivel de estudios profesional completado), poseen un gran aporte a la construcción de este eje.\n\n#### Contribución 3er eje\n\n```{r}\n#| label: contribacm3\n#| echo: false\n#| output: true\n\ncontrib<-fviz_contrib(acm, choice = \"var\", axes = 3)\ncontrib<-contrib+theme(axis.text.x = element_text(size =3.5, angle = 90, hjust = 1))\n\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nEste eje está compuesto por las categorias de No paró estudios y nivel de estudios profesional completado. Esto tiene sentido, pues desde un punto de vista conceptual, estas 2 categorías son equivalentes.\n\n#### Contribución 4to eje\n\n```{r}\n#| label: contribacm4\n#| echo: false\n#| output: true\n\ncontrib<-fviz_contrib(acm, choice = \"var\", axes = 4)\ncontrib<-contrib+theme(axis.text.x = element_text(size =3.5, angle = 90, hjust = 1))\n\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nEste eje está principalmente compuesto por la categoría 0-2 de la variable CANTIDAD DE PERSONAS EN LA CELDA, junto con otras condiciones de la vida intracarcelaria, que son no contar con una ducha en la celda y pertenecer a una carcel mixta.\n:::\n\nSegún lo visto en los anteriores gráficos, decidimos considerar los primeros 4 ejes para el análisis de los individuos y de las variables. Que se pueden resumir a *grosso modo* de la siguiente forma:\n\n-   **1er eje:** Representa la no respuesta en las variables categoricas\n-   **2do eje:** Determinado principalmentepor no tener tiempo recluido, es decir, las personas que están siendo PROCESADAS, mas no CONDENADAS. También, representa a las personas que culminaron de forma exitosa sus estudios.\n-   **3er eje:** Representa principalmente a la personas que culminaron sus estudios hasta un nivel universitario.\n-   **4to eje:** Representa a las personas que comparten celda con pocas personas, y su condición de poseer ducha en la celda o no.\n\n### Proyección de los individuos en los planos factoriales\n\nUna vez determinados cómo están compuestos los 4 ejes considerados en el ACM, realizaremos la proyección de los individuos. Si bien esto no aporta mucho a la investigación dado que los individuos están anonimizados, nos puede ayudar a la identificación de patrones dentro de la población estudiada.\n\n::: panel-tabset\n#### Ejes 1-2\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_ind(acm, axes=c(1,2), geom=\"point\", asp=1, col.ind = \"cos2\",ggtheme=theme_minimal())\n\n\n```\n\nComo vimos en las contribuciones, el eje está determinado principalmente por las categorias de No sabe y No responde, por lo tanto, puede decirse que los individuos más alejados del centro son aquellos que pertenecen a estas categorías en alguna de las variables consideradas.\n\nDado que esta población es una minoria en la población estudiada, la mayoría de puntos se encuentran concentrados en el origen y alrededor del segundo eje.\n\n#### Ejes 1-3\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_ind(acm, axes=c(1,3), geom=\"point\", col.ind = \"cos2\",ggtheme=theme_minimal())\n```\n\nEn este plano acontece la misma situación que el plano anterior, pues el eje 1 separa a las personas de las categorías No sabe/ No responde de las demás personas.\n\n#### Ejes 1-4\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_ind(acm, axes=c(1,4), geom=\"point\", col.ind = \"cos2\",ggtheme=theme_minimal())\n```\n\nEn este plano acontece la misma situación que en los planos anteriores, pues el eje 1 separa a las personas de las categorías No sabe/ No responde de las demás personas.\n\n#### Ejes 2-3\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_ind(acm, axes=c(2,3), geom=\"point\", asp=1, col.ind = \"cos2\",ggtheme=theme_minimal())\n\n\n```\n\nDado que el eje 2 está representado por llevar 0 años recluido (es decir, estar siendo procesado), y que el eje 3 está categorizado principalmente por las personas que acabaron sus estudios. Los dos grandes grupos observados en el gráfico podrían representar diferencias entre individuos que están en distintas etapas judiciales (por ejemplo, procesados frente a condenados) y diferencias en el nivel educativo. Esto se analizará más en detalle en el análisis de las variables.\n\n#### Ejes 2-4\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_ind(acm, axes=c(2,4), geom=\"point\", asp=1, col.ind = \"cos2\",ggtheme=theme_minimal())\n\n\n```\n\nAl igual que en plano anterior, se ve una separación de un grupo considerablemente grande de la población. Esto puede deberse debido a que dichos individuos están siendo procesados y no han sido condenados.\n\n#### Ejes 3-4\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_ind(acm, axes=c(3,4), geom=\"point\", asp=1, col.ind = \"cos2\",ggtheme=theme_minimal())\n\n\n```\n\nAl igual que en plano anterior, se ve una separación de dos grupos de tamaño considerable de la población. En este caso, puede deberse debido a que dichos individuos poseen niveles de educación de profesional o de posgraduación.\n:::\n\nDe lo anteriormente visto en el análisis, puede verse que los ejes cumplen su papel en la separación y clasificación mediante sus categorías en determinadas variables. Sin embargo, dado que los individuos están anonimizados, no tenemos mayor información sobre estos grupos.\n\nSiendo así, nos centraremos en el análisis de las variables para una mejor comprensión de los resultados mostrados.\n\n### Proyección de las variables en los planos factoriales\n\nAhora, proyectaremos las categoarias de cada una de las variables cualitativas consideradas en nuestro ACM para hallar posibles relaciones entre estas.\n\n::: panel-tabset\n#### Ejes 1-2\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acm, axes=c(1,2), repel = TRUE,col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"), ggtheme=theme_minimal())\n\n\n```\n\nComo se mencionó anteriormente, las categorías de \"no sabe/no responde\" contribuyeron a la construcción de este eje y muestran una relación entre sí. Desde su significado, las variables alas que pertenecen estas categorías corresponden a diferentes aspectos de la vida intracarcelaria. Por lo tanto, puede decirse que, en general, las personas que no quisieron hablar sobre alguno de estos aspectos no proporcionaron información sobre sus condiciones de vida dentro del centro penitenciario.\n\n#### Ejes 2-3\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acm, axes=c(2,3), repel = TRUE, col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),ggtheme=theme_minimal())\n```\n\nConcordando con el análisis hecho desde las contribuciones y la proyección de los individuos, el eje 2 representa y muestra las relaciones entre las categorías del tiempo que una persona lleva siendo procesada o cumpliendo su condena, mostrando estos dos estados como opuestos. Por su parte, el eje 3 refleja principalmente la relación entre la categoría \"no paró estudios\" y un nivel educativo igual o superior al profesional. Lo que es lógico desde un punto de vista conceptual.\n\n#### Ejes 2-4\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acm, axes=c(2,4), repel = TRUE,col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"), ggtheme=theme_minimal())\n```\n\nEste plano muestra con más detalle algunas relaciones ya vistas, como lo son por ejemplo, la relación entre el tiempo de condena y el motivo por el cual se declaró culpable.\n\nSiendo así, tenemos que las personas que en este momento están siendo procesadas, normalmente tienen un proceso de 2 a 6 años de proceso. También, las personas que reconocieron la responsabilidad o que fueron complices de un delito, tienden a tener entre 1 a 6 años de condena.\n:::\n\nDe estos ejes se concluye que las categorias de \"No responde\" entre las variables de vida intracarcelaria están relacionadas. Además del estado opuesto del tiempo procesado y tiempo recluído y finalmente, la relación entre un nível de estudios profesional y la categoría \"No paró estudios\".\n\nEs posible observar otras relaciones entre las categorías, como por ejemplo, la cantidad de personas en la celda y el nível educativo o, declararse culpable y el tiempo que llevan en condena.\n\n### Contribución de cada variable\n\nFinalmente, veremos la contribución de cada una de las variables categóricas a cada uno de los planos factoriales considerados. Siendo así, si una variable se encuentra alejada del origen y sobre el eje $x$, quiere decir que dicha variable contribuyó de forma significativa a la construcción de dicho eje, para el eje $y$ se sigue un razonamiento análogo.\n\nEn el caso donde una variable haya aportado a la construcción de ambos ejes, entonces este se encontrará alejado de los ejes.\n\n::: panel-tabset\n#### Ejes 1-2\n\n```{r}\n#| label: contribucion-correlacion\n#| echo: false\n#| warning: false\n#| output: true\n\n# Crear el gráfico ggplot\ngg <- ggplot(data = acm$var$eta2, aes(x = !!sym(\"Dim 1\"), y = !!sym(\"Dim 2\"), label = rownames(acm$var$eta2), text = rownames(acm$var$eta2))) +\n  geom_point(size=0.75, shape=75, colour=\"blue3\") +  # Añadir los puntos\n  geom_text_repel(aes(label = rownames(acm$var$eta2)), size = 3) +  # Añadir las etiquetas\n  theme_minimal() +  # Aplicar un tema minimalista\n  labs(title = \"MCA - Correlación de variables\", \n       x = \"Dim 1\", y = \"Dim 2\") +  # Añadir títulos y etiquetas\n  scale_x_continuous(expand = c(0, 0), limits = c(-0.1, 1), breaks = seq(-0.1, 1, by = 0.1)) +  # Ajustar los límites del eje x\n  scale_y_continuous(expand = c(0, 0), limits = c(-0.1, 1), breaks = seq(-0.1, 1, by = 0.1)) +  # Ajustar los límites del eje y\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"gray50\") +  # Añadir línea horizontal en y = 0\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\")    # Añadir línea vertical en x = 0\n\n# Convertir el gráfico ggplot a plotly y mostrar el nombre de la variable al pasar el mouse\nggplotly(gg, tooltip = \"text\")\n\n```\n\nEn este caso, se tiene que para la construcción del primer y segundo ejese utilizaron variables diferentes. Pues en el caso del primer eje se utilizaron variables de la vida intracarcelaria y en el segundo eje se usó el tiempo que la persona lleva en la carcel y el nivel de escolaridad.\n\n#### Ejes 2-3\n\n```{r}\n#| label: contribucion-correlacion2\n#| echo: false\n#| warning: false\n#| output: true\n\n# Crear el gráfico ggplot\ngg <- ggplot(data = acm$var$eta2, aes(x = !!sym(\"Dim 2\"), y = !!sym(\"Dim 3\"), label = rownames(acm$var$eta2), text = rownames(acm$var$eta2))) +\n  geom_point(size=0.75, shape=75, colour=\"blue3\") +  # Añadir los puntos\n  geom_text_repel(aes(label = rownames(acm$var$eta2)), size = 3) +  # Añadir las etiquetas\n  theme_minimal() +  # Aplicar un tema minimalista\n  labs(title = \"MCA - Correlación de variables\", \n       x = \"Dim 2\", y = \"Dim 3\") +  # Añadir títulos y etiquetas\n  scale_x_continuous(expand = c(0, 0), limits = c(-0.1, 1), breaks = seq(-0.1, 1, by = 0.1)) +  # Ajustar los límites del eje x\n  scale_y_continuous(expand = c(0, 0), limits = c(-0.1, 1), breaks = seq(-0.1, 1, by = 0.1)) +  # Ajustar los límites del eje y\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"gray50\") +  # Añadir línea horizontal en y = 0\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\")    # Añadir línea vertical en x = 0\n\n# Convertir el gráfico ggplot a plotly y mostrar el nombre de la variable al pasar el mouse\nggplotly(gg, tooltip = \"text\")\n\n\n```\n\nEn este caso, puede observarse que el segundo y tercer eje están compuestos por las mismas variables, pero con peso diferente en sus contribuciones. Siendo así, la variable de tiempo en la carcel poseyó un mayor peso en la construcción del segundo eje, y el nivel de escolaridad tuvo un mayor peso en sus contribuciones al tercer eje\n\n#### Ejes 1-4\n\n```{r}\n#| label: contribucion-correlacion3\n#| echo: false\n#| warning: false\n#| output: true\ngg <- ggplot(data = acm$var$eta2, aes(x = !!sym(\"Dim 1\"), y = !!sym(\"Dim 4\"), label = rownames(acm$var$eta2), text = rownames(acm$var$eta2))) +\n  geom_point(size=0.75, shape=75, colour=\"blue3\") +  # Añadir los puntos\n  geom_text_repel(aes(label = rownames(acm$var$eta2)), size = 3) +  # Añadir las etiquetas\n  theme_minimal() +  # Aplicar un tema minimalista\n  labs(title = \"MCA - Correlación de variables\", \n       x = \"Dim 1\", y = \"Dim 4\") +  # Añadir títulos y etiquetas\n  scale_x_continuous(expand = c(0, 0), limits = c(-0.1, 1), breaks = seq(-0.1, 1, by = 0.1)) +  # Ajustar los límites del eje x\n  scale_y_continuous(expand = c(0, 0), limits = c(-0.1, 1), breaks = seq(-0.1, 1, by = 0.1)) +  # Ajustar los límites del eje y\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"gray50\") +  # Añadir línea horizontal en y = 0\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\")    # Añadir línea vertical en x = 0\n\n# Convertir el gráfico ggplot a plotly y mostrar el nombre de la variable al pasar el mouse\nggplotly(gg, tooltip = \"text\")\n\n```\n\nFinalmente, entre las relaciones vistas, puede verse que el eje 1 y el eje 4 fueron construidas a partir de las variables de vida intracarcelaria. Teniendo como variables principales, la cantidad de personas en la celda y la ´resencia de una ducha dentro de esta.\n:::\n\n## Resultados sin considerar las categorías de baja frecuencia\n\nAhora, realizaremos el mismo proceso y análisis anterior, con los resultados obtenidos al descartar el efecto de aquellas categorias que representaban amenos del 1% de la población. En este caso, solo resaltaremos las diferencias y los nuevos resultados que no fueron vistos en el ACM anterior.\n\n### Análisis de los ejes\n\n::: panel-tabset\n#### Valores propios\n\n```{r}\n#| label: screeplot1_ventil\n#| echo: false\n#| output: true\nscreeplot <- fviz_screeplot(acm_ventil, addlabels = TRUE, ylim = c(0, 20)) +  ggtitle(\"Scree Plot\") + theme_minimal()+ylab(\"Porcentaje de varianza explicada\")+xlab(\"Ejes\")\n## Usando modif.rate() del paquete GDAtools:\n# ptau <- modif.rate(acm)$modif[, 1]\n## Haciendo las cuentas uno mismo:\ns <- ncol(DatosCualitativos)\nl <- acm_ventil$eig[acm_ventil$eig[,1] > 1/s, 1]\ntau <- ( s / (s - 1) )^2 * ( l - (1/s) )^2\nptau <- tau / sum( tau ) * 100\n\n# Creamos un data frame para usar con ggplot2\nbarplot_df <- data.frame(Indice = factor(1:length(ptau)), Valor = ptau)\n\n# Creamos el gráfico de barras con ggplot2\nbarplot_gg <- ggplot(barplot_df, aes(x = Indice, y = Valor)) +\n  geom_bar(stat = \"identity\", fill = \"darkred\") +\n  ylim(0, max(barplot_df$Valor+10)) +\n  labs(x = \"Ejes\", y = expression(tau(lambda))) +\n  theme_minimal() +\n  ggtitle(\"Criterio de Benzécri\")\n\ngrid.arrange(screeplot, barplot_gg, ncol = 1)\n```\n\n#### Contribución 1er eje\n\n```{r}\n#| label: contribacm1_ventil\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acm_ventil, choice = \"var\", axes = 1) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nCon algunas diferencias en el porcentaje que contribuye cada variable a la construcción del eje. Este eje está compuesto por las mismas variables que componen al segundo eje de nuestro ACM anterior.\n\n#### Contribución 2do eje\n\n```{r}\n#| label: contribacm2_ventil\n#| echo: false\n#| output: true\ncontrib<-fviz_contrib(acm_ventil, choice = \"var\", axes = 2)\ncontrib<-contrib+theme(axis.text.x = element_text(size =3.5, angle = 90, hjust = 1))\n\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nCon algunas diferencias en el porcentaje que contribuye cada variable a la construcción del eje. Este eje está compuesto por las mismas variables que componen al tercer eje de nuestro ACM anterior.\n\n#### Contribución 3er eje\n\n```{r}\n#| label: contribacm3-ventil\n#| echo: false\n#| output: true\n\ncontrib<-fviz_contrib(acm_ventil, choice = \"var\", axes = 3)\ncontrib<-contrib+theme(axis.text.x = element_text(size =3.5, angle = 90, hjust = 1))\n\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nCon algunas diferencias en el porcentaje que contribuye cada variable a la construcción del eje. Este eje está compuesto por las mismas variables que componen al cuarto eje de nuestro ACM anterior.\n\n#### Contribución 4to eje\n\n```{r}\n#| label: contribacm4_ventil\n#| echo: false\n#| output: true\n\ncontrib<-fviz_contrib(acm_ventil, choice = \"var\", axes = 4)\ncontrib<-contrib+theme(axis.text.x = element_text(size =3.5, angle = 90, hjust = 1))\n\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nPese a que no fue mostrado anteriormente, este eje corresponde a nuestro 5 eje obtenido en el ACM anterior. Está compuesto principalmente por variables de la vida intracarcelaria, siendo de interés para nuestro estudio.\n\nSin embargo, en el ACM anterior, no mostró resultados significativos, por lo que no fue considerado en los gráficos mostrados.\n:::\n\nInicialmente, puede verse que este ACM ha disminuido el ruido de las variables retirando aquellas categorías que no nos dan información para neustro estudio. Si bien, no tenemos la conclusión anterior sobre la relación de estas categorías y la vida intracarcelaria, la exclusión de estas categorías puede ayudarnos a facilitar la interpretación de los resultados.\n\n### Proyección de los individuos en los planos factoriales\n\n::: panel-tabset\n#### Ejes 1-2\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_ind(acm_ventil, axes=c(1,2), geom=\"point\", asp=1, col.ind = \"cos2\",ggtheme=theme_minimal())\n\n\n```\n\n#### Ejes 2-3\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_ind(acm_ventil, axes=c(2,3), geom=\"point\", col.ind = \"cos2\",ggtheme=theme_minimal())\n```\n\n#### Ejes 1-4\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_ind(acm_ventil, axes=c(1,4), geom=\"point\", col.ind = \"cos2\",ggtheme=theme_minimal())\n```\n:::\n\nPueden observarse con mayor claridad las agrupaciones hechas por las categorías. Sin embargo, no presentan distinciones claras de los resultados anteriores. Por lo que podrían llegarse a los mismos comentarios.\n\n### Proyección de las variables en los planos factoriales\n\n::: panel-tabset\n#### Ejes 1-2\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acm_ventil, axes=c(1,2), repel = TRUE,col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"), ggtheme=theme_minimal())\n\n\n```\n\nObtenemos resultados similares a los anteriores. Sin embargo, se posee la ventaja que podemos observar algunas relaciones con más claridad.\n\nPor ejemplo, la relación entre el tiempo de condena y la forma en como el individuo fue declarado culpable. Las personas que reconocieron sus hechos o que admitieron ser complices tuvieron alrededor de 0.8 a 6.5 años de condena.\n\nTambién, la relación entre algunos tonos de piel, el nivel de escolaridad y el motivo por el cual pararon de estudiar. Finalmente, hay una relación entre ser homosexual y compartir celda con pocas personas.\n\nFinalmente, la cercanía de algunas variables con los ejes nos dan indicios de que, las carceles femeninas están relacionadas con las personas que están siendo procesadas, y que las personas que no cuenta con servicio médico o un espacio para hacer ejercicio, normalmente son, las que están siendo procesadas. Además, las personas divorciadas están más relacionadas con terminar sus estudios.\n\n#### Ejes 2-3\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acm_ventil, axes=c(2,3), repel = TRUE, col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),ggtheme=theme_minimal())\n```\n\nEste plano nos muestra algunas relaciones en las variables de la vida intracarcelaria, por ejemplo, compartir celda con máximo 2 personas y no contar con una ducha dentro de la celda. También, compartir celda con más de 10 personas y estár en una carcel mixta.\n\n#### Ejes 1-3\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acm_ventil, axes=c(1,3), repel = TRUE,col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"), ggtheme=theme_minimal())\n```\n\nAdemás de mostrar otras relaciones previamente mencionadas, muestra una posible relación entre parar los estudios por embarazo y no contar con servicio médico en la celda. Sin embargo, los valores de $cos^2$ de estas categorías no es muy alto, por lo que no se puede dar una validez total de esta relación\n\n#### Ejes 2-5\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acm_ventil, axes=c(2,5), repel = TRUE, col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),ggtheme=theme_minimal())\n```\n\nEste plano nos muestra una posible relación entre la orientación sexual \"bisexual\" y \"homosexual\" con las cárceles femeninas.\n:::\n\nEn general, pudieron observarse con más detalle relaciones que pueden dar una mejor explicación de los individuos y las variables en la población. Sin embargo, se deb tener en cuenta que la varianza captada por cada uno de estos ejes es menor del 5%, por lo que no se puede dar una total validez de las relaciones aqui mostradas.\n\n### Contribución de cada variable\n\n::: panel-tabset\n#### Ejes 1-2\n\n```{r}\n#| label: contribucion-correlacion-ventil\n#| echo: false\n#| warning: false\n#| output: true\n\n# Crear el gráfico ggplot\ngg <- ggplot(data = acm_ventil$var$eta2, aes(x = !!sym(\"Dim 1\"), y = !!sym(\"Dim 2\"), label = rownames(acm$var$eta2), text = rownames(acm_ventil$var$eta2))) +\n  geom_point(size=0.75, shape=75, colour=\"blue3\") +  # Añadir los puntos\n  geom_text_repel(aes(label = rownames(acm_ventil$var$eta2)), size = 3) +  # Añadir las etiquetas\n  theme_minimal() +  # Aplicar un tema minimalista\n  labs(title = \"MCA Ventil- Correlación de variables\", \n       x = \"Dim 1\", y = \"Dim 2\") +  # Añadir títulos y etiquetas\n  scale_x_continuous(expand = c(0, 0), limits = c(-0.1, 1), breaks = seq(-0.1, 1, by = 0.1)) +  # Ajustar los límites del eje x\n  scale_y_continuous(expand = c(0, 0), limits = c(-0.1, 1), breaks = seq(-0.1, 1, by = 0.1)) +  # Ajustar los límites del eje y\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"gray50\") +  # Añadir línea horizontal en y = 0\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\")    # Añadir línea vertical en x = 0\n\n# Convertir el gráfico ggplot a plotly y mostrar el nombre de la variable al pasar el mouse\nggplotly(gg, tooltip = \"text\")\n\n```\n\nPuede observarse que este plano está compuesto de la misma forma que en el ACM anterior.\n\n#### Ejes 2-3\n\n```{r}\n#| label: contribucion-correlacion2-ventil\n#| echo: false\n#| warning: false\n#| output: true\n\n# Crear el gráfico ggplot\ngg <- ggplot(data = acm_ventil$var$eta2, aes(x = !!sym(\"Dim 2\"), y = !!sym(\"Dim 3\"), label = rownames(acm_ventil$var$eta2), text = rownames(acm_ventil$var$eta2))) +\n  geom_point(size=0.75,shape=75,colour=\"blue3\") +  # Añadir los puntos\n  geom_text_repel(aes(label = rownames(acm_ventil$var$eta2)), size = 3) +  # Añadir las etiquetas\n  theme_minimal() +  # Aplicar un tema minimalista\n  labs(title = \"MCA Ventil - Correlación de variables\", \n       x = \"Dim 2\", y = \"Dim 3\")+  # Añadir títulos y etiquetas\nscale_x_continuous(expand = c(0, 0), limits = c(-0.1, 1), breaks = seq(-0.1, 1, by = 0.1)) +  # Ajustar los límites del eje x\n  scale_y_continuous(expand = c(0, 0), limits = c(-0.1, 1), breaks = seq(-0.1, 1, by = 0.1)) +  # Ajustar los límites del eje y\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"gray50\") +  # Añadir línea horizontal en y = 0\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\")    # Añadir línea vertical en x = 0\n\n# Convertir el gráfico ggplot a plotly y mostrar el nombre de la variable al pasar el mouse\nggplotly(gg, tooltip = \"text\")\n\n```\n\nEn este gráfico vemos las variables de tiempo en la carcel, ya sea procesado o condenado, y el nivel de escolaridad tuvieron contribuciones en la construcción de los 2 ejes.\n\n#### Ejes 4-5\n\n```{r}\n#| label: contribucion-correlacion3_ventil\n#| echo: false\n#| warning: false\n#| output: true\ngg <- ggplot(data = acm_ventil$var$eta2, aes(x = !!sym(\"Dim 4\"), y = !!sym(\"Dim 5\"), label = rownames(acm_ventil$var$eta2), text = rownames(acm_ventil$var$eta2))) +\n  geom_point(size=0.75,shape=75,colour=\"blue3\") +  # Añadir los puntos\n  geom_text_repel(aes(label = rownames(acm_ventil$var$eta2)), size = 3) +  # Añadir las etiquetas\n  theme_minimal() +  # Aplicar un tema minimalista\n  labs(title = \"MCA Ventil - Correlación de variables\", \n       x = \"Dim 4\", y = \"Dim 5\")+  # Añadir títulos y\n# Convertir el gráfico ggplot a plotly y mostrar el nombre de la variable al pasar el mouse\n  scale_x_continuous(expand = c(0, 0), limits = c(-0.1, 1), breaks = seq(-0.1, 1, by = 0.1)) +  # Ajustar los límites del eje x\n  scale_y_continuous(expand = c(0, 0), limits = c(-0.1, 1), breaks = seq(-0.1, 1, by = 0.1)) +  # Ajustar los límites del eje y\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"gray50\") +  # Añadir línea horizontal en y = 0\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = \"gray50\")    # Añadir línea vertical en x = 0\n\nggplotly(gg, tooltip = \"text\")\n\n```\n\nPuede observarse que la 4 dimensión fue obtenida a partir de variables relacionadas a la vida intracarcelaria y el 5 eje fue construido principalmente por variables sociodemográficas.\n:::\n\n# ACM por grupos de variables\n\nComo se observó en el análisis descriptivo bivariado, en el análisis de correspondencias simples y en los resultados de los análisis de correspondencias múltiples anteriores, las relaciones entre las variables cualitativas se encuentran principalmente en aquellas que están conceptualmente vinculadas, como las condiciones de vida dentro de la celda o las variables sociodemográficas.\n\nEsto es coherente desde un punto de vista lógico y conceptual, pues desde el diseño del cuestionario, se sugería la existencia de estas relaciones desde su estructura, la cual dividía y ordenaba las preguntas del formulario en 11 temáticas. \n\nPor lo tanto, para mejorar la visualización e interpretación de los resultados, decidimos agrupar las variables basándonos en su significado conceptual y en las relaciones identificadas en los análisis descriptivos y factoriales previos. Además, para evitar la inflación de la inercia por las categorías de baja frecuencia, realizaremos el análisis descartando las categorías que representan menos del 1% de la población.\n\n## Variables Sociodemográficas\n\nLas variables sociodemográficas consideradas para la realización del ACM fueron:\n\n-   Sexo\n-   Edad\n-   Estado Civil\n-   Orientación Sexual\n-   Nivel de Escolaridad\n-   Motivo por el cual paró sus estudios\n-   Vivió con madre durante la adolescencia\n-   Vivió con padre durante la adolescencia\n-   Consideró el suicidio dentro del centro penitenciario\n-   Edad en la que consumió X sustancia psicoactiva por primera vez.\n-   Tiene hijos.\n\nEn este caso, la variable edad fue incluida como una variable cualitativa suplementaria, y la mayoría de sustancias (a excepción de alcohol, tabaco y marihuana) fueron incluidas como variables cualitativas suplementarias. Esto dado que, se intuye que existe una alta relación entre el consumo de estas sustancias y no se quiere opacar los otros resultados del ACM con estas relaciones.\n\n```{r}\n#| label: ACM Sociodemográficas\n#| message: false\n#| echo: false\n#| output: false\n\n\nVar_cuali_sociodemo<-c(\n  \"SEXO\",\n\"EDAD\",\n#\"NACION\",\n\"EST_CIVIL\", \n\"VIVE_CON\",\n\"HIJOS\",\n\"NIVEL_ESCOLARIDAD\",\n\"PARO_ESTUDIOS\",\n#\"IDENTI_GENERO\", \n\"ORIENT_SEXUAL\",\n\"CATEGORIAS_EDAD_CONSUMO_TABACO\",\n\"CATEGORIAS_EDAD_CONSUMO_ALCOHOL\",\n\"CATEGORIAS_EDAD_CONSUMO_MARIHUANA\" ,\n\"CATEGORIAS_EDAD_CONSUMO_INHALABLES\",\n\"CATEGORIAS_EDAD_CONSUMO_LSD\",\n\"CATEGORIAS_EDAD_CONSUMO_HONGOS\",\n\"CATEGORIAS_EDAD_CONSUMO_COCAINA\",\n\"CATEGORIAS_EDAD_CONSUMO_CRACK\",\n\"CATEGORIAS_EDAD_CONSUMO_HEROINA\",\n\"CATEGORIAS_EDAD_CONSUMO_CHOCHOS\",\n\"CATEGORIAS_EDAD_CONSUMO_TRANQUILIZANTES\",\n\"CATEGORIAS_EDAD_CONSUMO_ANFETAMINAS\",\n\"COLOR_PIEL\",\n\"VIVIO_MADRE_ADOLESCENCIA\", \n\"VIVIO_PADRE_ADOLESCENCIA\",\n\"CONSIDERO_SUICIDIO\" ,\n \"DISC_VISUAL\",\n\"DISC_AUDITIVA\",\n\"DISC_MOTRIZ\"\n)\n\nDatosCualiSoc<-Tabla1[,Var_cuali_sociodemo]\nacmSoc <- MCA(DatosCualiSoc, graph=FALSE,level.ventil = 0.01,ncp=7,quali.sup = c(13:21),quanti.sup = 2)\n```\n\n### Análisis de las variables\n::: panel-tabset\n\n#### Ejes 1-2\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acmSoc,col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"), \n             axes=c(1,2), repel = TRUE,  ggtheme=theme_minimal(),quali.col = \"black\")\n\n#fviz_mca_var(acmSoc,col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"), axes=c(4,5), repel = TRUE,label=\"none\",  ggtheme=theme_minimal())\n\n\n```\n\nDe forma inicial, puede observarse la relación entre el consumo de sustancias psicoactivas en diferentes edades; resaltando que las categorías más próximas tienden a ser aquellas que corresponden a intervalos de edad más cercanos, opr ejemplo, la edad de inicio de consumo de tabaco ser entre los 4 y 12 años, y la edad de inicio de consumo de cocaína ser entre los 4 y 15 años.\n\nAdemás, puede observarse que el consumo de estas sustancias en edades entre los 14 y 17 años, está relacionada con no continuar los estudios por motivos de ocio o haber sido expulsado de la escuela.\n\nTambién, se observa que las categorías sobre el consumo de estas sustancias despues de los 18 años, y las categorías de \"nunca han consumido\" están más relacionadas con las mujeres. Junto a estas variables, también se encuentra una relación entre estar divorciada/viuda, tener hijois y ser mujer.\n\nFinalmente, puede observarse la alta relación entre el nivel educativo y parar estudios. Relación que ya fue vista en los anteriores ACM. \n\n#### Ejes 1-3\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acmSoc,col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"), \n             axes=c(1,3), repel = TRUE,  ggtheme=theme_minimal(),quali.col = \"black\")\n\n#fviz_mca_var(acmSoc,col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"), axes=c(4,5), repel = TRUE,label=\"none\",  ggtheme=theme_minimal())\n\n\n```\n\nEste plano, además de mostrar algunas relaciones mencionadas previamente, muestra la existencia de una relación entre ser mujer y parar los estudios debido a un embarazo, y también, ser mujer y ser homosexual.\n\n\ntambién nos muestra que las poseer alguna discapacidad auditiva o motriz, está relacionada a no haber estudiado. Sin embargo, la calidad de representación de estas categorías no es alta, por lo que este resultado puede ser invalido. \n\n\n#### Ejes 3-4\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acmSoc,col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"), \n             axes=c(4,3), repel = TRUE,  ggtheme=theme_minimal(),quali.col = \"black\")\n\n#fviz_mca_var(acmSoc,col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"), axes=c(4,5), repel = TRUE,label=\"none\",  ggtheme=theme_minimal())\n\n\n```\n\nEste eje nos muestra la relación entre vivir con los padres y ser soltero, vivir con la pareja sentimental y ser casado y, ser hombre, tener hijos y vivir con la pareja en unión libre.\n:::\n\nCabe resaltar que en los gráficos anteriores es posible encontrar muchas más relaciones entre las variables, sin embargo, solo fueron mencionadas aquellas que presentaron un valor alto en los $cos^2$, es decir, aquellas que se encontraban representadas por el plano que se estaba considerando. Esto, para evitar mencionar relaciones que puedan ser inválidas. Siendo así, es posible que incluso algunas de las relaciones mencionadas sean significativas.\n\n### Contribuciónes de los ejes\n::: panel-tabset\n\n#### Valores propios\n\n```{r}\n#| echo: false\nscreeplot <- fviz_screeplot(acmSoc, addlabels = TRUE, ylim = c(0, 20)) +  ggtitle(\"Scree Plot\") + theme_minimal()+ylab(\"Porcentaje de varianza explicada\")+xlab(\"Ejes\")\n## Usando modif.rate() del paquete GDAtools:\n# ptau <- modif.rate(acm)$modif[, 1]\n## Haciendo las cuentas uno mismo:\ns <- ncol(DatosCualiSoc)\nl <- acmSoc$eig[acmSoc$eig[,1] > 1/s, 1]\ntau <- ( s / (s - 1) )^2 * ( l - (1/s) )^2\nptau <- tau / sum( tau ) * 100\n\n# Creamos un data frame para usar con ggplot2\nbarplot_df <- data.frame(Indice = factor(1:length(ptau)), Valor = ptau)\n\n# Creamos el gráfico de barras con ggplot2\nbarplot_gg <- ggplot(barplot_df, aes(x = Indice, y = Valor)) +\n  geom_bar(stat = \"identity\", fill = \"darkred\") +\n  ylim(0, max(barplot_df$Valor+10)) +\n  labs(x = \"Ejes\", y = expression(tau(lambda))) +\n  theme_minimal() +\n  ggtitle(\"Criterio de Benzécri\")\n\ngrid.arrange(screeplot, barplot_gg, ncol = 1)\n```\n\nDe forma detallada, los primeros 5 valores de la inercia ajustada según el criterio de Benzécri son\n\n```{r}\n#| label: Tabla-benzecrisoc\n#| echo: false\n#| warning: false\n#| output: true\n\nkable(barplot_df[1:5,])\n```\n\n#### Contribución 1er eje\n\n```{r}\n#| label: contribacm1Socio\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acmSoc, choice = \"var\", axes = 1) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nEste eje está compuesto principalmente por las categorías de consumo de sustancias psicoactivas antes de los 14 años.\n\n#### Contribución 2do eje\n\n```{r}\n#| label: contribacm2 Socio\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acmSoc, choice = \"var\", axes = 2) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\nEste eje fue construido debido a la alta correlación entre el motivo de parar estudios y el nivel educativo. Por lo que sus resultados no son destacables.\n\n\n#### Contribución 3er eje\n\n```{r}\n#| label: contribacm3 Socio\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acmSoc, choice = \"var\", axes = 3) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nMismo caso que el eje anterior, sin embargo, este eje muestra una pequeña relación entre las categorías de ser mujer y tener hijos.\n\n#### Contribución 4to eje\n\n```{r}\n#| label: contribacm4 Socio\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acmSoc, choice = \"var\", axes = 4) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\nEste eje está compuesto por categorías de las variables de estado civil, y la composición del hogar. \n\n:::\n\nUna vez vista la inercia de cada uno de los ejes, y las categorías que contribuyeron a la construcción de cada uno de estos. Se consideraron los primeros 4 ejes del ACM, dado que, según el criterio de Benzécri, estos contienen alrededor del 52% de la inercia de los datos. Además de presentar diferentes relaciones entre sus variables, las cuales ya fueron mencionadas previamente.\n\n## Variables económicas\n\nLas variables económicas consideradas para la realización de este ACM son:\n\n- Excluyendo a la persona, quien sería la cabeza del hogar en el lugar donde vive. (si la persona vive sola, se tiene la categoría \"vive solo/a\")\n- Alguna vez ha trabajado, ya sea una actividad legal o ilegal.\n- Tenian suficiente comida todos los días (En el último año antes de la detención)\n- Tenían alguna deuda (En el último año antes de la detención)\n- Cuanto fue el salario total del último mes antes de la detención\n\n\n```{r}\n#| label: ACM Economicas\n#| message: false\n#| echo: false\n#| output: false\n\n\nVar_cuali_eco<-c(\"VIVE_CON\",\n                 \"TRABAJO\",\n                 \"PODIA_COMER\",\n                 \"DEUDA\",\n                 \"SALARIO_MES_ANTERIOR\")\n\nDatosCualieco<-Tabla1[,Var_cuali_eco]\nacmEco <- MCA(DatosCualieco, graph=FALSE,level.ventil = 0.01)\n```\n\n### Análisis de las variables\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acmEco, axes=c(1,2), repel = TRUE,  ggtheme=theme_minimal(),col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"))\n\n\n```\n\nEn este plano, puede observarse como cada categoría del salario, se relaciona con algunas condiciones económicas de la persona. \n\nPuede verse que, la categoría del salario más bajo es la más próxima a la categoría correspondiente a no poder comer todos los días;la categoría de \"no recibia ingresos\" está relacionada con nunca haber trabajado.\n\nTambién, puede verse que las categorías de *PODIA_COMER.SI*, *DEUDA_NO*, vivir solo o con su pareja sentimental y *SALARIO_MES.3* (entre 5501 y 7500 pesos mexicanos) tienen una estrecha relación. También estas categorías están relacionadas con las categorías correspondientes a salarios mas altos, pero con menos intensidad. \n\nFinalmente, las personas cuya cabeza del hogar era una persona diferente a ellos mismos o sus parejas, poseían menos ingresos mensuales antes de su detención.\n\nSe resalta que la dimensión 1, presenta de forma **ordenada de forma decreciente** las categorías de la variable SALARIO_ULTIMO_MES. Y que las demás variables de este componente, se encuentran alineadas a este eje.\n\n### Contribuciones de los ejes\n\n::: panel-tabset\n#### Valores propios\n\n```{r}\n#| echo: false\nscreeplot <- fviz_screeplot(acmEco, addlabels = TRUE, ylim = c(0, 20)) +  ggtitle(\"Scree Plot\") + theme_minimal()+ylab(\"Porcentaje de varianza explicada\")+xlab(\"Ejes\")\n## Usando modif.rate() del paquete GDAtools:\n# ptau <- modif.rate(acm)$modif[, 1]\n## Haciendo las cuentas uno mismo:\ns <- ncol(DatosCualieco)\nl <- acmEco$eig[acmEco$eig[,1] > 1/s, 1]\ntau <- ( s / (s - 1) )^2 * ( l - (1/s) )^2\nptau <- tau / sum( tau ) * 100\n\n# Creamos un data frame para usar con ggplot2\nbarplot_df <- data.frame(Indice = factor(1:length(ptau)), Valor = ptau)\n\n# Creamos el gráfico de barras con ggplot2\nbarplot_gg <- ggplot(barplot_df, aes(x = Indice, y = Valor)) +\n  geom_bar(stat = \"identity\", fill = \"darkred\") +\n  ylim(0, max(barplot_df$Valor+10)) +\n  labs(x = \"Ejes\", y = expression(tau(lambda))) +\n  theme_minimal() +\n  ggtitle(\"Criterio de Benzécri\")\n\ngrid.arrange(screeplot, barplot_gg, ncol = 1)\n```\n\n#### Contribución 1er eje\n\n```{r}\n#| label: contribacm1Eco\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acmEco, choice = \"var\", axes = 1) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\n\n#### Contribución 2do eje\n\n```{r}\n#| label: contribacm2 Eco\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acmEco, choice = \"var\", axes = 2) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\n:::\n\nDada las inercias observadas, consideramos únicamente los 2 primeros ejes de este ACM.\n\nAl observar la contribución de cada una de las categorías a la construcción de los ejes, puede verse que los ejes se encuentran compuestos por las categorías ligadas a una situación económica desfavorable. Por ejemplo, no tener trabajo o bajos ingresos , tener deudas y no tener suficiente comida.\n\n## Variables delictivas\n\nLas variables delictivas consideradas en el ACM fueron:\n\n- El individuo ya habia sido sentenciado antes en un centro de reclusión.\n- Motivo de detención de la persona\n- Tiempo que hubo entre el delito y la detención de la persona.\n- La policia o autoridad que lo detuvo le propuso algun tipo de soborno a cambio de dejarlo ir, no lastimarlo, no hacer daño a la familia...etc.\n- Motivo por el cual la persona se declaró culpable (en caso de haberlo hecho)\n- Durante el juicio de la persona, las autoridades le pidieron un soborno a cambio de dejarlo ir o alterar los hechos para beneficiarlo.\n- Tiempo que la persona ha estado en proceso o fue condenada.\n- Cantidad de delitos abiertos (cualitativa suplementaria)\n\n\n```{r}\n#| label: ACM Delictivas\n#| message: false\n#| echo: false\n#| output: false\n\n\nVar_cuali_deli<-c(\n  \"SENTENCIADO_ANTES\",\n  \"MOTIVO_DETENCION\" ,\n  \"TIEMPO_DEL_DET\",\n \"INTENTO_SOBORNO\",\n \"DECLARACION_CULPABLE\",\n \"INTENTO_SOBORNO_JUICIO\",\n \"CATEGORIAS_TIEMPO_RECLUIDO\",\n \"CATEGORIAS_TIEMPO_PROCESO\",\n \"DELITOS_ABIERTOS\"\n)\n\nDatosCualiDeli<-Tabla1[,Var_cuali_deli]\nacmDeli <- MCA(DatosCualiDeli, graph=FALSE,level.ventil = 0.01,quanti.sup = 9)\n```\n\n### Análisis de las variables\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acmDeli, axes=c(1,2), repel = TRUE,  ggtheme=theme_minimal(),col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"))\n\n```\nEl plano factorial nos muestra la relación entre los tiempos de una persona recluida y procesada, tal como se vió anteriormente, estos son totalmente opuestos. \n\nAsí, se ve la relación entre las personas que se declararon culpables porque \"reconocieron los hechos\" o \"el abogado se los recomendo\" y un tiempo de condena entre 1 a 6.5 años.\n\nTambién, puede ver que los mayores tiempo de condena están relacionados con las personas que se declararon culpables porque fueron agredidas o amenazadas, y que también manifestaron que las autoridades pidieron un soborno durante el proceso de detención y juicio. Sin embargo, estas relaciones pueden ser no significativas dada la baja calidad de representación de estas categorías en el plano.\n\n### Contribuciones de los ejes\n::: panel-tabset\n#### Valores propios\n\n```{r}\n#| echo: false\nscreeplot <- fviz_screeplot(acmDeli, addlabels = TRUE, ylim = c(0, 20)) +  ggtitle(\"Scree Plot\") + theme_minimal()+ylab(\"Porcentaje de varianza explicada\")+xlab(\"Ejes\")\n## Usando modif.rate() del paquete GDAtools:\n# ptau <- modif.rate(acm)$modif[, 1]\n## Haciendo las cuentas uno mismo:\ns <- ncol(DatosCualiDeli)\nl <- acmDeli$eig[acmDeli$eig[,1] > 1/s, 1]\ntau <- ( s / (s - 1) )^2 * ( l - (1/s) )^2\nptau <- tau / sum( tau ) * 100\n\n# Creamos un data frame para usar con ggplot2\nbarplot_df <- data.frame(Indice = factor(1:length(ptau)), Valor = ptau)\n\n# Creamos el gráfico de barras con ggplot2\nbarplot_gg <- ggplot(barplot_df, aes(x = Indice, y = Valor)) +\n  geom_bar(stat = \"identity\", fill = \"darkred\") +\n  ylim(0, max(barplot_df$Valor+10)) +\n  labs(x = \"Ejes\", y = expression(tau(lambda))) +\n  theme_minimal() +\n  ggtitle(\"Criterio de Benzécri\")\n\ngrid.arrange(screeplot, barplot_gg, ncol = 1)\n```\n\nDe forma detallada, los primeros 3 valores de la inercia ajustada según el criterio de Benzécri son\n\n```{r}\n#| label: Tabla-benzecrideli\n#| echo: false\n#| warning: false\n#| output: true\n\nkable(barplot_df[1:3,])\n```\n\n#### Contribución 1er eje\n\n```{r}\n#| label: contribacm1SDeli\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acmDeli, choice = \"var\", axes = 1) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nComo es de esperarse, este eje refleja la relación más evidente de este ACM, la cual es el tiempo que la persona ha sido procesada y condenada, pues estos 2 estados son opuestos desde un punto de vista conceptual. \n\n#### Contribución 2do eje\n\n```{r}\n#| label: contribacm2 deli\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acmDeli, choice = \"var\", axes = 2) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nEste eje está compuesto por las categorías de INTERNO_SOBORNO_JUICIO.1 y el mayor tiempo de condena. Teniendo también influencia de los motivos por los cuales la persona se declaró culpable. \n:::\n\nPor lo visto en los anteriores gráficos, se consideraron únicamente los 2 primeros ejes, los cuales contienen un 80% de la inercia de los datos.\n\n## Vida Intracarcelaria\n\nLas variables consideradas en el componente de vida intracarcelaria son las siguientes:\n\n- Sexo de la persona\n- Orientación sexual de la persona\n- Acceso a ventanas en la celda\n- Acceso a agua potable en la celda\n- Acesso a un sistema de drenaje en la celda\n- Acceso a luz electrica en la celda\n- Acceso a una ducha en la celda\n- Acceso a un sanitario en la celda\n- Acceso a servicio médico dentro de la celda\n- Acceso a alimentos gratuitos en la celda\n- Acceso a espacios de ejercicio en la carcel\n- Acceso a espacios y/o material de lectura en la carcel\n- Facilidad de ejercer la religión dentro de la carcel\n- Puede realizar llamadas dentro de la carcel\n- Puede continuar con sus estudios dentro de la carcel\n- Puede recibir visitas dentro de la carcel\n- Sensación de seguridad en la celda\n- Sensación de seguridad en la carcel\n- Tipo de carcel\n- Cantidad de personas en la celda\n\n```{r}\n#| label: ACM Intra carcelaria\n#| message: false\n#| echo: false\n#| output: false\n\n\nVar_cuali_intra<-c(\n \"CAR_PERSONAS_CELDA\",\n \"CELDA_VENTANAS\",\n \"CELDA_AGUA_POTABLE\" ,\n \"CELDA_DRENAJE\",\n \"CELDA_LUZ\",\n \"CELDA_DUCHA\" ,\n \"CELDA_SANITARIO\" ,\n \"CELDA_SERVICIO_MEDICO\",\n \"CELDA_ALIMENTOS\",\n \"CARCEL_EJERCICIO\",\n \"CARCEL_LECTURA\" ,\n \"CARCEL_RELIGION\" ,\n \"CARCEL_LLAMADAS\" ,\n \"CARCEL_ESTUDIO\" ,\n \"CARCEL_VISITA\" ,\n \"CELDA_SEGURIDAD\" ,\n \"CARCEL_SEGURIDAD\",\n \"TIPO_CARCEL\",\n \"TIEMPO_CARCEL\",\n \"ORIENT_SEXUAL\",\n \"SEXO\"\n)\n\nDatosCualiIntra<-Tabla1[,Var_cuali_intra]\nacmIntra <- MCA(DatosCualiIntra, graph=FALSE,level.ventil = 0.01)\n```\n\n### Análisis de las variables \n\n::: panel-tabset\n\n#### Eje 1-2\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acmIntra, axes=c(1,2), repel = TRUE,  ggtheme=theme_minimal(),col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"))\n\n```\nEn este eje, puede observarse claramente la alta relación que hay en no contar con un sistema de drenaje en la celda, y no contar con un sanitario dentro de esta. también, la relación entre el acceso a una ducha y el agua potable. \n\nAdemás, como fue mencionado en el primer ACM, se ve una relación entre ser mujer y tener como orientación sexual la bisexualidad o la homosexualidad.  Junto a esto, se tiene una relación lógica, no tan marcada pero presente, entre ser mujer y el tipo de carcel \"femenina\". \n\nPor otro lado, la segunda componente nos muestra una relación entre no poder practicar religión, actividad física, actividades de lectura, realizar llamadas, sentirse seguro en la celda y un alto número de personas en la celda.\n\n#### Eje 2-3 \n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\nfviz_mca_var_interactive(acmIntra, axes=c(2,3), repel = TRUE,  ggtheme=theme_minimal(),col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"))\n\n```\n\nEste eje, además de mostrar con mayor claridad la relación entre no contar con diversos servicios en la celda y el alto número de personas en esta. También nos muestra una relación entre ser mujer y llevar menos de 6 meses en la carcel.\n\nEl eje 2, también nos muestra la relación positiva entre contar con diversos servicios en la celda, como material de lectura, espacios para hacer ejercicio, máximo 6 personas en la celda, y tener espacios para estudiar, con la sensación de seguridad en la carcel.\n\n:::\n\n### Contribución de los ejes\n\n::: panel-tabset\n#### Valores propios\n\n```{r}\n#| echo: false\nscreeplot <- fviz_screeplot(acmIntra, addlabels = TRUE, ylim = c(0, 20)) +  ggtitle(\"Scree Plot\") + theme_minimal()+ylab(\"Porcentaje de varianza explicada\")+xlab(\"Ejes\")\n## Usando modif.rate() del paquete GDAtools:\n# ptau <- modif.rate(acm)$modif[, 1]\n## Haciendo las cuentas uno mismo:\ns <- ncol(DatosCualiIntra)\nl <- acmIntra$eig[acmIntra$eig[,1] > 1/s, 1]\ntau <- ( s / (s - 1) )^2 * ( l - (1/s) )^2\nptau <- tau / sum( tau ) * 100\n\n# Creamos un data frame para usar con ggplot2\nbarplot_df <- data.frame(Indice = factor(1:length(ptau)), Valor = ptau)\n\n# Creamos el gráfico de barras con ggplot2\nbarplot_gg <- ggplot(barplot_df, aes(x = Indice, y = Valor)) +\n  geom_bar(stat = \"identity\", fill = \"darkred\") +\n  ylim(0, max(barplot_df$Valor+10)) +\n  labs(x = \"Ejes\", y = expression(tau(lambda))) +\n  theme_minimal() +\n  ggtitle(\"Criterio de Benzécri\")\n\ngrid.arrange(screeplot, barplot_gg, ncol = 1)\n```\nDe forma detallada, los primeros 4 valores de la inercia ajustada según el criterio de Benzécri son\n\n```{r}\n#| label: Tabla-benzecriintra\n#| echo: false\n#| warning: false\n#| output: true\n\nkable(barplot_df[1:5,])\n```\n#### Contribución 1er eje\n\n```{r}\n#| label: contribacm1 Intra\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acmIntra, choice = \"var\", axes = 1) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nEste eje está compuesto principalmente por la falta de acceso a servicios en la celda. \n\n\n#### Contribución 2do eje\n\n```{r}\n#| label: contribacm2 Intra\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acmIntra, choice = \"var\", axes = 2) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nDe forma similar al primer eje, esta variable está compuesta por la sensación de inseguridad en el centro penitenciario.\n\n#### Contribución 3er eje\n\n```{r}\n#| label: contribacm3 Intra\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acmIntra, choice = \"var\", axes = 3) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nEste eje está caracterizado por las variables de SEXO y del tipo de carcel. \n:::\n\nAsí, a partir de los visto en los gráficos anteriores, se consideraron los 3 primeros ejes del ACM, pues estos acumulan el 90% de la inercia según el criterio de Benzécri.\n\n## Expectativas de Salida\n\nFinalmente, el último componente en los cuales pueden agruparse conceptualmente las variables consideradas en este estudio es el de Expectativas de Salida. \n\nPara este caso, las variables usadas en el ACM fueron:\n\n- Considera que podrá encontrar vivienda una vez salga de la carcel.\n- Considera que podrá encontrar empleo una vez salga de la carcel\n- Considera que podrá continuar sus estudios una vez salga de la carcel.\n- Considera que podrá reintegrarse con sus amigos una vez salga de la carcel\n- Considera que podrá reintegrarse con su familia una vez salga de la carcel\n- Considera que podrá reincorporarse a la sociedad una vez salga de la carcel\n\nAdicionalmente, se incluyó la variable cualitativa \"CONSIDERO_SUICIDIO\" ya que, además de poseer una relación conceptual con las variables de expectativa de salida, fue visto en el análisis descriptivo que estas variable posee una relación en la tabla de perfiles con estas variables.\n\n```{r}\n#| label: ACM Expectativas\n#| message: false\n#| echo: false\n#| output: false\n\n\nVar_cuali_sali<-c(\n\"SALIDA_VIVIENDA\",\n \"SALIDA_EMPLEO\",\n \"SALIDA_ESTUDIO\",\n \"SALIDA_AMIGOS\",\n \"SALIDA_FAMILIA\",\n \"SALIDA_REINCORPORACION\",\n \"CONSIDERO_SUICIDIO\" \n)\n\nDatosCualisali<-Tabla1[,Var_cuali_sali]\nacmSali <- MCA(DatosCualisali, graph=FALSE,level.ventil = 0.02)\n```\n\n### Análisis de variables\n\n```{r}\n#| fig-cap: ''\n#| fig-align: 'center'\n#| fig-width: 5.5\n#| fig-height: 5\n#| echo: false\n#fviz_mca_var_interactive(acmSali, axes=c(2,4), repel = TRUE,  ggtheme=theme_minimal())\n\nfviz_mca_var_interactive(acmSali, axes=c(1,2), repel = TRUE,  ggtheme=theme_minimal(),col.var = \"cos2\", gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"))\n\n\n```\n\nPuede observarse que la mayoría de categorías se encuentran bien representadas por el primer eje, además de mostrar relaciones marcadas entre estas. Por ejemplo, la esperanza de reintegrarse con amigos y familia, poder continuar sus estudios y el poder encontrar empleo.\n\n\n### Contribución de los ejes\n\n::: panel-tabset\n\n#### Valores propios\n\n```{r}\n#| echo: false\n\n\nscreeplot <- fviz_screeplot(acmSali, addlabels = TRUE, ylim = c(0, 30)) +  ggtitle(\"Scree Plot\") + theme_minimal()+ylab(\"Porcentaje de varianza explicada\")+xlab(\"Ejes\")\n\n## Usando modif.rate() del paquete GDAtools:\n# ptau <- modif.rate(acm)$modif[, 1]\n## Haciendo las cuentas uno mismo:\ns <- ncol(DatosCualisali)\nl <- acmSali$eig[acmSali$eig[,1] > 1/s, 1]\ntau <- ( s / (s - 1) )^2 * ( l - (1/s) )^2\nptau <- tau / sum( tau ) * 100\n\n# Creamos un data frame para usar con ggplot2\nbarplot_df <- data.frame(Indice = factor(1:length(ptau)), Valor = ptau)\n\n# Creamos el gráfico de barras con ggplot2\nbarplot_gg <- ggplot(barplot_df, aes(x = Indice, y = Valor)) +\n  geom_bar(stat = \"identity\", fill = \"darkred\") +\n  ylim(0, max(barplot_df$Valor+10)) +\n  labs(x = \"Ejes\", y = expression(tau(lambda))) +\n  theme_minimal() +\n  ggtitle(\"Criterio de Benzécri\")\n\ngrid.arrange(screeplot, barplot_gg, ncol = 1)\n```\n\nDe forma detallada, los 3 valores de la inercia ajustada según el criterio de Benzécri son\n\n```{r}\n#| label: Tabla-benzecriSali\n#| echo: false\n#| warning: false\n#| output: true\n\nkable(barplot_df[1:3,])\n```\n\n\n#### Contribución 1er eje\n\n```{r}\n#| label: contribacm1Sali\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acmSali, choice = \"var\", axes = 1) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\nEste eje está determinado por las variables de reintregación con la familia, amigos, continuar estudios y obtener empleo. Tal como fue visto, en el plano factorial anterior. \n\n#### Contribución 2do eje\n\n```{r}\n#| label: contribacm2 Sali\n#| echo: false\n#| output: true\ncontrib <- fviz_contrib(acmSali, choice = \"var\", axes = 2) +\n  theme(axis.text.x = element_text(size = 6, angle = 90, hjust = 1))\ncontrib<-contrib+theme(axis.text.x = element_text(size =4, angle = 90, hjust = 1))\n# Convierte el gráfico de ggplot a plotly\ncontrib_plotly <- ggplotly(contrib)\n\ncontrib_plotly\n```\n\nEste eje está compuesto por las categorías \"No aplica\" de las variables de reintegración con familia y amigos. Cabe resaltar que en este caso, \"No aplica\" no simboliza datos faltantes, si no a que la persona no considera tener amigos o familia a los cuales reintegrarse.\n:::\n\nA partir del análisis anterior, consideramos unicamente el 1 eje, ya que este concentra alrededor del 95% de la inercia ajustada por el criterio de Benzécri. \n\n\n# Leves Conclusiones\n\nA partir de los Análisis de Correspondencias Múltiples realizados, puede verse que las variables consideradas poseen una amplia cantidad de relaciones interesantes. No solo se observaron las correlaciones esperadas entre algunas variables, sino que también se encontraron relaciones que nos dan características particulares de la población privada de la libertad encuestada. \n\nLa mayoría de estas relaciones se dan entre variables que presentan una conexión conceptual clara, dichas conexiones (y agrupaciones) pueden encontrase directamente en el cuestionario utilizado por el INEGI, ya que estas agrupaciones consisten en cada una de las secciones del formulario.\n\nEn cuanto a nuestro objetivo principal, se observó que las variables con mayor relación respecto al número de personas por celda son aquellas variables categóricas relacionadas con las condiciones de vida en la celda y centro penitenciario. Esto sugiere que las condiciones de hacinamiento están más vinculadas a las características propias del centro penitenciario que a atributos y características individuales de las personas.\n\nEste hecho será analizado en mayor profundidad en las siguientes secciones mediante la aplicación de técnicas de agrupamiento de variables."},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"ACS.html"},"language":{"toc-title-document":"Tabla de contenidos","toc-title-website":"En esta página","related-formats-title":"Otros formatos","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Fuente","other-links-title":"Otros Enlaces","code-links-title":"Enlaces de código","launch-dev-container-title":"Iniciar Dev Container","launch-binder-title":"Iniciar Binder","article-notebook-label":"Cuaderno de Artículo","notebook-preview-download":"Descargar Cuaderno","notebook-preview-download-src":"Descargar código fuente","notebook-preview-back":"Volver al Artículo","manuscript-meca-bundle":"Archivo MECA","section-title-abstract":"Resumen","section-title-appendices":"Apéndices","section-title-footnotes":"Notas","section-title-references":"Referencias","section-title-reuse":"Reutilización","section-title-copyright":"Derechos de autor","section-title-citation":"Cómo citar","appendix-attribution-cite-as":"Por favor, cita este trabajo como:","appendix-attribution-bibtex":"BibTeX","title-block-author-single":"Autor/a","title-block-author-plural":"Autores/as","title-block-affiliation-single":"Afiliación","title-block-affiliation-plural":"Afiliaciones","title-block-published":"Fecha de publicación","title-block-modified":"Fecha de modificación","title-block-keywords":"Palabras clave","callout-tip-title":"Tip","callout-note-title":"Nota","callout-warning-title":"Advertencia","callout-important-title":"Importante","callout-caution-title":"Precaución","code-summary":"Código","code-tools-menu-caption":"Código","code-tools-show-all-code":"Mostrar todo el código","code-tools-hide-all-code":"Ocultar todo el código","code-tools-view-source":"Ver el código fuente","code-tools-source-code":"Ejecutar el código","tools-share":"Compartir","tools-download":"Descargar","code-line":"Línea","code-lines":"Líneas","copy-button-tooltip":"Copiar al portapapeles","copy-button-tooltip-success":"Copiado","repo-action-links-edit":"Editar esta página","repo-action-links-source":"Ver el código","repo-action-links-issue":"Informar de un problema","back-to-top":"Volver arriba","search-no-results-text":"Sin resultados","search-matching-documents-text":"documentos encontrados","search-copy-link-title":"Copiar el enlace en la búsqueda","search-hide-matches-text":"Ocultar resultados adicionales","search-more-match-text":"resultado adicional en este documento","search-more-matches-text":"resultados adicionales en este documento","search-clear-button-title":"Borrar","search-text-placeholder":"","search-detached-cancel-button-title":"Cancelar","search-submit-button-title":"Enviar","search-label":"Buscar","toggle-section":"Alternar sección","toggle-sidebar":"Alternar barra lateral","toggle-dark-mode":"Alternar modo oscuro","toggle-reader-mode":"Alternar modo lector","toggle-navigation":"Navegación de palanca","crossref-fig-title":"Figura","crossref-tbl-title":"Tabla","crossref-lst-title":"Listado","crossref-thm-title":"Teorema","crossref-lem-title":"Lema","crossref-cor-title":"Corolario","crossref-prp-title":"Proposición","crossref-cnj-title":"Conjetura","crossref-def-title":"Definición","crossref-exm-title":"Ejemplo","crossref-exr-title":"Ejercicio","crossref-ch-prefix":"Capítulo","crossref-apx-prefix":"Apéndice","crossref-sec-prefix":"Sección","crossref-eq-prefix":"Ecuación","crossref-lof-title":"Listado de Figuras","crossref-lot-title":"Listado de Tablas","crossref-lol-title":"Listado de Listados","environment-proof-title":"Prueba","environment-remark-title":"Observación","environment-solution-title":"Solución","listing-page-order-by":"Ordenar por","listing-page-order-by-default":"Por defecto","listing-page-order-by-date-asc":"Menos reciente","listing-page-order-by-date-desc":"Más reciente","listing-page-order-by-number-desc":"De mayor a menor","listing-page-order-by-number-asc":"De menor a mayor","listing-page-field-date":"Fecha","listing-page-field-title":"Título","listing-page-field-description":"Descripción","listing-page-field-author":"Autor/a","listing-page-field-filename":"Nombre de archivo","listing-page-field-filemodified":"Fecha de modificación","listing-page-field-subtitle":"Subtítulo","listing-page-field-readingtime":"Tiempo de lectura","listing-page-field-wordcount":"Conteo de Palabras","listing-page-field-categories":"Categorías","listing-page-minutes-compact":"{0} minutos","listing-page-category-all":"Todas","listing-page-no-matches":"No hay resultados","listing-page-words":"{0} palabras"},"metadata":{"lang":"es","fig-responsive":true,"quarto-version":"1.4.549","editor":"visual","theme":{"light":"simplex","dark":"slate"},"toc-expand":2,"toc-title":"Tabla de contenidos","toc-location":"right","title":"Análisis de Correspondencias Múltiples"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}