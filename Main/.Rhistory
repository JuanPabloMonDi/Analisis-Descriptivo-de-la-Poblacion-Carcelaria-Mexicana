#| fig-align: 'center'
#| fig-width: 5.5
#| fig-height: 5
#| echo: false
#fviz_mca_var_interactive(acmSali, axes=c(2,4), repel = TRUE,  ggtheme=theme_minimal())
fviz_mca_var_interactive(acmSali, axes=c(5,4), repel = TRUE,  ggtheme=theme_minimal())
fviz_mca_var_interactive(acmSali, axes=c(5,4), repel = TRUE,  ggtheme=theme_minimal().col.var = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"))
#| fig-cap: ''
#| fig-align: 'center'
#| fig-width: 5.5
#| fig-height: 5
#| echo: false
#fviz_mca_var_interactive(acmSali, axes=c(2,4), repel = TRUE,  ggtheme=theme_minimal())
fviz_mca_var_interactive(acmSali, axes=c(5,4), repel = TRUE,  ggtheme=theme_minimal(),col.var = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"))
screeplot <- fviz_screeplot(acmSali, addlabels = TRUE, ylim = c(0, 20)) +  ggtitle("Scree Plot") + theme_minimal()+ylab("Porcentaje de varianza explicada")+xlab("Ejes")
## Usando modif.rate() del paquete GDAtools:
# ptau <- modif.rate(acm)$modif[, 1]
## Haciendo las cuentas uno mismo:
s <- ncol(DatosCualisali)
l <- acmSali$eig[acmSali$eig[,1] > 1/s, 1]
tau <- ( s / (s - 1) )^2 * ( l - (1/s) )^2
ptau <- tau / sum( tau ) * 100
# Creamos un data frame para usar con ggplot2
barplot_df <- data.frame(Indice = factor(1:length(ptau)), Valor = ptau)
# Creamos el gráfico de barras con ggplot2
barplot_gg <- ggplot(barplot_df, aes(x = Indice, y = Valor)) +
geom_bar(stat = "identity", fill = "darkred") +
ylim(0, max(barplot_df$Valor+10)) +
labs(x = "Ejes", y = expression(tau(lambda))) +
theme_minimal() +
ggtitle("Criterio de Benzécri")
grid.arrange(screeplot, barplot_gg, ncol = 1)
#| fig-cap: ''
#| fig-align: 'center'
#| fig-width: 5.5
#| fig-height: 5
#| echo: false
#fviz_mca_var_interactive(acmSali, axes=c(2,4), repel = TRUE,  ggtheme=theme_minimal())
fviz_mca_var_interactive(acmSali, axes=c(1,2), repel = TRUE,  ggtheme=theme_minimal(),col.var = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"))
#| label: ACM Expectativas
#| message: false
#| echo: false
#| output: false
Var_cuali_sali<-c(
"SALIDA_VIVIENDA",
"SALIDA_EMPLEO",
"SALIDA_ESTUDIO",
"SALIDA_AMIGOS",
"SALIDA_FAMILIA",
"SALIDA_REINCORPORACION",
"CONSIDERO_SUICIDIO"
)
DatosCualisali<-Tabla1[,Var_cuali_sali]
acmSali <- MCA(DatosCualisali, graph=FALSE,level.ventil = 0.05)
#| fig-cap: ''
#| fig-align: 'center'
#| fig-width: 5.5
#| fig-height: 5
#| echo: false
#fviz_mca_var_interactive(acmSali, axes=c(2,4), repel = TRUE,  ggtheme=theme_minimal())
fviz_mca_var_interactive(acmSali, axes=c(1,2), repel = TRUE,  ggtheme=theme_minimal(),col.var = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"))
screeplot <- fviz_screeplot(acmSali, addlabels = TRUE, ylim = c(0, 20)) +  ggtitle("Scree Plot") + theme_minimal()+ylab("Porcentaje de varianza explicada")+xlab("Ejes")
## Usando modif.rate() del paquete GDAtools:
# ptau <- modif.rate(acm)$modif[, 1]
## Haciendo las cuentas uno mismo:
s <- ncol(DatosCualisali)
l <- acmSali$eig[acmSali$eig[,1] > 1/s, 1]
tau <- ( s / (s - 1) )^2 * ( l - (1/s) )^2
ptau <- tau / sum( tau ) * 100
# Creamos un data frame para usar con ggplot2
barplot_df <- data.frame(Indice = factor(1:length(ptau)), Valor = ptau)
# Creamos el gráfico de barras con ggplot2
barplot_gg <- ggplot(barplot_df, aes(x = Indice, y = Valor)) +
geom_bar(stat = "identity", fill = "darkred") +
ylim(0, max(barplot_df$Valor+10)) +
labs(x = "Ejes", y = expression(tau(lambda))) +
theme_minimal() +
ggtitle("Criterio de Benzécri")
grid.arrange(screeplot, barplot_gg, ncol = 1)
#| label: ACM Expectativas
#| message: false
#| echo: false
#| output: false
Var_cuali_sali<-c(
"SALIDA_VIVIENDA",
"SALIDA_EMPLEO",
"SALIDA_ESTUDIO",
"SALIDA_AMIGOS",
"SALIDA_FAMILIA",
"SALIDA_REINCORPORACION",
"CONSIDERO_SUICIDIO"
)
DatosCualisali<-Tabla1[,Var_cuali_sali]
acmSali <- MCA(DatosCualisali, graph=FALSE,level.ventil = 0.02)
#| fig-cap: ''
#| fig-align: 'center'
#| fig-width: 5.5
#| fig-height: 5
#| echo: false
#fviz_mca_var_interactive(acmSali, axes=c(2,4), repel = TRUE,  ggtheme=theme_minimal())
fviz_mca_var_interactive(acmSali, axes=c(1,2), repel = TRUE,  ggtheme=theme_minimal(),col.var = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"))
screeplot <- fviz_screeplot(acmSali, addlabels = TRUE, ylim = c(0, 20)) +  ggtitle("Scree Plot") + theme_minimal()+ylab("Porcentaje de varianza explicada")+xlab("Ejes")
## Usando modif.rate() del paquete GDAtools:
# ptau <- modif.rate(acm)$modif[, 1]
## Haciendo las cuentas uno mismo:
s <- ncol(DatosCualisali)
l <- acmSali$eig[acmSali$eig[,1] > 1/s, 1]
tau <- ( s / (s - 1) )^2 * ( l - (1/s) )^2
ptau <- tau / sum( tau ) * 100
# Creamos un data frame para usar con ggplot2
barplot_df <- data.frame(Indice = factor(1:length(ptau)), Valor = ptau)
# Creamos el gráfico de barras con ggplot2
barplot_gg <- ggplot(barplot_df, aes(x = Indice, y = Valor)) +
geom_bar(stat = "identity", fill = "darkred") +
ylim(0, max(barplot_df$Valor+10)) +
labs(x = "Ejes", y = expression(tau(lambda))) +
theme_minimal() +
ggtitle("Criterio de Benzécri")
grid.arrange(screeplot, barplot_gg, ncol = 1)
screeplot <- fviz_screeplot(acmSali, addlabels = TRUE, ylim = c(0, 20)) +  ggtitle("Scree Plot") + theme_minimal()+ylab("Porcentaje de varianza explicada")+xlab("Ejes")
## Usando modif.rate() del paquete GDAtools:
# ptau <- modif.rate(acm)$modif[, 1]
## Haciendo las cuentas uno mismo:
s <- ncol(DatosCualisali)
l <- acmSali$eig[acmSali$eig[,1] > 1/s, 1]
tau <- ( s / (s - 1) )^2 * ( l - (1/s) )^2
ptau <- tau / sum( tau ) * 100
# Creamos un data frame para usar con ggplot2
barplot_df <- data.frame(Indice = factor(1:length(ptau)), Valor = ptau)
# Creamos el gráfico de barras con ggplot2
barplot_gg <- ggplot(barplot_df, aes(x = Indice, y = Valor)) +
geom_bar(stat = "identity", fill = "darkred") +
ylim(0, max(barplot_df$Valor+20)) +
labs(x = "Ejes", y = expression(tau(lambda))) +
theme_minimal() +
ggtitle("Criterio de Benzécri")
grid.arrange(screeplot, barplot_gg, ncol = 1)
screeplot <- fviz_screeplot(acmSali, addlabels = TRUE, ylim = c(0, 30)) +  ggtitle("Scree Plot") + theme_minimal()+ylab("Porcentaje de varianza explicada")+xlab("Ejes")
## Usando modif.rate() del paquete GDAtools:
# ptau <- modif.rate(acm)$modif[, 1]
## Haciendo las cuentas uno mismo:
s <- ncol(DatosCualisali)
l <- acmSali$eig[acmSali$eig[,1] > 1/s, 1]
tau <- ( s / (s - 1) )^2 * ( l - (1/s) )^2
ptau <- tau / sum( tau ) * 100
# Creamos un data frame para usar con ggplot2
barplot_df <- data.frame(Indice = factor(1:length(ptau)), Valor = ptau)
# Creamos el gráfico de barras con ggplot2
barplot_gg <- ggplot(barplot_df, aes(x = Indice, y = Valor)) +
geom_bar(stat = "identity", fill = "darkred") +
ylim(0, max(barplot_df$Valor+10)) +
labs(x = "Ejes", y = expression(tau(lambda))) +
theme_minimal() +
ggtitle("Criterio de Benzécri")
grid.arrange(screeplot, barplot_gg, ncol = 1)
#| label: ACM Sociodemográficas
#| message: false
#| echo: false
#| output: false
Var_cuali_sociodemo<-c(
"CATEGORIAS_EDAD_CONSUMO_TABACO",
"CATEGORIAS_EDAD_CONSUMO_ALCOHOL",
"CATEGORIAS_EDAD_CONSUMO_MARIHUANA" ,
"CATEGORIAS_EDAD_CONSUMO_INHALABLES",
"CATEGORIAS_EDAD_CONSUMO_LSD",
"CATEGORIAS_EDAD_CONSUMO_HONGOS",
"CATEGORIAS_EDAD_CONSUMO_COCAINA",
"CATEGORIAS_EDAD_CONSUMO_CRACK",
"CATEGORIAS_EDAD_CONSUMO_HEROINA",
"CATEGORIAS_EDAD_CONSUMO_CHOCHOS",
"CATEGORIAS_EDAD_CONSUMO_TRANQUILIZANTES",
"CATEGORIAS_EDAD_CONSUMO_ANFETAMINAS",
#"COLOR_PIEL",
"VIVIO_MADRE_ADOLESCENCIA",
"VIVIO_PADRE_ADOLESCENCIA",
"SEXO",
#"NACION",
"EST_CIVIL",
"HIJOS",
"NIVEL_ESCOLARIDAD",
"PARO_ESTUDIOS"#,
#"IDENTI_GENERO",
#"ORIENT_SEXUAL",
#"CONSIDERO_SUICIDIO" ,
#"DISC_VISUAL",
#"DISC_AUDITIVA",
#"DISC_MOTRIZ"
)
DatosCualiSoc<-Tabla1[,Var_cuali_sociodemo]
acmSoc <- MCA(DatosCualiSoc, graph=FALSE,level.ventil = 0.01)
#| fig-cap: ''
#| fig-align: 'center'
#| fig-width: 5.5
#| fig-height: 5
#| echo: false
fviz_mca_var_interactive(acmSoc,col.var = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
axes=c(1,2), repel = TRUE,  ggtheme=theme_minimal())
#fviz_mca_var(acmSoc,col.var = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), axes=c(4,5), repel = TRUE,label="none",  ggtheme=theme_minimal())
#| label: ACM Sociodemográficas
#| message: false
#| echo: false
#| output: false
Var_cuali_sociodemo<-c(
"CATEGORIAS_EDAD_CONSUMO_TABACO",
"CATEGORIAS_EDAD_CONSUMO_ALCOHOL",
"CATEGORIAS_EDAD_CONSUMO_MARIHUANA" ,
"CATEGORIAS_EDAD_CONSUMO_INHALABLES",
"CATEGORIAS_EDAD_CONSUMO_LSD",
"CATEGORIAS_EDAD_CONSUMO_HONGOS",
"CATEGORIAS_EDAD_CONSUMO_COCAINA",
"CATEGORIAS_EDAD_CONSUMO_CRACK",
"CATEGORIAS_EDAD_CONSUMO_HEROINA",
"CATEGORIAS_EDAD_CONSUMO_CHOCHOS",
"CATEGORIAS_EDAD_CONSUMO_TRANQUILIZANTES",
"CATEGORIAS_EDAD_CONSUMO_ANFETAMINAS",
#"COLOR_PIEL",
"VIVIO_MADRE_ADOLESCENCIA",
"VIVIO_PADRE_ADOLESCENCIA",
"SEXO",
#"NACION",
"EST_CIVIL",
"HIJOS",
"NIVEL_ESCOLARIDAD",
"PARO_ESTUDIOS"#,
#"IDENTI_GENERO",
"ORIENT_SEXUAL",
#| label: ACM Sociodemográficas
#| message: false
#| echo: false
#| output: false
Var_cuali_sociodemo<-c(
"CATEGORIAS_EDAD_CONSUMO_TABACO",
"CATEGORIAS_EDAD_CONSUMO_ALCOHOL",
"CATEGORIAS_EDAD_CONSUMO_MARIHUANA" ,
"CATEGORIAS_EDAD_CONSUMO_INHALABLES",
"CATEGORIAS_EDAD_CONSUMO_LSD",
"CATEGORIAS_EDAD_CONSUMO_HONGOS",
"CATEGORIAS_EDAD_CONSUMO_COCAINA",
"CATEGORIAS_EDAD_CONSUMO_CRACK",
"CATEGORIAS_EDAD_CONSUMO_HEROINA",
"CATEGORIAS_EDAD_CONSUMO_CHOCHOS",
"CATEGORIAS_EDAD_CONSUMO_TRANQUILIZANTES",
"CATEGORIAS_EDAD_CONSUMO_ANFETAMINAS",
#"COLOR_PIEL",
"VIVIO_MADRE_ADOLESCENCIA",
"VIVIO_PADRE_ADOLESCENCIA",
"SEXO",
#"NACION",
"EST_CIVIL",
"HIJOS",
"NIVEL_ESCOLARIDAD",
"PARO_ESTUDIOS",
#"IDENTI_GENERO",
"ORIENT_SEXUAL",
"CONSIDERO_SUICIDIO" ,
#"DISC_VISUAL",
#"DISC_AUDITIVA",
#"DISC_MOTRIZ"
)
#| label: ACM Sociodemográficas
#| message: false
#| echo: false
#| output: false
Var_cuali_sociodemo<-c(
"CATEGORIAS_EDAD_CONSUMO_TABACO",
"CATEGORIAS_EDAD_CONSUMO_ALCOHOL",
"CATEGORIAS_EDAD_CONSUMO_MARIHUANA" ,
"CATEGORIAS_EDAD_CONSUMO_INHALABLES",
"CATEGORIAS_EDAD_CONSUMO_LSD",
"CATEGORIAS_EDAD_CONSUMO_HONGOS",
"CATEGORIAS_EDAD_CONSUMO_COCAINA",
"CATEGORIAS_EDAD_CONSUMO_CRACK",
"CATEGORIAS_EDAD_CONSUMO_HEROINA",
"CATEGORIAS_EDAD_CONSUMO_CHOCHOS",
"CATEGORIAS_EDAD_CONSUMO_TRANQUILIZANTES",
"CATEGORIAS_EDAD_CONSUMO_ANFETAMINAS",
#"COLOR_PIEL",
"VIVIO_MADRE_ADOLESCENCIA",
"VIVIO_PADRE_ADOLESCENCIA",
"SEXO",
#"NACION",
"EST_CIVIL",
"HIJOS",
"NIVEL_ESCOLARIDAD",
"PARO_ESTUDIOS",
#"IDENTI_GENERO",
"ORIENT_SEXUAL",
"CONSIDERO_SUICIDIO" #,
#"DISC_VISUAL",
#"DISC_AUDITIVA",
#"DISC_MOTRIZ"
)
DatosCualiSoc<-Tabla1[,Var_cuali_sociodemo]
acmSoc <- MCA(DatosCualiSoc, graph=FALSE,level.ventil = 0.01)
#| fig-cap: ''
#| fig-align: 'center'
#| fig-width: 5.5
#| fig-height: 5
#| echo: false
fviz_mca_var_interactive(acmSoc,col.var = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
axes=c(1,2), repel = TRUE,  ggtheme=theme_minimal())
#fviz_mca_var(acmSoc,col.var = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), axes=c(4,5), repel = TRUE,label="none",  ggtheme=theme_minimal())
screeplot <- fviz_screeplot(acmSoc, addlabels = TRUE, ylim = c(0, 20)) +  ggtitle("Scree Plot") + theme_minimal()+ylab("Porcentaje de varianza explicada")+xlab("Ejes")
## Usando modif.rate() del paquete GDAtools:
# ptau <- modif.rate(acm)$modif[, 1]
## Haciendo las cuentas uno mismo:
s <- ncol(DatosCualiSoc)
l <- acmSoc$eig[acmSoc$eig[,1] > 1/s, 1]
tau <- ( s / (s - 1) )^2 * ( l - (1/s) )^2
ptau <- tau / sum( tau ) * 100
# Creamos un data frame para usar con ggplot2
barplot_df <- data.frame(Indice = factor(1:length(ptau)), Valor = ptau)
# Creamos el gráfico de barras con ggplot2
barplot_gg <- ggplot(barplot_df, aes(x = Indice, y = Valor)) +
geom_bar(stat = "identity", fill = "darkred") +
ylim(0, max(barplot_df$Valor+10)) +
labs(x = "Ejes", y = expression(tau(lambda))) +
theme_minimal() +
ggtitle("Criterio de Benzécri")
grid.arrange(screeplot, barplot_gg, ncol = 1)
#| fig-cap: ''
#| fig-align: 'center'
#| fig-width: 5.5
#| fig-height: 5
#| echo: false
fviz_mca_var_interactive(acmSoc,col.var = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
axes=c(1,3), repel = TRUE,  ggtheme=theme_minimal())
#fviz_mca_var(acmSoc,col.var = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), axes=c(4,5), repel = TRUE,label="none",  ggtheme=theme_minimal())
#| label: ACM Sociodemográficas
#| message: false
#| echo: false
#| output: false
Var_cuali_sociodemo<-c(
"CATEGORIAS_EDAD_CONSUMO_TABACO",
"CATEGORIAS_EDAD_CONSUMO_ALCOHOL",
"CATEGORIAS_EDAD_CONSUMO_MARIHUANA" ,
#"CATEGORIAS_EDAD_CONSUMO_INHALABLES",
#"CATEGORIAS_EDAD_CONSUMO_LSD",
#"CATEGORIAS_EDAD_CONSUMO_HONGOS",
#"CATEGORIAS_EDAD_CONSUMO_COCAINA",
#"CATEGORIAS_EDAD_CONSUMO_CRACK",
#"CATEGORIAS_EDAD_CONSUMO_HEROINA",
#"CATEGORIAS_EDAD_CONSUMO_CHOCHOS",
#"CATEGORIAS_EDAD_CONSUMO_TRANQUILIZANTES",
#"CATEGORIAS_EDAD_CONSUMO_ANFETAMINAS",
#"COLOR_PIEL",
"VIVIO_MADRE_ADOLESCENCIA",
"VIVIO_PADRE_ADOLESCENCIA",
"SEXO",
#"NACION",
"EST_CIVIL",
"HIJOS",
"NIVEL_ESCOLARIDAD",
"PARO_ESTUDIOS",
#"IDENTI_GENERO",
"ORIENT_SEXUAL",
"CONSIDERO_SUICIDIO" #,
#"DISC_VISUAL",
#"DISC_AUDITIVA",
#"DISC_MOTRIZ"
)
DatosCualiSoc<-Tabla1[,Var_cuali_sociodemo]
acmSoc <- MCA(DatosCualiSoc, graph=FALSE,level.ventil = 0.01)
#| fig-cap: ''
#| fig-align: 'center'
#| fig-width: 5.5
#| fig-height: 5
#| echo: false
fviz_mca_var_interactive(acmSoc,col.var = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
axes=c(1,3), repel = TRUE,  ggtheme=theme_minimal())
#fviz_mca_var(acmSoc,col.var = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), axes=c(4,5), repel = TRUE,label="none",  ggtheme=theme_minimal())
#| fig-cap: ''
#| fig-align: 'center'
#| fig-width: 5.5
#| fig-height: 5
#| echo: false
fviz_mca_var_interactive(acmSoc,col.var = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
axes=c(1,2), repel = TRUE,  ggtheme=theme_minimal())
#fviz_mca_var(acmSoc,col.var = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), axes=c(4,5), repel = TRUE,label="none",  ggtheme=theme_minimal())
screeplot <- fviz_screeplot(acmSoc, addlabels = TRUE, ylim = c(0, 20)) +  ggtitle("Scree Plot") + theme_minimal()+ylab("Porcentaje de varianza explicada")+xlab("Ejes")
## Usando modif.rate() del paquete GDAtools:
# ptau <- modif.rate(acm)$modif[, 1]
## Haciendo las cuentas uno mismo:
s <- ncol(DatosCualiSoc)
l <- acmSoc$eig[acmSoc$eig[,1] > 1/s, 1]
tau <- ( s / (s - 1) )^2 * ( l - (1/s) )^2
ptau <- tau / sum( tau ) * 100
# Creamos un data frame para usar con ggplot2
barplot_df <- data.frame(Indice = factor(1:length(ptau)), Valor = ptau)
# Creamos el gráfico de barras con ggplot2
barplot_gg <- ggplot(barplot_df, aes(x = Indice, y = Valor)) +
geom_bar(stat = "identity", fill = "darkred") +
ylim(0, max(barplot_df$Valor+10)) +
labs(x = "Ejes", y = expression(tau(lambda))) +
theme_minimal() +
ggtitle("Criterio de Benzécri")
grid.arrange(screeplot, barplot_gg, ncol = 1)
#| fig-cap: ''
#| fig-align: 'center'
#| fig-width: 5.5
#| fig-height: 5
#| echo: false
fviz_mca_var_interactive(acmSoc,col.var = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
axes=c(2,3), repel = TRUE,  ggtheme=theme_minimal())
#fviz_mca_var(acmSoc,col.var = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), axes=c(4,5), repel = TRUE,label="none",  ggtheme=theme_minimal())
#| label: ACM Sociodemográficas
#| message: false
#| echo: false
#| output: false
Var_cuali_sociodemo<-c(
"CATEGORIAS_EDAD_CONSUMO_TABACO",
"CATEGORIAS_EDAD_CONSUMO_ALCOHOL",
"CATEGORIAS_EDAD_CONSUMO_MARIHUANA" ,
#"CATEGORIAS_EDAD_CONSUMO_INHALABLES",
#"CATEGORIAS_EDAD_CONSUMO_LSD",
#"CATEGORIAS_EDAD_CONSUMO_HONGOS",
#"CATEGORIAS_EDAD_CONSUMO_COCAINA",
#"CATEGORIAS_EDAD_CONSUMO_CRACK",
#"CATEGORIAS_EDAD_CONSUMO_HEROINA",
#"CATEGORIAS_EDAD_CONSUMO_CHOCHOS",
#"CATEGORIAS_EDAD_CONSUMO_TRANQUILIZANTES",
#"CATEGORIAS_EDAD_CONSUMO_ANFETAMINAS",
#"COLOR_PIEL",
"VIVIO_MADRE_ADOLESCENCIA",
"VIVIO_PADRE_ADOLESCENCIA",
"SEXO",
#"NACION",
"EST_CIVIL",
"HIJOS",
#"NIVEL_ESCOLARIDAD",
"PARO_ESTUDIOS",
#"IDENTI_GENERO",
"ORIENT_SEXUAL",
"CONSIDERO_SUICIDIO" #,
#"DISC_VISUAL",
#"DISC_AUDITIVA",
#"DISC_MOTRIZ"
)
DatosCualiSoc<-Tabla1[,Var_cuali_sociodemo]
acmSoc <- MCA(DatosCualiSoc, graph=FALSE,level.ventil = 0.01)
#| fig-cap: ''
#| fig-align: 'center'
#| fig-width: 5.5
#| fig-height: 5
#| echo: false
fviz_mca_var_interactive(acmSoc,col.var = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
axes=c(2,3), repel = TRUE,  ggtheme=theme_minimal())
#fviz_mca_var(acmSoc,col.var = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), axes=c(4,5), repel = TRUE,label="none",  ggtheme=theme_minimal())
screeplot <- fviz_screeplot(acmSoc, addlabels = TRUE, ylim = c(0, 20)) +  ggtitle("Scree Plot") + theme_minimal()+ylab("Porcentaje de varianza explicada")+xlab("Ejes")
## Usando modif.rate() del paquete GDAtools:
# ptau <- modif.rate(acm)$modif[, 1]
## Haciendo las cuentas uno mismo:
s <- ncol(DatosCualiSoc)
l <- acmSoc$eig[acmSoc$eig[,1] > 1/s, 1]
tau <- ( s / (s - 1) )^2 * ( l - (1/s) )^2
ptau <- tau / sum( tau ) * 100
# Creamos un data frame para usar con ggplot2
barplot_df <- data.frame(Indice = factor(1:length(ptau)), Valor = ptau)
# Creamos el gráfico de barras con ggplot2
barplot_gg <- ggplot(barplot_df, aes(x = Indice, y = Valor)) +
geom_bar(stat = "identity", fill = "darkred") +
ylim(0, max(barplot_df$Valor+10)) +
labs(x = "Ejes", y = expression(tau(lambda))) +
theme_minimal() +
ggtitle("Criterio de Benzécri")
grid.arrange(screeplot, barplot_gg, ncol = 1)
#| fig-cap: ''
#| fig-align: 'center'
#| fig-width: 5.5
#| fig-height: 5
#| echo: false
fviz_mca_var_interactive(acmSoc,col.var = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
axes=c(1,2), repel = TRUE,  ggtheme=theme_minimal())
#fviz_mca_var(acmSoc,col.var = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), axes=c(4,5), repel = TRUE,label="none",  ggtheme=theme_minimal())
#| label: contribucion-correlacion-ventil
#| echo: false
#| warning: false
#| output: true
# Crear el gráfico ggplot
gg <- ggplot(data = acm_ventil$var$eta2, aes(x = !!sym("Dim 1"), y = !!sym("Dim 2"), label = rownames(acm_ventil$var$eta2), text = rownames(acm_ventil$var$eta2))) +
geom_point(size=0.75,shape=75,colour="blue3") +  # Añadir los puntos
geom_text_repel(aes(label = rownames(acm_ventil$var$eta2)), size = 3) +  # Añadir las etiquetas
theme_minimal() +  # Aplicar un tema minimalista
labs(title = "MCA Ventil - Correlación de variables",
x = "Dim 1", y = "Dim 2")  # Añadir títulos y
# Convertir el gráfico ggplot a plotly y mostrar el nombre de la variable al pasar el mouse
ggplotly(gg, tooltip = "text")
#| label: contribucion-correlacion2-ventil
#| echo: false
#| warning: false
#| output: true
# Crear el gráfico ggplot
gg <- ggplot(data = acm_ventil$var$eta2, aes(x = !!sym("Dim 2"), y = !!sym("Dim 3"), label = rownames(acm_ventil$var$eta2), text = rownames(acm_ventil$var$eta2))) +
geom_point(size=0.75,shape=75,colour="blue3") +  # Añadir los puntos
geom_text_repel(aes(label = rownames(acm_ventil$var$eta2)), size = 3) +  # Añadir las etiquetas
theme_minimal() +  # Aplicar un tema minimalista
labs(title = "MCA Ventil - Correlación de variables",
x = "Dim 2", y = "Dim 3")  # Añadir títulos y etiquetas
# Convertir el gráfico ggplot a plotly y mostrar el nombre de la variable al pasar el mouse
ggplotly(gg, tooltip = "text")
#| label: contribucion-correlacion3_ventil
#| echo: false
#| warning: false
#| output: true
gg <- ggplot(data = acm_ventil$var$eta2, aes(x = !!sym("Dim 1"), y = !!sym("Dim 3"), label = rownames(acm_ventil$var$eta2), text = rownames(acm_ventil$var$eta2))) +
geom_point(size=0.75,shape=75,colour="blue3") +  # Añadir los puntos
geom_text_repel(aes(label = rownames(acm_ventil$var$eta2)), size = 3) +  # Añadir las etiquetas
theme_minimal() +  # Aplicar un tema minimalista
labs(title = "MCA Ventil - Correlación de variables",
x = "Dim 1", y = "Dim 3")  # Añadir títulos y
# Convertir el gráfico ggplot a plotly y mostrar el nombre de la variable al pasar el mouse
ggplotly(gg, tooltip = "text")
