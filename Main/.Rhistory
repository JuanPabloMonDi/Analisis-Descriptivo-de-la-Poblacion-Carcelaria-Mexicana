xlim = c(min(sup$coor[260:263,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
#s.arrow(acp$co, add.plot = TRUE, boxes = F)
points(sup$coor[260:263,], col = 6, pch = 16)
text(sup$coor[260:263,], labels = rownames(sup$coor[260:263,]),
col = 6, pos = 1, font = 3, srt=-45)
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
xlim = c(min(sup$coor[311:315,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
#s.arrow(acp$co, add.plot = TRUE, boxes = F)
points(sup$coor[311:315,], col = 6, pch = 16)
text(sup$coor[311:315,], labels = rownames(sup$coor[311:315,]),
col = 6, pos = 1, font = 3, srt=-45)
sup
View(sup)
sup$coor
acp$l1[,2]
plot(acp$li[, 2], acp$li[, 3], Tcol = FALSE, ucal = 100, cex.row = 0,
xlim = c(min(sup$coor[311:315,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
#s.arrow(acp$co, add.plot = TRUE, boxes = F)
points(sup$coor[311:315,], col = 6, pch = 16)
text(sup$coor[311:315,], labels = rownames(sup$coor[311:315,]),
col = 6, pos = 1, font = 3, srt=-45)
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
xlim = c(min(sup$coor[311:315,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
#s.arrow(acp$co, add.plot = TRUE, boxes = F)
points(sup$coor[311:315,], col = 6, pch = 16)
text(sup$coor[311:315,], labels = rownames(sup$coor[311:315,]),
col = 6, pos = 1, font = 3, srt=-45)
length(varCuantitativas)
#| label: Seleccion-variables
#| echo: false
#| warning: false
#| output: false
#http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/#r-packages
#Escogemos las variables cuantitativas
varCuantitativas<-c("EDAD","EDAD_ESCOLARIDAD","NUM_HIJOS","EDAD_CONSUMO_TABACO","EDAD_CONSUMO_ALCOHOL","EDAD_CONSUMO_MARIHUANA","EDAD_CONSUMO_INHALABLES","EDAD_CONSUMO_LSD","EDAD_CONSUMO_HONGOS","EDAD_CONSUMO_COCAINA","EDAD_CONSUMO_PASTA_COCAINA","EDAD_CONSUMO_CRACK","EDAD_CONSUMO_HEROINA","EDAD_CONSUMO_CHOCHOS","EDAD_CONSUMO_TRANQUILIZANTES","EDAD_CONSUMO_ANFETAMINAS","N_PERSONAS_DEPENDIENTES","DINERO_SOBORNO","DELITOS_ABIERTOS","TIEMPO_RECLUIDO","TIEMPO_PROCESO","CANTIDAD_PERSONAS_CELDA","CELDA_HORAS","VECES_SENTENCIADO")
varCualitativas<-setdiff(colnames(Tabla1),c("ID_PER","NOM_ENT",varCuantitativas))
DatosCuantitativos<-Tabla1[,varCuantitativas]
DatosCualitativos<-Tabla1[,varCualitativas]
correlaciones<-cor(DatosCuantitativos)
length(varCuantitativas)
#| title: ACP de las variables cuantitativas
#| echo: False
#| output: True
res.pca2<-FactoMineR:: PCA(DatosCuantitativos2, scale.unit = TRUE, ncp = 20, graph = FALSE)
acp2 <- dudi.pca(DatosCuantitativos2, scannf = FALSE, nf = 5)
# El parámetro nf indica cuantos ejes voy a conservar
valp <- t(inertia(acp2)$tot.inertia) # valores propios
kable(valp, digits = 3)
#| title: Varianza explicada
#| label: varianza ACP2
#| echo: false
fviz_eig(res.pca2,addlabels=T,ylim=c(0,20),ylab = "Porcentaje de varianza explicada",xlab="Eje",main="")
#| label: Valores propios2
#| echo: false
#par(mar = c(2.5, 1, 1, 1.5) + 0.1)
vline <- function(x = 0, color = "green") {
list(
type = "line",
y0 = 0,
y1 = 1,
yref = "paper",
x0 = x,
x1 = x,
line = list(color = color, dash="dot")
)
}
# histograma de valores propios
plot_ly(y=1:length(acp2$eig),x=acp2$eig,type="bar",orientation="h")%>%layout(plot_bgcolor = "#e5ecf6", shapes = list(vline(1), list(type = "rect",
fillcolor = "red", opacity = 0.2,
x0 = 0.8, x1 = max(acp2$eig)+0.2, y0 = -0.5, y1 = 14)))
#| title: ACP2 Ejes 1-2
#| echo: false
plot.PCA(res.pca2,choix='var',habillage = 'contrib',cex=0.6,cex.main=0.9,cex.axis=0.9,axes = c(1,2))
#fviz_pca_var(res.pca2,axes=c(1,2), col.var = "contrib", gradient.cols = c("#FFFFFF","#E7B800","#08306B"))
setwd("~/GitHub/Analisis-Descriptivo-de-la-Poblacion-Carcelaria-Mexicana/Main")
fviz_cos2(res.pca2, choice = "var", axes = 1)
#| label: a2
#| echo: false
fviz_cos2(res.pca2, choice = "var", axes = 2)
#| label: a3
#| echo: false
fviz_cos2(res.pca2, choice = "var", axes = 3)
#| label: a4
#| echo: false
fviz_cos2(res.pca2, choice = "var", axes = 4)
#| title: ACP2 Ejes 1-2
#| echo: false
plot.PCA(res.pca2,choix='var',habillage = 'contrib',cex=0.6,cex.main=0.9,cex.axis=0.9,axes = c(1,2))
#fviz_pca_var(res.pca2,axes=c(1,2), col.var = "contrib", gradient.cols = c("#FFFFFF","#E7B800","#08306B"))
#| title: ACP2 Ejes 2-3
#| echo: false
plot.PCA(res.pca2,choix='var',habillage = 'contrib',cex=0.6,cex.main=0.9,cex.axis=0.9,axes = c(2,3))
#fviz_pca_var(res.pca2,axes=c(2,3), col.var = "contrib",
#gradient.cols =c("#FFFFFF","#E7B800","#08306B")
#)
#| title: ACP 2 Ejes 1-3
#| echo: false
plot.PCA(res.pca2,choix='var',habillage = 'contrib',cex=0.6,cex.main=0.9,cex.axis=0.9,axes = c(1,3))
#fviz_pca_var(res.pca2,axes=c(1,3),col.var = "contrib",gradient.cols = c("#FFFFFF", "#E7B800","#08306B"))
plot.PCA(res.pca2,choix='var',habillage = 'contrib',cex=0.6,cex.main=0.9,cex.axis=0.9,axes = c(1,2))
#| label: Seleccion-variables2
#| echo: false
#| warning: false
#| output: false
#http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/#r-packages
#Escogemos las variables cuantitativas
varCuantitativas2<-c("EDAD","NUM_HIJOS","N_PERSONAS_DEPENDIENTES","DINERO_SOBORNO","DELITOS_ABIERTOS","TIEMPO_RECLUIDO","TIEMPO_PROCESO","CANTIDAD_PERSONAS_CELDA","CELDA_HORAS","VECES_SENTENCIADO")
DatosCuantitativos2<-Tabla1[,varCuantitativas2]
DatosCualitativos2<-Tabla1[,varCualitativas]
#| title: ACP de las variables cuantitativas
#| echo: False
#| output: True
res.pca2<-FactoMineR:: PCA(DatosCuantitativos2, scale.unit = TRUE, ncp = 20, graph = FALSE)
acp2 <- dudi.pca(DatosCuantitativos2, scannf = FALSE, nf = 5)
# El parámetro nf indica cuantos ejes voy a conservar
valp <- t(inertia(acp2)$tot.inertia) # valores propios
kable(valp, digits = 3)
#| title: Varianza explicada
#| label: varianza ACP2
#| echo: false
fviz_eig(res.pca2,addlabels=T,ylim=c(0,20),ylab = "Porcentaje de varianza explicada",xlab="Eje",main="")
#| label: Valores propios2
#| echo: false
#par(mar = c(2.5, 1, 1, 1.5) + 0.1)
vline <- function(x = 0, color = "green") {
list(
type = "line",
y0 = 0,
y1 = 1,
yref = "paper",
x0 = x,
x1 = x,
line = list(color = color, dash="dot")
)
}
# histograma de valores propios
plot_ly(y=1:length(acp2$eig),x=acp2$eig,type="bar",orientation="h")%>%layout(plot_bgcolor = "#e5ecf6", shapes = list(vline(1), list(type = "rect",
fillcolor = "red", opacity = 0.2,
x0 = 0.8, x1 = max(acp2$eig)+0.2, y0 = -0.5, y1 = 14)))
#| label: a1
#| echo: false
fviz_cos2(res.pca2, choice = "var", axes = 1)
#| label: a2
#| echo: false
fviz_cos2(res.pca2, choice = "var", axes = 2)
#| label: a3
#| echo: false
fviz_cos2(res.pca2, choice = "var", axes = 3)
#| label: a4
#| echo: false
fviz_cos2(res.pca2, choice = "var", axes = 4)
#| title: ACP2 Ejes 1-2
#| echo: false
plot.PCA(res.pca2,choix='var',habillage = 'contrib',cex=0.6,cex.main=0.9,cex.axis=0.9,axes = c(1,2))
#fviz_pca_var(res.pca2,axes=c(1,2), col.var = "contrib", gradient.cols = c("#FFFFFF","#E7B800","#08306B"))
#| title: ACP2 Ejes 2-3
#| echo: false
plot.PCA(res.pca2,choix='var',habillage = 'contrib',cex=0.6,cex.main=0.9,cex.axis=0.9,axes = c(2,3))
#fviz_pca_var(res.pca2,axes=c(2,3), col.var = "contrib",
#gradient.cols =c("#FFFFFF","#E7B800","#08306B")
#)
#| title: ACP 2 Ejes 1-3
#| echo: false
plot.PCA(res.pca2,choix='var',habillage = 'contrib',cex=0.6,cex.main=0.9,cex.axis=0.9,axes = c(1,3))
#fviz_pca_var(res.pca2,axes=c(1,3),col.var = "contrib",gradient.cols = c("#FFFFFF", "#E7B800","#08306B"))
#| title: ACP 2 Ejes 1-3
#| echo: false
plot.PCA(res.pca2,choix='var',habillage = 'contrib',cex=0.6,cex.main=0.9,cex.axis=0.9,axes = c(1,3))
#fviz_pca_var(res.pca2,axes=c(1,3),col.var = "contrib",gradient.cols = c("#FFFFFF", "#E7B800","#08306B"))
#| label: individuos12 ACP2
#| echo: false
plot.PCA(res.pca2, habillage='EDAD', label = "none",axes = c(1,2))
#fviz_pca_ind(res.pca2,geom="point",axes=c(1,2))
plot.PCA(res.pca2, habillage='EDAD', label = "none",axes = c(1,2))
#| label: individuos23 ACP2
#| echo: false
plot.PCA(res.pca2, habillage='EDAD', label = "none",axes=c(2,3))
#fviz_pca_ind(res.pca2,geom="point",axes=c(2,3))
plot.PCA(res.pca2, habillage='NUM_HIJOS', label = "none",axes=c(2,3))
#| label: individuos13 ACP2
#| echo: false
plot.PCA(res.pca2, habillage='EDAD', label = "none",axes = c(1,3))
#fviz_pca_ind(res.pca2,geom="point",axes=c(1,3))
plot.PCA(res.pca2, habillage='EDAD', label = "none",axes = c(1,3))
#| label: Seleccion-variables3
#| echo: false
#| warning: false
#| output: false
#http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/#r-packages
#Escogemos las variables cuantitativas
varCuantitativas3<-varCuantitativas<-c("EDAD","EDAD_ESCOLARIDAD","EDAD_CONSUMO_TABACO","EDAD_CONSUMO_ALCOHOL","EDAD_CONSUMO_MARIHUANA","EDAD_CONSUMO_INHALABLES","EDAD_CONSUMO_LSD","EDAD_CONSUMO_HONGOS","EDAD_CONSUMO_COCAINA","EDAD_CONSUMO_PASTA_COCAINA","EDAD_CONSUMO_CRACK","EDAD_CONSUMO_HEROINA","EDAD_CONSUMO_CHOCHOS","EDAD_CONSUMO_TRANQUILIZANTES","EDAD_CONSUMO_ANFETAMINAS")
DatosCuantitativos3<-Tabla1[,varCuantitativas3]
#| title: ACP de las variables de sustancias
#| echo: False
#| output: True
res.pca3<-FactoMineR:: PCA(DatosCuantitativos3, scale.unit = TRUE, ncp = 20, graph = FALSE)
acp3 <- dudi.pca(DatosCuantitativos3, scannf = FALSE, nf = 5)
# El parámetro nf indica cuantos ejes voy a conservar
valp <- t(inertia(acp2)$tot.inertia) # valores propios
kable(valp, digits = 3)
#| label: varianza ACP3
fviz_eig(res.pca3,addlabels=T,ylim=c(0,20),ylab = "Porcentaje de varianza explicada",xlab="Eje",main="")
#| label: Valores propios3
#| echo: false
#par(mar = c(2.5, 1, 1, 1.5) + 0.1)
vline <- function(x = 0, color = "green") {
list(
type = "line",
y0 = 0,
y1 = 1,
yref = "paper",
x0 = x,
x1 = x,
line = list(color = color, dash="dot")
)
}
# histograma de valores propios
plot_ly(y=1:length(acp3$eig),x=acp3$eig,type="bar",orientation="h")%>%layout(plot_bgcolor = "#e5ecf6", shapes = list(vline(1), list(type = "rect",
fillcolor = "red", opacity = 0.2,
x0 = 0.8, x1 = max(acp3$eig)+0.2, y0 = -0.5, y1 = 17)))
#| title: ACP3 Ejes 1-2
#| echo: false
plot.PCA(res.pca3,choix='var',habillage = 'contrib',cex=0.6,cex.main=0.9,cex.axis=0.9,axes = c(1,2))
#fviz_pca_var(res.pca2,axes=c(1,2), col.var = "contrib", gradient.cols = c("#FFFFFF","#E7B800","#08306B"))
#| title: ACP3 Ejes 2-3
#| echo: false
plot.PCA(res.pca3,choix='var',habillage = 'contrib',cex=0.6,cex.main=0.9,cex.axis=0.9,axes = c(2,3))
#fviz_pca_var(res.pca2,axes=c(2,3), col.var = "contrib",
#gradient.cols =c("#FFFFFF","#E7B800","#08306B")
#)
#| label: Seleccion-variables3
#| echo: false
#| warning: false
#| output: false
#http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/#r-packages
#Escogemos las variables cuantitativas
varCuantitativas3<-varCuantitativas<-c("EDAD",,"EDAD_CONSUMO_TABACO","EDAD_CONSUMO_ALCOHOL","EDAD_CONSUMO_MARIHUANA","EDAD_CONSUMO_INHALABLES","EDAD_CONSUMO_LSD","EDAD_CONSUMO_HONGOS","EDAD_CONSUMO_COCAINA","EDAD_CONSUMO_PASTA_COCAINA","EDAD_CONSUMO_CRACK","EDAD_CONSUMO_HEROINA","EDAD_CONSUMO_CHOCHOS","EDAD_CONSUMO_TRANQUILIZANTES","EDAD_CONSUMO_ANFETAMINAS")
#| label: Seleccion-variables3
#| echo: false
#| warning: false
#| output: false
#http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/#r-packages
#Escogemos las variables cuantitativas
varCuantitativas3<-varCuantitativas<-c("EDAD","EDAD_CONSUMO_TABACO","EDAD_CONSUMO_ALCOHOL","EDAD_CONSUMO_MARIHUANA","EDAD_CONSUMO_INHALABLES","EDAD_CONSUMO_LSD","EDAD_CONSUMO_HONGOS","EDAD_CONSUMO_COCAINA","EDAD_CONSUMO_PASTA_COCAINA","EDAD_CONSUMO_CRACK","EDAD_CONSUMO_HEROINA","EDAD_CONSUMO_CHOCHOS","EDAD_CONSUMO_TRANQUILIZANTES","EDAD_CONSUMO_ANFETAMINAS")
DatosCuantitativos3<-Tabla1[,varCuantitativas3]
#| title: ACP de las variables de sustancias
#| echo: False
#| output: True
res.pca3<-FactoMineR:: PCA(DatosCuantitativos3, scale.unit = TRUE, ncp = 20, graph = FALSE)
acp3 <- dudi.pca(DatosCuantitativos3, scannf = FALSE, nf = 5)
# El parámetro nf indica cuantos ejes voy a conservar
valp <- t(inertia(acp2)$tot.inertia) # valores propios
kable(valp, digits = 3)
#| label: Valores propios3
#| echo: false
#par(mar = c(2.5, 1, 1, 1.5) + 0.1)
vline <- function(x = 0, color = "green") {
list(
type = "line",
y0 = 0,
y1 = 1,
yref = "paper",
x0 = x,
x1 = x,
line = list(color = color, dash="dot")
)
}
# histograma de valores propios
plot_ly(y=1:length(acp3$eig),x=acp3$eig,type="bar",orientation="h")%>%layout(plot_bgcolor = "#e5ecf6", shapes = list(vline(1), list(type = "rect",
fillcolor = "red", opacity = 0.2,
x0 = 0.8, x1 = max(acp3$eig)+0.2, y0 = -0.5, y1 = 17)))
fviz_cos2(res.pca3, choice = "var", axes = 2)
fviz_cos2(res.pca3, choice = "var", axes = 1)
fviz_cos2(res.pca3, choice = "var", axes = 3)
fviz_cos2(res.pca3, choice = "var", axes = 4)
#| title: ACP2 Ejes 1-2
#| echo: false
plot.PCA(res.pca2,choix='var',habillage = 'contrib',cex=0.6,cex.main=0.9,cex.axis=0.9,axes = c(1,2))
#fviz_pca_var(res.pca2,axes=c(1,2), col.var = "contrib", gradient.cols = c("#FFFFFF","#E7B800","#08306B"))
plot.PCA(res.pca2,choix='var',habillage = 'contrib',cex=0.6,cex.main=0.9,cex.axis=0.9,axes = c(1,2))
#| title: ACP2 Ejes 1-2
#| echo: false
plot.PCA(res.pca2,choix='var',habillage = 'contrib',cex=0.6,cex.main=0.9,cex.axis=0.9,axes = c(1,2))
#fviz_pca_var(res.pca2,axes=c(1,2), col.var = "contrib", gradient.cols = c("#FFFFFF","#E7B800","#08306B"))
plot.PCA(res.pca2,choix='var',habillage = 'contrib',cex=0.6,cex.main=0.9,cex.axis=0.9,axes = c(1,2))
plot.PCA(res.pca3,choix='var',habillage = 'contrib',cex=0.6,cex.main=0.9,cex.axis=0.9,axes = c(1,2))
#| title: ACP3 Ejes 2-3
#| echo: false
plot.PCA(res.pca3,choix='var',habillage = 'contrib',cex=0.6,cex.main=0.9,cex.axis=0.9,axes = c(2,3))
#fviz_pca_var(res.pca2,axes=c(2,3), col.var = "contrib",
#gradient.cols =c("#FFFFFF","#E7B800","#08306B")
#)
plot.PCA(res.pca3,choix='var',habillage = 'contrib',cex=0.6,cex.main=0.9,cex.axis=0.9,axes = c(2,3))
#| label: individuos12 ACP3
#| echo: false
plot.PCA(res.pca3, habillage='EDAD', label = "none",axes = c(1,2))
#fviz_pca_ind(res.pca2,geom="point",axes=c(1,2))
plot.PCA(res.pca3, habillage='EDAD', label = "none",axes = c(1,2))
plot.PCA(res.pca3, habillage='EDAD', label = "none",axes=c(2,3))
plot.PCA(res.pca3, habillage='EDAD', label = "none",axes = c(1,3))
#| label: carga-librerias
#| message: false
#| echo: true
#| output: false
#Manejo de datos
library(tidyverse)
library(readr)
library(dplyr)
library(readxl)
#Gráficos
library(ggplot2)
library(plotly)
library(GGally)
#ACP
library(ade4)
library(FactoClass)
library(FactoMineR)
library(factoextra)
#Datos importados
source("DatosSeleccionados.R")
#Ajustes de tema del documento y graficos
library(scales)
library(DT)
library(gt)
library(RColorBrewer)
theme_set(theme_minimal(base_size = 24, base_family = "Atkinson Hyperlegible"))
library(hrbrthemes)
#| label: Seleccion-variables
#| echo: false
#| warning: false
#| output: false
#http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/#r-packages
#Escogemos las variables cuantitativas
varCuantitativas<-c("EDAD","EDAD_ESCOLARIDAD","NUM_HIJOS","EDAD_CONSUMO_TABACO","EDAD_CONSUMO_ALCOHOL","EDAD_CONSUMO_MARIHUANA","EDAD_CONSUMO_INHALABLES","EDAD_CONSUMO_LSD","EDAD_CONSUMO_HONGOS","EDAD_CONSUMO_COCAINA","EDAD_CONSUMO_PASTA_COCAINA","EDAD_CONSUMO_CRACK","EDAD_CONSUMO_HEROINA","EDAD_CONSUMO_CHOCHOS","EDAD_CONSUMO_TRANQUILIZANTES","EDAD_CONSUMO_ANFETAMINAS","N_PERSONAS_DEPENDIENTES","DINERO_SOBORNO","DELITOS_ABIERTOS","TIEMPO_RECLUIDO","TIEMPO_PROCESO","CANTIDAD_PERSONAS_CELDA","CELDA_HORAS","VECES_SENTENCIADO")
varCualitativas<-setdiff(colnames(Tabla1),c("ID_PER","NOM_ENT",varCuantitativas))
DatosCuantitativos<-Tabla1[,varCuantitativas]
DatosCualitativos<-Tabla1[,varCualitativas]
correlaciones<-cor(DatosCuantitativos)
#| title: ACP de las variables cuantitativas
#| echo: True
#| output: True
res.pca<-FactoMineR:: PCA(DatosCuantitativos, scale.unit = TRUE, ncp = 20, graph = FALSE)
acp <- dudi.pca(DatosCuantitativos, scannf = FALSE, nf = 5)
# El parámetro nf indica cuantos ejes voy a conservar
valp <- t(inertia(acp)$tot.inertia) # valores propios
kable(valp, digits = 3)
#| title: Primer eje
#| echo: false
fviz_cos2(res.pca, choice = "var", axes = 1)
#| title: Cuarto eje
#| echo: false
fviz_cos2(res.pca, choice = "var", axes = 4)
#| title: Quinto eje
#| echo: false
fviz_cos2(res.pca, choice = "var", axes = 5)
#| title: Sexto eje
#| echo: false
fviz_cos2(res.pca,choice="var",axes=6)
#| title: Sexto eje
#| echo: false
fviz_contrib(res.pca,top=5,choice="var",axes=6)
#| title: Ejes 1-2
#| echo: false
plot.PCA(res.pca,choix='var',habillage = 'contrib',cex=0.6,cex.main=0.9,cex.axis=0.9,axes = c(1,2))
#fviz_pca_var(res.pca,axes=c(1,2), col.var = "contrib",gradient.cols = c("#FFFFFF", "#E7B800","#08306B"))
plot.PCA(res.pca,choix='var',habillage = 'contrib',cex=0.6,cex.main=0.9,cex.axis=0.9,axes = c(1,6))
plot.PCA(res.pca,choix='var',habillage = 'contrib',cex=0.6,cex.main=0.9,cex.axis=0.9,axes = c(2,6))
plot.PCA(res.pca,choix='var',habillage = 'contrib',cex=0.6,cex.main=0.9,cex.axis=0.9,axes = c(3,6))
plot.PCA(res.pca,choix='var',habillage = 'contrib',cex=0.6,cex.main=0.9,cex.axis=0.9,axes = c(4,6))
plot.PCA(res.pca,choix='var',habillage = 'contrib',cex=0.6,cex.main=0.9,cex.axis=0.9,axes = c(5,6))
plot.PCA(res.pca,choix='var',habillage = 'contrib',cex=0.6,cex.main=0.9,cex.axis=0.9,axes = c(7,6))
fviz_pca_ind(res.pca,col.ind="cos2",geom="point",axes=c(1,6)) +
scale_color_gradient2(low="blue", mid="white",
high="red", midpoint=0.50)+
theme_minimal()
fviz_pca_ind(res.pca,col.ind="cos2",geom="point",axes=c(2,6)) +
scale_color_gradient2(low="blue", mid="white",
high="red", midpoint=0.50)+
theme_minimal()
fviz_pca_ind(res.pca,
geom.ind = "point", # show points only (nbut not "text")
col.ind = Tabla1$SEXO, # color by groups
palette = c("#00AFBB", "#E7B800","#FC4E07","red","black"),
addEllipses = TRUE, # Concentration ellipses
legend.title = "Groups",
)
fviz_pca_ind(res.pca,
geom.ind = "point", # show points only (nbut not "text")
col.ind = Tabla1$SEXO, # color by groups
palette = c("#00AFBB", "#E7B800","#FC4E07","red","black"),
addEllipses = TRUE, # Concentration ellipses
legend.title = "Groups", axes=c(1,6)
)
fviz_pca_ind(res.pca,
geom.ind = "point", # show points only (nbut not "text")
col.ind = Tabla1$CELDA_SEGURIDAD, # color by groups
palette = c("#00AFBB", "#E7B800","#FC4E07","red","black"),
addEllipses = TRUE, # Concentration ellipses
legend.title = "Groups", axes=c(1,6)
)
fviz_pca_ind(res.pca,
geom.ind = "point", # show points only (nbut not "text")
col.ind = Tabla1$CELDA_HORAS, # color by groups
palette = c("#00AFBB", "#E7B800","#FC4E07","red","black"),
addEllipses = TRUE, # Concentration ellipses
legend.title = "Groups", axes=c(1,6)
)
fviz_pca_ind(res.pca,
geom.ind = "point", # show points only (nbut not "text")
col.ind = Tabla1$CELDA_SANITARIO, # color by groups
palette = c("#00AFBB", "#E7B800","#FC4E07","red","black"),
addEllipses = TRUE, # Concentration ellipses
legend.title = "Groups", axes=c(1,6)
)
fviz_pca_ind(res.pca,
geom.ind = "point", # show points only (nbut not "text")
col.ind = Tabla1$MOTIVO_DETENCION, # color by groups
palette = c("#00AFBB", "#E7B800","#FC4E07","red","black"),
addEllipses = TRUE, # Concentration ellipses
legend.title = "Groups", axes=c(1,6)
)
fviz_pca_ind(res.pca,
geom.ind = "point", # show points only (nbut not "text")
col.ind = Tabla1$MOTIVO_DETENCION, # color by groups
addEllipses = TRUE, # Concentration ellipses
legend.title = "Groups", axes=c(1,6)
)
#| echo: false
Ysupcat<-Tabla1[setdiff(varCualitativas,c("ANOS_CONDENA","ANOS_PROCESO","MESES_CONDENA","MESES_PROCESO"))]
Ysupcat[]<-lapply(Ysupcat,as.factor)
Ysupcat<-as.data.frame(Ysupcat)
sup<-supqual(acp,Ysupcat)
sup
#| echo: false
Ysupcat<-Tabla1[setdiff(varCualitativas,c("ANOS_CONDENA","ANOS_PROCESO","MESES_CONDENA","MESES_PROCESO"))]
Ysupcat[]<-lapply(Ysupcat,as.factor)
Ysupcat<-as.data.frame(Ysupcat)
sup<-supqual(acp,Ysupcat)
sup
view(sup)
View(sup)
sup$coor
#| title: ACP de las variables cuantitativas
#| echo: True
#| output: True
res.pca<-FactoMineR:: PCA(DatosCuantitativos, scale.unit = TRUE, ncp = 20, graph = FALSE)
acp <- dudi.pca(DatosCuantitativos, scannf = FALSE, nf = 15)
# El parámetro nf indica cuantos ejes voy a conservar
valp <- t(inertia(acp)$tot.inertia) # valores propios
kable(valp, digits = 3)
#| echo: false
Ysupcat<-Tabla1[setdiff(varCualitativas,c("ANOS_CONDENA","ANOS_PROCESO","MESES_CONDENA","MESES_PROCESO"))]
Ysupcat[]<-lapply(Ysupcat,as.factor)
Ysupcat<-as.data.frame(Ysupcat)
sup<-supqual(acp,Ysupcat)
#| echo: false
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
xlim = c(min(sup$coor[11:12,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
s.arrow(acp$co, add.plot = TRUE, boxes = F)
View(sup)
xlim = c(min(sup$coor[11:12,c(1,6)]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
sup$coor[11:15]
sup$coor[11:12]
a<-sup[["coor"]]
View(a)
a[11:12]
#| echo: false
pes_dist_coor<-cbind(wcat = sup$wcat, d2 = sup$dis2, sup$coor)
kable(pes_dist_coor[11:12,],
digits = 3)
#| echo: false
pes_dist_coor<-cbind(wcat = sup$wcat, d2 = sup$dis2, sup$coor)
kable(pes_dist_coor[31:42,],
digits = 3)
a[11]
a[11,1]
a[11,2]
a[11:12,1]
a[11:12,c(1,6)]
sup[["coor"]]
sup[["coor"]][11:12,c(1,6)]
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
xlim = c(min(sup[["coor"]][11:12,c(1,6)]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE)
#s.arrow(acp$co, add.plot = TRUE, boxes = F)
points(sup[["coor"]][11:12,c(1,6)], col = 6, pch = 16)
text(sup$coor[11:12,], labels = rownames(sup$coor[11:12,]),
col = 6, pos = 1, font = 3, srt=-45)
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
xlim = c(min(sup$coor[11:12,]-0.2),1), ylim = c(-1, 1), plot.axes = FALSE,axes=c(1,6))
#s.arrow(acp$co, add.plot = TRUE, boxes = F)
points(sup$coor[11:12,], col = 6, pch = 16)
text(sup$coor[11:12,], labels = rownames(sup$coor[11:12,]),
col = 6, pos = 1, font = 3, srt=-45)
plot(acp, Tcol = FALSE, ucal = 100, cex.row = 0,
xlim = c(min(sup$coor[11:12,]-0.2),1), ylim = c(-1, 1), plot.axes = T)
#s.arrow(acp$co, add.plot = TRUE, boxes = F)
points(sup$coor[11:12,], col = 6, pch = 16)
text(sup$coor[11:12,], labels = rownames(sup$coor[11:12,]),
col = 6, pos = 1, font = 3, srt=-45)
plot(acp$li[,2:3], Tcol = FALSE, ucal = 100, cex.row = 0,
xlim = c(min(sup$coor[11:12,2:3]-0.2),1), ylim = c(-1, 1), plot.axes = TRUE)
View(acp)
plot(acp$li[,2:3], Tcol = FALSE, ucal = 100, cex.row = 0,
xlim = c(min(sup$coor[11:12]-0.2),1), ylim = c(-1, 1), plot.axes = TRUE)
plot(acp$li[,2:3], Tcol = FALSE, ucal = 100, cex.row = 0,
xlim = c(min(sup$coor[11:12,]-0.2),1), ylim = c(-1, 1), plot.axes = TRUE)
plot(acp[["li"]][2:3], Tcol = FALSE, ucal = 100, cex.row = 0,
xlim = c(min(sup$coor[11:12,]-0.2),1), ylim = c(-1, 1), plot.axes = TRUE)
plot(acp[["li"]][,2:3], Tcol = FALSE, ucal = 100, cex.row = 0,
xlim = c(min(sup$coor[11:12,]-0.2),1), ylim = c(-1, 1), plot.axes = TRUE)
acp[["li"]]
acp[["li"]][,2:3]
